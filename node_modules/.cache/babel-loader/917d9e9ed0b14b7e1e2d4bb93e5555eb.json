{"remainingRequest":"/Users/yanglina/wadmin/node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js!/Users/yanglina/wadmin/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--0-0!/Users/yanglina/wadmin/node_modules/_vue-loader@15.7.2@vue-loader/lib/index.js??vue-loader-options!/Users/yanglina/wadmin/src/view/module/system/generate/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yanglina/wadmin/src/view/module/system/generate/index.vue","mtime":1576046371337},{"path":"/Users/yanglina/wadmin/.babelrc","mtime":1576127290134},{"path":"/Users/yanglina/wadmin/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanglina/wadmin/node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yanglina/wadmin/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanglina/wadmin/node_modules/_vue-loader@15.7.2@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nexport default {\n  name: 'Generate',\n\n  data() {\n    return {\n      saving: false,\n      current: 0,\n      selectTables: [],\n      formItemRules: {\n        type: [{\n          required: true,\n          message: '数据库类型不能为空',\n          trigger: 'blur'\n        }],\n        driverName: [{\n          required: true,\n          message: '驱动名称不能为空',\n          trigger: 'blur'\n        }],\n        url: [{\n          required: true,\n          message: '数据库连接不能为空',\n          trigger: 'blur'\n        }],\n        username: [{\n          required: true,\n          message: '用户名不能为空',\n          trigger: 'blur'\n        }],\n        password: [{\n          required: true,\n          message: '密码不能为空',\n          trigger: 'blur'\n        }],\n        author: [{\n          required: true,\n          message: '作者不能为空',\n          trigger: 'blur'\n        }],\n        parentPackage: [{\n          required: true,\n          message: '顶级包名不能为空',\n          trigger: 'blur'\n        }],\n        moduleName: [{\n          required: true,\n          message: '模块名不能为空',\n          trigger: 'blur'\n        }],\n        includeTables: [{\n          required: true,\n          message: '生成表名不能为空',\n          trigger: 'blur',\n          type: 'array',\n          min: 1\n        }],\n        tablePrefix: [{\n          required: true,\n          message: '忽略表名前缀不能为空',\n          trigger: 'blur',\n          type: 'array',\n          min: 1\n        }]\n      },\n      formItem: {\n        type: 'mysql',\n        driverName: 'com.mysql.cj.jdbc.Driver',\n        url: 'jdbc:mysql://localhost:3306/open-platform?useSSL=false&useUnicode=true&characterEncoding=utf-8&serverTimezone=UTC',\n        username: 'root',\n        password: 'root',\n        author: 'admin',\n        parentPackage: 'com.opencloud',\n        moduleName: 'base',\n        includeTables: [],\n        tablePrefix: []\n      }\n    };\n  },\n\n  methods: {\n    up() {\n      if (this.current == 0) {\n        this.current = 0;\n      } else {\n        this.current -= 1;\n      }\n    },\n\n    next() {\n      if (this.current == 1) {\n        this.current = 0;\n      } else {\n        this.current += 1;\n      }\n    },\n\n    handleSubmit() {\n      this.$refs[\"form\"].validate(valid => {\n        if (valid) {\n          this.saving = true;\n          const data = Object.assign({}, this.formItem);\n          Generate.execute(data).then(res => {\n            if (res.code === 0) {\n              let result = res.data;\n              let href = Generate.downloadPath + '?filePath=' + result.filePath;\n              this.$Modal.confirm({\n                title: '是否下载',\n                content: `代码生成成功! ${result.fileName}`,\n                onOk: () => {\n                  window.open(href, '_blank');\n                }\n              });\n            }\n          }).finally(() => {\n            this.saving = false;\n          });\n        }\n      });\n    },\n\n    handleTransferChange(newTargetKeys, direction, moveKeys) {\n      let tablePrefix = [];\n      newTargetKeys.map(item => {\n        let prefix = item.split(\"_\")[0] + '_';\n\n        if (!tablePrefix.includes(prefix)) {\n          tablePrefix.push(prefix);\n        }\n      });\n      this.formItem.tablePrefix = tablePrefix;\n      this.formItem.includeTables = newTargetKeys;\n    }\n\n  },\n  mounted: function () {},\n  watch: {\n    'current'(val) {\n      let that = this;\n\n      if (val === 1) {\n        Generate.tables(this.formItem).then(res => {\n          if (res.code === 0) {\n            let items = [];\n            res.data.map(item => {\n              items.push({\n                key: item.name,\n                label: `${item.name} - ${item.comment}`,\n                disabled: false\n              });\n            });\n            that.selectTables = items;\n          }\n        });\n      }\n    }\n\n  }\n};",{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <Card shadow>\n      <Steps :current=\"current\">\n        <Step title=\"数据库连接\"></Step>\n        <Step title=\"生产代码\"></Step>\n      </Steps>\n      <Form style=\"margin-top: 20px;\" ref=\"form\" :model=\"formItem\" :rules=\"formItemRules\" :label-width=\"140\">\n        <FormItem v-show=\"current===0\" label=\"数据库类型\" prop=\"type\">\n          <Select v-model=\"formItem.type\">\n            <Option value=\"mysql\">mysql</Option>\n            <Option disabled value=\"oracle\">oracle</Option>\n          </Select>\n        </FormItem>\n        <FormItem v-show=\"current===0\" label=\"驱动名称\" prop=\"driverName\">\n          <Input v-model=\"formItem.driverName\" placeholder=\"请输入内容\"></Input>\n        </FormItem>\n        <FormItem v-show=\"current===0\" label=\"连接地址\" prop=\"url\">\n          <Input v-model=\"formItem.url\" placeholder=\"请输入内容\"></Input>\n        </FormItem>\n        <FormItem v-show=\"current===0\" label=\"用户名\" prop=\"username\">\n          <Input v-model=\"formItem.username\" placeholder=\"请输入内容\"></Input>\n        </FormItem>\n        <FormItem v-show=\"current===0\" label=\"密码\" prop=\"password\">\n          <Input v-model=\"formItem.password\" type=\"password\" placeholder=\"请输入内容\"></Input>\n        </FormItem>\n        <Row>\n          <Col span=\"10\">\n          <FormItem v-show=\"current===1\" label=\"模块名称\" prop=\"moduleName\">\n            <Input v-model=\"formItem.moduleName\" placeholder=\"请输入内容\"></Input>\n          </FormItem>\n          <FormItem v-show=\"current===1\" label=\"顶级包名\" prop=\"parentPackage\">\n            <Input v-model=\"formItem.parentPackage\" placeholder=\"请输入内容\"></Input>\n          </FormItem>\n          <FormItem v-show=\"current===1\" label=\"作者\" prop=\"author\">\n            <Input v-model=\"formItem.author\" placeholder=\"请输入内容\"></Input>\n          </FormItem>\n          </Col>\n          <Col span=\"14\">\n          <FormItem v-show=\"current===1\" label=\"需要生成的表\" prop=\"includeTables\">\n            <Transfer\n              :data=\"selectTables\"\n              :list-style=\"{width: '45%',height: '500px'}\"\n              :titles=\"['选择表', '已选择表']\"\n              :target-keys=\"formItem.includeTables\"\n              @on-change=\"handleTransferChange\"\n              filterable>\n            </Transfer>\n          </FormItem>\n          <FormItem v-show=\"current===1\" label=\"忽略表前缀\" prop=\"tablePrefix\">\n            <Select v-model=\"formItem.tablePrefix\" multiple style=\"width:260px\">\n              <Option v-for=\"item in formItem.tablePrefix\" :value=\"item\" :key=\"item\">{{ item }}</Option>\n            </Select>\n          </FormItem>\n          </Col>\n        </Row>\n      </Form>\n      <div style=\"margin-top: 20px;text-align: center\">\n        <Button v-if=\"current > 0\" @click=\"up\">上一步</Button>&nbsp;\n        <Button v-if=\"current < 1\" type=\"primary\" @click=\"next\">下一步</Button>&nbsp;\n        <Button v-if=\"current===1\" type=\"success\" @click=\"handleSubmit\" :loading=\"saving\">确定生成</Button>\n      </div>\n    </Card>\n  </div>\n</template>\n\n<script>\n  export default {\n    name: 'Generate',\n    data () {\n      return {\n        saving: false,\n        current: 0,\n        selectTables: [],\n        formItemRules: {\n          type: [\n            {required: true, message: '数据库类型不能为空', trigger: 'blur'}\n          ],\n          driverName: [\n            {required: true, message: '驱动名称不能为空', trigger: 'blur'}\n          ],\n          url: [\n            {required: true, message: '数据库连接不能为空', trigger: 'blur'}\n          ],\n          username: [\n            {required: true, message: '用户名不能为空', trigger: 'blur'}\n          ],\n          password: [\n            {required: true, message: '密码不能为空', trigger: 'blur'}\n          ],\n          author: [\n            {required: true, message: '作者不能为空', trigger: 'blur'}\n          ],\n          parentPackage: [\n            {required: true, message: '顶级包名不能为空', trigger: 'blur'}\n          ],\n          moduleName: [\n            {required: true, message: '模块名不能为空', trigger: 'blur'}\n          ],\n          includeTables: [\n            {required: true, message: '生成表名不能为空', trigger: 'blur', type: 'array', min: 1}\n          ],\n          tablePrefix: [\n            {required: true, message: '忽略表名前缀不能为空', trigger: 'blur', type: 'array', min: 1}\n          ]\n        },\n        formItem: {\n          type: 'mysql',\n          driverName: 'com.mysql.cj.jdbc.Driver',\n          url: 'jdbc:mysql://localhost:3306/open-platform?useSSL=false&useUnicode=true&characterEncoding=utf-8&serverTimezone=UTC',\n          username: 'root',\n          password: 'root',\n          author: 'admin',\n          parentPackage: 'com.opencloud',\n          moduleName: 'base',\n          includeTables: [],\n          tablePrefix: []\n        },\n      }\n    },\n    methods: {\n      up () {\n        if (this.current == 0) {\n          this.current = 0;\n        } else {\n          this.current -= 1;\n        }\n      },\n      next () {\n        if (this.current == 1) {\n          this.current = 0;\n        } else {\n          this.current += 1;\n        }\n      },\n      handleSubmit () {\n        this.$refs[\"form\"].validate((valid) => {\n          if (valid) {\n            this.saving = true\n            const data = Object.assign({}, this.formItem)\n            Generate.execute(data).then(res => {\n              if (res.code === 0) {\n                let result = res.data\n                let href = Generate.downloadPath + '?filePath=' + result.filePath\n                this.$Modal.confirm({\n                  title: '是否下载',\n                  content: `代码生成成功! ${result.fileName}`,\n                  onOk: () => {\n                    window.open(href, '_blank');\n                  }\n                });\n              }\n            }).finally(() => {\n              this.saving = false\n            })\n          }\n        })\n      },\n      handleTransferChange (newTargetKeys, direction, moveKeys) {\n        let tablePrefix = []\n        newTargetKeys.map(item => {\n          let prefix = item.split(\"_\")[0] + '_'\n          if (!tablePrefix.includes(prefix)) {\n            tablePrefix.push(prefix)\n          }\n        })\n        this.formItem.tablePrefix = tablePrefix\n        this.formItem.includeTables = newTargetKeys\n      }\n    },\n    mounted: function () {\n    },\n    watch: {\n      'current' (val) {\n        let that = this\n        if (val === 1) {\n          Generate.tables(this.formItem).then(res => {\n            if (res.code === 0) {\n              let items = []\n              res.data.map(item => {\n                items.push({\n                  key: item.name,\n                  label: `${item.name} - ${item.comment}`,\n                  disabled: false\n                })\n              })\n              that.selectTables = items\n            }\n          })\n        }\n      }\n    },\n  }\n</script>\n"],"sourceRoot":"src/view/module/system/generate"}]}