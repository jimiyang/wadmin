{"remainingRequest":"/Users/yanglina/wadmin/node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js!/Users/yanglina/wadmin/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--0-0!/Users/yanglina/wadmin/node_modules/_vue-loader@15.7.2@vue-loader/lib/index.js??vue-loader-options!/Users/yanglina/wadmin/src/view/module/task/logs/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yanglina/wadmin/src/view/module/task/logs/index.vue","mtime":1576046419709},{"path":"/Users/yanglina/wadmin/.babelrc","mtime":1576127290134},{"path":"/Users/yanglina/wadmin/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanglina/wadmin/node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yanglina/wadmin/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanglina/wadmin/node_modules/_vue-loader@15.7.2@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nexport default {\n  name: 'TaskJobLogs',\n\n  data() {\n    return {\n      drawer: false,\n      currentRow: {},\n      loading: false,\n      pageInfo: {\n        total: 0,\n        page: 1,\n        limit: 10,\n        jobName: ''\n      },\n      columns: [{\n        title: '任务名称',\n        key: 'jobName',\n        width: 150\n      }, {\n        title: '调度信息',\n        width: 350,\n        slot: 'type'\n      }, {\n        title: '执行结果',\n        key: 'status',\n        slot: 'status'\n      }, {\n        title: '耗时',\n        key: 'runTime',\n        render: (h, params) => {\n          return h('div', (params.row.runTime ? params.row.runTime : 0) + ' ms');\n        }\n      }, {\n        title: '创建时间',\n        key: 'createTime'\n      }, {\n        title: '详情',\n        slot: 'detail',\n        fixed: 'right',\n        width: 150\n      }],\n      data: []\n    };\n  },\n\n  methods: {\n    openDrawer(data) {\n      this.currentRow = data;\n      this.drawer = true;\n    },\n\n    handleSearch(page) {\n      if (page) {\n        this.pageInfo.page = page;\n      }\n\n      this.loading = true;\n      getJobLogs(this.pageInfo).then(res => {\n        this.data = res.data.records;\n        this.pageInfo.total = parseInt(res.data.total);\n      }).finally(() => {\n        this.loading = false;\n      });\n    },\n\n    handleResetForm(form) {\n      this.$refs[form].resetFields();\n    },\n\n    handlePage(current) {\n      this.pageInfo.page = current;\n      this.handleSearch();\n    },\n\n    handlePageSize(size) {\n      this.pageInfo.limit = size;\n      this.handleSearch();\n    }\n\n  },\n  mounted: function () {\n    this.handleSearch();\n  }\n};",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6DA,eAAA;AACA,EAAA,IAAA,EAAA,aADA;;AAEA,EAAA,IAAA,GAAA;AACA,WAAA;AACA,MAAA,MAAA,EAAA,KADA;AAEA,MAAA,UAAA,EAAA,EAFA;AAGA,MAAA,OAAA,EAAA,KAHA;AAIA,MAAA,QAAA,EAAA;AACA,QAAA,KAAA,EAAA,CADA;AAEA,QAAA,IAAA,EAAA,CAFA;AAGA,QAAA,KAAA,EAAA,EAHA;AAIA,QAAA,OAAA,EAAA;AAJA,OAJA;AAUA,MAAA,OAAA,EAAA,CACA;AACA,QAAA,KAAA,EAAA,MADA;AAEA,QAAA,GAAA,EAAA,SAFA;AAGA,QAAA,KAAA,EAAA;AAHA,OADA,EAMA;AACA,QAAA,KAAA,EAAA,MADA;AAEA,QAAA,KAAA,EAAA,GAFA;AAGA,QAAA,IAAA,EAAA;AAHA,OANA,EAWA;AACA,QAAA,KAAA,EAAA,MADA;AAEA,QAAA,GAAA,EAAA,QAFA;AAGA,QAAA,IAAA,EAAA;AAHA,OAXA,EAgBA;AACA,QAAA,KAAA,EAAA,IADA;AAEA,QAAA,GAAA,EAAA,SAFA;AAGA,QAAA,MAAA,EAAA,CAAA,CAAA,EAAA,MAAA,KAAA;AACA,iBAAA,CAAA,CAAA,KAAA,EAAA,CAAA,MAAA,CAAA,GAAA,CAAA,OAAA,GAAA,MAAA,CAAA,GAAA,CAAA,OAAA,GAAA,CAAA,IAAA,KAAA,CAAA;AACA;AALA,OAhBA,EAuBA;AACA,QAAA,KAAA,EAAA,MADA;AAEA,QAAA,GAAA,EAAA;AAFA,OAvBA,EA2BA;AACA,QAAA,KAAA,EAAA,IADA;AAEA,QAAA,IAAA,EAAA,QAFA;AAGA,QAAA,KAAA,EAAA,OAHA;AAIA,QAAA,KAAA,EAAA;AAJA,OA3BA,CAVA;AA4CA,MAAA,IAAA,EAAA;AA5CA,KAAA;AA8CA,GAjDA;;AAkDA,EAAA,OAAA,EAAA;AACA,IAAA,UAAA,CAAA,IAAA,EAAA;AACA,WAAA,UAAA,GAAA,IAAA;AACA,WAAA,MAAA,GAAA,IAAA;AACA,KAJA;;AAKA,IAAA,YAAA,CAAA,IAAA,EAAA;AACA,UAAA,IAAA,EAAA;AACA,aAAA,QAAA,CAAA,IAAA,GAAA,IAAA;AACA;;AACA,WAAA,OAAA,GAAA,IAAA;AACA,MAAA,UAAA,CAAA,KAAA,QAAA,CAAA,CAAA,IAAA,CAAA,GAAA,IAAA;AACA,aAAA,IAAA,GAAA,GAAA,CAAA,IAAA,CAAA,OAAA;AACA,aAAA,QAAA,CAAA,KAAA,GAAA,QAAA,CAAA,GAAA,CAAA,IAAA,CAAA,KAAA,CAAA;AACA,OAHA,EAGA,OAHA,CAGA,MAAA;AACA,aAAA,OAAA,GAAA,KAAA;AACA,OALA;AAMA,KAhBA;;AAiBA,IAAA,eAAA,CAAA,IAAA,EAAA;AACA,WAAA,KAAA,CAAA,IAAA,EAAA,WAAA;AACA,KAnBA;;AAoBA,IAAA,UAAA,CAAA,OAAA,EAAA;AACA,WAAA,QAAA,CAAA,IAAA,GAAA,OAAA;AACA,WAAA,YAAA;AACA,KAvBA;;AAwBA,IAAA,cAAA,CAAA,IAAA,EAAA;AACA,WAAA,QAAA,CAAA,KAAA,GAAA,IAAA;AACA,WAAA,YAAA;AACA;;AA3BA,GAlDA;AA+EA,EAAA,OAAA,EAAA,YAAA;AACA,SAAA,YAAA;AACA;AAjFA,CAAA","sourcesContent":["<template>\n  <div>\n    <Card shadow>\n      <Form ref=\"searchForm\"\n            :model=\"pageInfo\"\n            inline\n            :label-width=\"80\">\n        <FormItem label=\"任务名称\" prop=\"jobName\">\n          <Input type=\"text\" v-model=\"pageInfo.jobName\" placeholder=\"请输入关键字\"/>\n        </FormItem>\n        <FormItem>\n          <Button type=\"primary\" @click=\"handleSearch(1)\">查询</Button>&nbsp;\n          <Button @click=\"handleResetForm('searchForm')\">重置</Button>\n        </FormItem>\n      </Form>\n\n      <Table border :columns=\"columns\" :data=\"data\" :loading=\"loading\">\n        <template slot=\"status\" slot-scope=\"{ row }\">\n          <Badge v-if=\"row.status===1\" status=\"success\" text=\"成功\"/>\n          <Badge v-else=\"\" status=\"error\" text=\"失败\"/>\n        </template>\n        <template slot=\"type\" slot-scope=\"{ row }\">\n          <p v-if=\"row.cronExpression\">cron表达式:{{row.cronExpression}}</p>\n          <p v-else=\"\">调度时间:{{row.startDate}} ~ {{row.endDate}}</p>\n        </template>\n        <template slot=\"detail\" slot-scope=\"{ row }\">\n          <a @click=\"openDrawer(row)\">详情</a>\n        </template>\n      </Table>\n      <Page transfer :total=\"pageInfo.total\" :current=\"pageInfo.page\" :page-size=\"pageInfo.limit\" show-elevator\n            show-sizer\n            show-total\n            @on-change=\"handlePage\" @on-page-size-change='handlePageSize'></Page>\n    </Card>\n    <Drawer width=\"50\" :closable=\"false\" v-model=\"drawer\">\n      <div slot=\"header\">\n        <Badge v-if=\"currentRow.status===1\" status=\"success\"/>\n        <Badge v-else=\"\" status=\"error\"/>\n        {{currentRow.jobName}}\n\n      </div>\n      <div>\n        <p><strong>执行类：</strong>{{ currentRow.jobClass }}</p>\n        <p><strong>触发器：</strong>{{currentRow.triggerClass}}</p>\n        <p><strong>运行时长：</strong>{{ currentRow.runTime }} ms  </p>\n        <p v-if=\"currentRow.cronExpression\"><strong>cron表达式：</strong>{{currentRow.cronExpression}}</p>\n        <p v-else=\"\"><strong>调度时间：</strong>: {{currentRow.startDate}} ~ {{currentRow.endDate}}</p>\n        <strong>执行参数</strong>\n        <pre>\n              {{ currentRow.jobData ? JSON.stringify(JSON.parse(currentRow.jobData), null, 4) : ''}}\n        </pre>\n        <strong>错误信息</strong>\n        <pre>\n          {{currentRow.exception}}\n        </pre>\n      </div>\n    </Drawer>\n  </div>\n</template>\n\n<script>\n  export default {\n    name: 'TaskJobLogs',\n    data () {\n      return {\n        drawer: false,\n        currentRow: {},\n        loading: false,\n        pageInfo: {\n          total: 0,\n          page: 1,\n          limit: 10,\n          jobName: ''\n        },\n        columns: [\n          {\n            title: '任务名称',\n            key: 'jobName',\n            width: 150\n          },\n          {\n            title: '调度信息',\n            width: 350,\n            slot: 'type'\n          },\n          {\n            title: '执行结果',\n            key: 'status',\n            slot: 'status'\n          },\n          {\n            title: '耗时',\n            key: 'runTime',\n            render: (h, params) => {\n              return h('div', (params.row.runTime ? params.row.runTime : 0) + ' ms')\n            }\n          },\n          {\n            title: '创建时间',\n            key: 'createTime'\n          },\n          {\n            title: '详情',\n            slot: 'detail',\n            fixed: 'right',\n            width: 150\n          }\n        ],\n        data: []\n      }\n    },\n    methods: {\n      openDrawer (data) {\n        this.currentRow = data\n        this.drawer = true\n      },\n      handleSearch (page) {\n        if (page) {\n          this.pageInfo.page = page\n        }\n        this.loading = true\n        getJobLogs(this.pageInfo).then(res => {\n          this.data = res.data.records\n          this.pageInfo.total = parseInt(res.data.total)\n        }).finally(() => {\n          this.loading = false\n        })\n      },\n      handleResetForm (form) {\n        this.$refs[form].resetFields()\n      },\n      handlePage (current) {\n        this.pageInfo.page = current\n        this.handleSearch()\n      },\n      handlePageSize (size) {\n        this.pageInfo.limit = size\n        this.handleSearch()\n      }\n    },\n    mounted: function () {\n      this.handleSearch()\n    }\n  }\n</script>\n"],"sourceRoot":"src/view/module/task/logs"}]}