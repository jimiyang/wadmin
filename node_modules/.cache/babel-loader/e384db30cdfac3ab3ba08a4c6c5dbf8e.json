{"remainingRequest":"/Users/yanglina/wadmin/node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js!/Users/yanglina/wadmin/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--0-0!/Users/yanglina/wadmin/node_modules/_vue-loader@15.7.2@vue-loader/lib/index.js??vue-loader-options!/Users/yanglina/wadmin/src/view/module/gateway/logs/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yanglina/wadmin/src/view/module/gateway/logs/index.vue","mtime":1576046352298},{"path":"/Users/yanglina/wadmin/.babelrc","mtime":1576127290134},{"path":"/Users/yanglina/wadmin/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanglina/wadmin/node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yanglina/wadmin/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanglina/wadmin/node_modules/_vue-loader@15.7.2@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { readUserAgent } from '@/libs/util';\nexport default {\n  name: 'GatewayAccessLog',\n\n  data() {\n    return {\n      drawer: false,\n      currentRow: {},\n      loading: false,\n      pageInfo: {\n        total: 0,\n        page: 1,\n        limit: 10,\n        path: '',\n        ip: '',\n        serviceId: ''\n      },\n      columns: [{\n        type: 'selection',\n        width: 60,\n        align: 'center'\n      }, {\n        title: '请求地址',\n        key: 'path',\n        width: 220\n      }, {\n        title: '请求方式',\n        key: 'method',\n        width: 100,\n        filters: [{\n          label: 'POST',\n          value: 0\n        }, {\n          label: 'GET',\n          value: 1\n        }, {\n          label: 'DELETE',\n          value: 2\n        }, {\n          label: 'OPTIONS',\n          value: 3\n        }, {\n          label: 'PATCH',\n          value: 4\n        }],\n        filterMultiple: false,\n\n        filterMethod(value, row) {\n          if (value === 0) {\n            return row.method === 'POST';\n          } else if (value === 1) {\n            return row.method === 'GET';\n          } else if (value === 2) {\n            return row.method === 'DELETE';\n          } else if (value === 3) {\n            return row.method === 'OPTIONS';\n          } else if (value === 4) {\n            return row.method === 'PATCH';\n          }\n        }\n\n      }, {\n        title: 'IP',\n        key: 'ip',\n        width: 150\n      }, {\n        title: '区域',\n        key: 'region',\n        width: 200\n      }, {\n        title: '终端',\n        width: 100,\n        render: (h, params) => {\n          return h('div', readUserAgent(params.row.userAgent).terminal);\n        }\n      }, {\n        title: '浏览器',\n        width: 100,\n        render: (h, params) => {\n          return h('div', readUserAgent(params.row.userAgent).browser);\n        }\n      }, {\n        title: '服务名',\n        key: 'serviceId',\n        width: 200\n      }, {\n        title: '响应状态',\n        key: 'httpStatus',\n        slot: 'httpStatus',\n        width: 100\n      }, {\n        title: '耗时',\n        key: 'useTime',\n        render: (h, params) => {\n          return h('div', (params.row.useTime ? params.row.useTime : 0) + ' ms');\n        },\n        width: 100\n      }, {\n        title: '请求时间',\n        key: 'requestTime',\n        width: 200\n      }, {\n        title: '详情',\n        slot: 'detail',\n        fixed: 'right',\n        width: 120\n      }],\n      data: []\n    };\n  },\n\n  methods: {\n    openDrawer(data) {\n      this.currentRow = data;\n      this.drawer = true;\n    },\n\n    handleSearch(page) {\n      if (page) {\n        this.pageInfo.page = page;\n      }\n\n      this.loading = true;\n      getAccessLogs(this.pageInfo).then(res => {\n        this.data = res.data.records;\n        this.pageInfo.total = parseInt(res.data.total);\n      }).finally(() => {\n        this.loading = false;\n      });\n    },\n\n    handleResetForm(form) {\n      this.$refs[form].resetFields();\n    },\n\n    handlePage(current) {\n      this.pageInfo.page = current;\n      this.handleSearch();\n    },\n\n    handlePageSize(size) {\n      this.pageInfo.limit = size;\n      this.handleSearch();\n    }\n\n  },\n  mounted: function () {\n    this.handleSearch();\n  }\n};",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqEA,SAAA,aAAA,QAAA,aAAA;AAEA,eAAA;AACA,EAAA,IAAA,EAAA,kBADA;;AAEA,EAAA,IAAA,GAAA;AACA,WAAA;AACA,MAAA,MAAA,EAAA,KADA;AAEA,MAAA,UAAA,EAAA,EAFA;AAGA,MAAA,OAAA,EAAA,KAHA;AAIA,MAAA,QAAA,EAAA;AACA,QAAA,KAAA,EAAA,CADA;AAEA,QAAA,IAAA,EAAA,CAFA;AAGA,QAAA,KAAA,EAAA,EAHA;AAIA,QAAA,IAAA,EAAA,EAJA;AAKA,QAAA,EAAA,EAAA,EALA;AAMA,QAAA,SAAA,EAAA;AANA,OAJA;AAYA,MAAA,OAAA,EAAA,CACA;AACA,QAAA,IAAA,EAAA,WADA;AAEA,QAAA,KAAA,EAAA,EAFA;AAGA,QAAA,KAAA,EAAA;AAHA,OADA,EAMA;AACA,QAAA,KAAA,EAAA,MADA;AAEA,QAAA,GAAA,EAAA,MAFA;AAGA,QAAA,KAAA,EAAA;AAHA,OANA,EAWA;AACA,QAAA,KAAA,EAAA,MADA;AAEA,QAAA,GAAA,EAAA,QAFA;AAGA,QAAA,KAAA,EAAA,GAHA;AAIA,QAAA,OAAA,EAAA,CACA;AACA,UAAA,KAAA,EAAA,MADA;AAEA,UAAA,KAAA,EAAA;AAFA,SADA,EAKA;AACA,UAAA,KAAA,EAAA,KADA;AAEA,UAAA,KAAA,EAAA;AAFA,SALA,EASA;AACA,UAAA,KAAA,EAAA,QADA;AAEA,UAAA,KAAA,EAAA;AAFA,SATA,EAaA;AACA,UAAA,KAAA,EAAA,SADA;AAEA,UAAA,KAAA,EAAA;AAFA,SAbA,EAiBA;AACA,UAAA,KAAA,EAAA,OADA;AAEA,UAAA,KAAA,EAAA;AAFA,SAjBA,CAJA;AA0BA,QAAA,cAAA,EAAA,KA1BA;;AA2BA,QAAA,YAAA,CAAA,KAAA,EAAA,GAAA,EAAA;AACA,cAAA,KAAA,KAAA,CAAA,EAAA;AACA,mBAAA,GAAA,CAAA,MAAA,KAAA,MAAA;AACA,WAFA,MAEA,IAAA,KAAA,KAAA,CAAA,EAAA;AACA,mBAAA,GAAA,CAAA,MAAA,KAAA,KAAA;AACA,WAFA,MAEA,IAAA,KAAA,KAAA,CAAA,EAAA;AACA,mBAAA,GAAA,CAAA,MAAA,KAAA,QAAA;AACA,WAFA,MAEA,IAAA,KAAA,KAAA,CAAA,EAAA;AACA,mBAAA,GAAA,CAAA,MAAA,KAAA,SAAA;AACA,WAFA,MAEA,IAAA,KAAA,KAAA,CAAA,EAAA;AACA,mBAAA,GAAA,CAAA,MAAA,KAAA,OAAA;AACA;AACA;;AAvCA,OAXA,EAoDA;AACA,QAAA,KAAA,EAAA,IADA;AAEA,QAAA,GAAA,EAAA,IAFA;AAGA,QAAA,KAAA,EAAA;AAHA,OApDA,EAyDA;AACA,QAAA,KAAA,EAAA,IADA;AAEA,QAAA,GAAA,EAAA,QAFA;AAGA,QAAA,KAAA,EAAA;AAHA,OAzDA,EA8DA;AACA,QAAA,KAAA,EAAA,IADA;AAEA,QAAA,KAAA,EAAA,GAFA;AAGA,QAAA,MAAA,EAAA,CAAA,CAAA,EAAA,MAAA,KAAA;AACA,iBAAA,CAAA,CAAA,KAAA,EAAA,aAAA,CAAA,MAAA,CAAA,GAAA,CAAA,SAAA,CAAA,CAAA,QAAA,CAAA;AACA;AALA,OA9DA,EAqEA;AACA,QAAA,KAAA,EAAA,KADA;AAEA,QAAA,KAAA,EAAA,GAFA;AAGA,QAAA,MAAA,EAAA,CAAA,CAAA,EAAA,MAAA,KAAA;AACA,iBAAA,CAAA,CAAA,KAAA,EAAA,aAAA,CAAA,MAAA,CAAA,GAAA,CAAA,SAAA,CAAA,CAAA,OAAA,CAAA;AACA;AALA,OArEA,EA4EA;AACA,QAAA,KAAA,EAAA,KADA;AAEA,QAAA,GAAA,EAAA,WAFA;AAGA,QAAA,KAAA,EAAA;AAHA,OA5EA,EAiFA;AACA,QAAA,KAAA,EAAA,MADA;AAEA,QAAA,GAAA,EAAA,YAFA;AAGA,QAAA,IAAA,EAAA,YAHA;AAIA,QAAA,KAAA,EAAA;AAJA,OAjFA,EAuFA;AACA,QAAA,KAAA,EAAA,IADA;AAEA,QAAA,GAAA,EAAA,SAFA;AAGA,QAAA,MAAA,EAAA,CAAA,CAAA,EAAA,MAAA,KAAA;AACA,iBAAA,CAAA,CAAA,KAAA,EAAA,CAAA,MAAA,CAAA,GAAA,CAAA,OAAA,GAAA,MAAA,CAAA,GAAA,CAAA,OAAA,GAAA,CAAA,IAAA,KAAA,CAAA;AACA,SALA;AAMA,QAAA,KAAA,EAAA;AANA,OAvFA,EA+FA;AACA,QAAA,KAAA,EAAA,MADA;AAEA,QAAA,GAAA,EAAA,aAFA;AAGA,QAAA,KAAA,EAAA;AAHA,OA/FA,EAoGA;AACA,QAAA,KAAA,EAAA,IADA;AAEA,QAAA,IAAA,EAAA,QAFA;AAGA,QAAA,KAAA,EAAA,OAHA;AAIA,QAAA,KAAA,EAAA;AAJA,OApGA,CAZA;AAuHA,MAAA,IAAA,EAAA;AAvHA,KAAA;AAyHA,GA5HA;;AA6HA,EAAA,OAAA,EAAA;AACA,IAAA,UAAA,CAAA,IAAA,EAAA;AACA,WAAA,UAAA,GAAA,IAAA;AACA,WAAA,MAAA,GAAA,IAAA;AACA,KAJA;;AAKA,IAAA,YAAA,CAAA,IAAA,EAAA;AACA,UAAA,IAAA,EAAA;AACA,aAAA,QAAA,CAAA,IAAA,GAAA,IAAA;AACA;;AACA,WAAA,OAAA,GAAA,IAAA;AACA,MAAA,aAAA,CAAA,KAAA,QAAA,CAAA,CAAA,IAAA,CAAA,GAAA,IAAA;AACA,aAAA,IAAA,GAAA,GAAA,CAAA,IAAA,CAAA,OAAA;AACA,aAAA,QAAA,CAAA,KAAA,GAAA,QAAA,CAAA,GAAA,CAAA,IAAA,CAAA,KAAA,CAAA;AACA,OAHA,EAGA,OAHA,CAGA,MAAA;AACA,aAAA,OAAA,GAAA,KAAA;AACA,OALA;AAMA,KAhBA;;AAiBA,IAAA,eAAA,CAAA,IAAA,EAAA;AACA,WAAA,KAAA,CAAA,IAAA,EAAA,WAAA;AACA,KAnBA;;AAoBA,IAAA,UAAA,CAAA,OAAA,EAAA;AACA,WAAA,QAAA,CAAA,IAAA,GAAA,OAAA;AACA,WAAA,YAAA;AACA,KAvBA;;AAwBA,IAAA,cAAA,CAAA,IAAA,EAAA;AACA,WAAA,QAAA,CAAA,KAAA,GAAA,IAAA;AACA,WAAA,YAAA;AACA;;AA3BA,GA7HA;AA0JA,EAAA,OAAA,EAAA,YAAA;AACA,SAAA,YAAA;AACA;AA5JA,CAAA","sourcesContent":["<template>\n  <div>\n    <Card shadow>\n      <Form ref=\"searchForm\"\n            :model=\"pageInfo\"\n            inline\n            :label-width=\"80\">\n        <FormItem label=\"请求路径\" prop=\"path\">\n          <Input type=\"text\" v-model=\"pageInfo.path\" placeholder=\"请输入关键字\"/>\n        </FormItem>\n        <FormItem label=\"IP\" prop=\"ip\">\n          <Input type=\"text\" v-model=\"pageInfo.ip\" placeholder=\"请输入关键字\"/>\n        </FormItem>\n        <FormItem label=\"服务名\" prop=\"serviceId\">\n          <Input type=\"text\" v-model=\"pageInfo.serviceId\" placeholder=\"请输入关键字\"/>\n        </FormItem>\n        <FormItem>\n          <Button type=\"primary\" @click=\"handleSearch(1)\">查询</Button>&nbsp;\n          <Button @click=\"handleResetForm('searchForm')\">重置</Button>\n        </FormItem>\n      </Form>\n\n      <Table border :columns=\"columns\" :data=\"data\" :loading=\"loading\">\n        <template slot=\"httpStatus\" slot-scope=\"{ row }\">\n          <Badge v-if=\"row.httpStatus==='200'\" status=\"success\"/>\n          <Badge v-else=\"\" status=\"error\"/>\n          <span>{{row.httpStatus}}</span>\n        </template>\n        <template slot=\"detail\" slot-scope=\"{ row }\">\n          <a @click=\"openDrawer(row)\">详情</a>\n        </template>\n      </Table>\n      <Page transfer :total=\"pageInfo.total\" :current=\"pageInfo.page\" :page-size=\"pageInfo.limit\" show-elevator\n            show-sizer\n            show-total\n            @on-change=\"handlePage\" @on-page-size-change='handlePageSize'></Page>\n    </Card>\n    <Drawer width=\"30\" v-model=\"drawer\">\n      <div slot=\"header\">\n        <Badge v-if=\"currentRow.httpStatus==='200'\" status=\"success\"/>\n        <Badge v-else=\"\" status=\"error\"/>\n        {{currentRow.httpStatus}}\n        {{currentRow.path}} - {{currentRow.serviceId}}\n\n      </div>\n      <div>\n        <h3>请求头</h3>\n        <pre>\n             {{ currentRow.headers ? JSON.stringify(JSON.parse(currentRow.headers), null, 4) : ''}}\n        </pre>\n        <h3>请求参数</h3>\n        <pre>\n              {{ currentRow.params ? JSON.stringify(JSON.parse(currentRow.params), null, 4) : ''}}\n        </pre>\n        <h3>错误信息</h3>\n        <pre>\n          {{currentRow.error}}\n        </pre>\n        <h3>认证信息</h3>\n        <pre>\n              {{ currentRow.authentication ? JSON.stringify(JSON.parse(currentRow.authentication), null, 4) : ''}}\n        </pre>\n      </div>\n    </Drawer>\n  </div>\n</template>\n\n<script>\n\n  import {readUserAgent} from '@/libs/util'\n\n  export default {\n    name: 'GatewayAccessLog',\n    data () {\n      return {\n        drawer: false,\n        currentRow: {},\n        loading: false,\n        pageInfo: {\n          total: 0,\n          page: 1,\n          limit: 10,\n          path: '',\n          ip: '',\n          serviceId: ''\n        },\n        columns: [\n          {\n            type: 'selection',\n            width: 60,\n            align: 'center'\n          },\n          {\n            title: '请求地址',\n            key: 'path',\n            width: 220\n          },\n          {\n            title: '请求方式',\n            key: 'method',\n            width: 100,\n            filters: [\n              {\n                label: 'POST',\n                value: 0\n              },\n              {\n                label: 'GET',\n                value: 1\n              },\n              {\n                label: 'DELETE',\n                value: 2\n              },\n              {\n                label: 'OPTIONS',\n                value: 3\n              },\n              {\n                label: 'PATCH',\n                value: 4\n              }\n            ],\n            filterMultiple: false,\n            filterMethod (value, row) {\n              if (value === 0) {\n                return row.method === 'POST'\n              } else if (value === 1) {\n                return row.method === 'GET'\n              } else if (value === 2) {\n                return row.method === 'DELETE'\n              } else if (value === 3) {\n                return row.method === 'OPTIONS'\n              } else if (value === 4) {\n                return row.method === 'PATCH'\n              }\n            }\n          },\n          {\n            title: 'IP',\n            key: 'ip',\n            width: 150\n          },\n          {\n            title: '区域',\n            key: 'region',\n            width: 200\n          },\n          {\n            title: '终端',\n            width: 100,\n            render: (h, params) => {\n              return h('div', readUserAgent(params.row.userAgent).terminal)\n            }\n          },\n          {\n            title: '浏览器',\n            width: 100,\n            render: (h, params) => {\n              return h('div', readUserAgent(params.row.userAgent).browser)\n            }\n          },\n          {\n            title: '服务名',\n            key: 'serviceId',\n            width: 200\n          },\n          {\n            title: '响应状态',\n            key: 'httpStatus',\n            slot: 'httpStatus',\n            width: 100\n          },\n          {\n            title: '耗时',\n            key: 'useTime',\n            render: (h, params) => {\n              return h('div', (params.row.useTime ? params.row.useTime : 0) + ' ms')\n            },\n            width: 100\n          },\n          {\n            title: '请求时间',\n            key: 'requestTime',\n            width: 200\n          },\n          {\n            title: '详情',\n            slot: 'detail',\n            fixed: 'right',\n            width: 120\n          }\n        ],\n        data: []\n      }\n    },\n    methods: {\n      openDrawer (data) {\n        this.currentRow = data\n        this.drawer = true\n      },\n      handleSearch (page) {\n        if (page) {\n          this.pageInfo.page = page\n        }\n        this.loading = true\n        getAccessLogs(this.pageInfo).then(res => {\n          this.data = res.data.records\n          this.pageInfo.total = parseInt(res.data.total)\n        }).finally(() => {\n          this.loading = false\n        })\n      },\n      handleResetForm (form) {\n        this.$refs[form].resetFields()\n      },\n      handlePage (current) {\n        this.pageInfo.page = current\n        this.handleSearch()\n      },\n      handlePageSize (size) {\n        this.pageInfo.limit = size\n        this.handleSearch()\n      }\n    },\n    mounted: function () {\n      this.handleSearch()\n    }\n  }\n</script>\n"],"sourceRoot":"src/view/module/gateway/logs"}]}