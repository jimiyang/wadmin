{"remainingRequest":"/Users/yanglina/wadmin/node_modules/_vue-loader@15.7.2@vue-loader/lib/index.js??vue-loader-options!/Users/yanglina/wadmin/src/view/module/system/generate/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yanglina/wadmin/src/view/module/system/generate/index.vue","mtime":1576046371337},{"path":"/Users/yanglina/wadmin/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanglina/wadmin/node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yanglina/wadmin/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanglina/wadmin/node_modules/_vue-loader@15.7.2@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n  name: 'Generate',\n  data () {\n    return {\n      saving: false,\n      current: 0,\n      selectTables: [],\n      formItemRules: {\n        type: [\n          {required: true, message: '数据库类型不能为空', trigger: 'blur'}\n        ],\n        driverName: [\n          {required: true, message: '驱动名称不能为空', trigger: 'blur'}\n        ],\n        url: [\n          {required: true, message: '数据库连接不能为空', trigger: 'blur'}\n        ],\n        username: [\n          {required: true, message: '用户名不能为空', trigger: 'blur'}\n        ],\n        password: [\n          {required: true, message: '密码不能为空', trigger: 'blur'}\n        ],\n        author: [\n          {required: true, message: '作者不能为空', trigger: 'blur'}\n        ],\n        parentPackage: [\n          {required: true, message: '顶级包名不能为空', trigger: 'blur'}\n        ],\n        moduleName: [\n          {required: true, message: '模块名不能为空', trigger: 'blur'}\n        ],\n        includeTables: [\n          {required: true, message: '生成表名不能为空', trigger: 'blur', type: 'array', min: 1}\n        ],\n        tablePrefix: [\n          {required: true, message: '忽略表名前缀不能为空', trigger: 'blur', type: 'array', min: 1}\n        ]\n      },\n      formItem: {\n        type: 'mysql',\n        driverName: 'com.mysql.cj.jdbc.Driver',\n        url: 'jdbc:mysql://localhost:3306/open-platform?useSSL=false&useUnicode=true&characterEncoding=utf-8&serverTimezone=UTC',\n        username: 'root',\n        password: 'root',\n        author: 'admin',\n        parentPackage: 'com.opencloud',\n        moduleName: 'base',\n        includeTables: [],\n        tablePrefix: []\n      },\n    }\n  },\n  methods: {\n    up () {\n      if (this.current == 0) {\n        this.current = 0;\n      } else {\n        this.current -= 1;\n      }\n    },\n    next () {\n      if (this.current == 1) {\n        this.current = 0;\n      } else {\n        this.current += 1;\n      }\n    },\n    handleSubmit () {\n      this.$refs[\"form\"].validate((valid) => {\n        if (valid) {\n          this.saving = true\n          const data = Object.assign({}, this.formItem)\n          Generate.execute(data).then(res => {\n            if (res.code === 0) {\n              let result = res.data\n              let href = Generate.downloadPath + '?filePath=' + result.filePath\n              this.$Modal.confirm({\n                title: '是否下载',\n                content: `代码生成成功! ${result.fileName}`,\n                onOk: () => {\n                  window.open(href, '_blank');\n                }\n              });\n            }\n          }).finally(() => {\n            this.saving = false\n          })\n        }\n      })\n    },\n    handleTransferChange (newTargetKeys, direction, moveKeys) {\n      let tablePrefix = []\n      newTargetKeys.map(item => {\n        let prefix = item.split(\"_\")[0] + '_'\n        if (!tablePrefix.includes(prefix)) {\n          tablePrefix.push(prefix)\n        }\n      })\n      this.formItem.tablePrefix = tablePrefix\n      this.formItem.includeTables = newTargetKeys\n    }\n  },\n  mounted: function () {\n  },\n  watch: {\n    'current' (val) {\n      let that = this\n      if (val === 1) {\n        Generate.tables(this.formItem).then(res => {\n          if (res.code === 0) {\n            let items = []\n            res.data.map(item => {\n              items.push({\n                key: item.name,\n                label: `${item.name} - ${item.comment}`,\n                disabled: false\n              })\n            })\n            that.selectTables = items\n          }\n        })\n      }\n    }\n  },\n}\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/view/module/system/generate","sourcesContent":["<template>\n  <div>\n    <Card shadow>\n      <Steps :current=\"current\">\n        <Step title=\"数据库连接\"></Step>\n        <Step title=\"生产代码\"></Step>\n      </Steps>\n      <Form style=\"margin-top: 20px;\" ref=\"form\" :model=\"formItem\" :rules=\"formItemRules\" :label-width=\"140\">\n        <FormItem v-show=\"current===0\" label=\"数据库类型\" prop=\"type\">\n          <Select v-model=\"formItem.type\">\n            <Option value=\"mysql\">mysql</Option>\n            <Option disabled value=\"oracle\">oracle</Option>\n          </Select>\n        </FormItem>\n        <FormItem v-show=\"current===0\" label=\"驱动名称\" prop=\"driverName\">\n          <Input v-model=\"formItem.driverName\" placeholder=\"请输入内容\"></Input>\n        </FormItem>\n        <FormItem v-show=\"current===0\" label=\"连接地址\" prop=\"url\">\n          <Input v-model=\"formItem.url\" placeholder=\"请输入内容\"></Input>\n        </FormItem>\n        <FormItem v-show=\"current===0\" label=\"用户名\" prop=\"username\">\n          <Input v-model=\"formItem.username\" placeholder=\"请输入内容\"></Input>\n        </FormItem>\n        <FormItem v-show=\"current===0\" label=\"密码\" prop=\"password\">\n          <Input v-model=\"formItem.password\" type=\"password\" placeholder=\"请输入内容\"></Input>\n        </FormItem>\n        <Row>\n          <Col span=\"10\">\n          <FormItem v-show=\"current===1\" label=\"模块名称\" prop=\"moduleName\">\n            <Input v-model=\"formItem.moduleName\" placeholder=\"请输入内容\"></Input>\n          </FormItem>\n          <FormItem v-show=\"current===1\" label=\"顶级包名\" prop=\"parentPackage\">\n            <Input v-model=\"formItem.parentPackage\" placeholder=\"请输入内容\"></Input>\n          </FormItem>\n          <FormItem v-show=\"current===1\" label=\"作者\" prop=\"author\">\n            <Input v-model=\"formItem.author\" placeholder=\"请输入内容\"></Input>\n          </FormItem>\n          </Col>\n          <Col span=\"14\">\n          <FormItem v-show=\"current===1\" label=\"需要生成的表\" prop=\"includeTables\">\n            <Transfer\n              :data=\"selectTables\"\n              :list-style=\"{width: '45%',height: '500px'}\"\n              :titles=\"['选择表', '已选择表']\"\n              :target-keys=\"formItem.includeTables\"\n              @on-change=\"handleTransferChange\"\n              filterable>\n            </Transfer>\n          </FormItem>\n          <FormItem v-show=\"current===1\" label=\"忽略表前缀\" prop=\"tablePrefix\">\n            <Select v-model=\"formItem.tablePrefix\" multiple style=\"width:260px\">\n              <Option v-for=\"item in formItem.tablePrefix\" :value=\"item\" :key=\"item\">{{ item }}</Option>\n            </Select>\n          </FormItem>\n          </Col>\n        </Row>\n      </Form>\n      <div style=\"margin-top: 20px;text-align: center\">\n        <Button v-if=\"current > 0\" @click=\"up\">上一步</Button>&nbsp;\n        <Button v-if=\"current < 1\" type=\"primary\" @click=\"next\">下一步</Button>&nbsp;\n        <Button v-if=\"current===1\" type=\"success\" @click=\"handleSubmit\" :loading=\"saving\">确定生成</Button>\n      </div>\n    </Card>\n  </div>\n</template>\n\n<script>\n  export default {\n    name: 'Generate',\n    data () {\n      return {\n        saving: false,\n        current: 0,\n        selectTables: [],\n        formItemRules: {\n          type: [\n            {required: true, message: '数据库类型不能为空', trigger: 'blur'}\n          ],\n          driverName: [\n            {required: true, message: '驱动名称不能为空', trigger: 'blur'}\n          ],\n          url: [\n            {required: true, message: '数据库连接不能为空', trigger: 'blur'}\n          ],\n          username: [\n            {required: true, message: '用户名不能为空', trigger: 'blur'}\n          ],\n          password: [\n            {required: true, message: '密码不能为空', trigger: 'blur'}\n          ],\n          author: [\n            {required: true, message: '作者不能为空', trigger: 'blur'}\n          ],\n          parentPackage: [\n            {required: true, message: '顶级包名不能为空', trigger: 'blur'}\n          ],\n          moduleName: [\n            {required: true, message: '模块名不能为空', trigger: 'blur'}\n          ],\n          includeTables: [\n            {required: true, message: '生成表名不能为空', trigger: 'blur', type: 'array', min: 1}\n          ],\n          tablePrefix: [\n            {required: true, message: '忽略表名前缀不能为空', trigger: 'blur', type: 'array', min: 1}\n          ]\n        },\n        formItem: {\n          type: 'mysql',\n          driverName: 'com.mysql.cj.jdbc.Driver',\n          url: 'jdbc:mysql://localhost:3306/open-platform?useSSL=false&useUnicode=true&characterEncoding=utf-8&serverTimezone=UTC',\n          username: 'root',\n          password: 'root',\n          author: 'admin',\n          parentPackage: 'com.opencloud',\n          moduleName: 'base',\n          includeTables: [],\n          tablePrefix: []\n        },\n      }\n    },\n    methods: {\n      up () {\n        if (this.current == 0) {\n          this.current = 0;\n        } else {\n          this.current -= 1;\n        }\n      },\n      next () {\n        if (this.current == 1) {\n          this.current = 0;\n        } else {\n          this.current += 1;\n        }\n      },\n      handleSubmit () {\n        this.$refs[\"form\"].validate((valid) => {\n          if (valid) {\n            this.saving = true\n            const data = Object.assign({}, this.formItem)\n            Generate.execute(data).then(res => {\n              if (res.code === 0) {\n                let result = res.data\n                let href = Generate.downloadPath + '?filePath=' + result.filePath\n                this.$Modal.confirm({\n                  title: '是否下载',\n                  content: `代码生成成功! ${result.fileName}`,\n                  onOk: () => {\n                    window.open(href, '_blank');\n                  }\n                });\n              }\n            }).finally(() => {\n              this.saving = false\n            })\n          }\n        })\n      },\n      handleTransferChange (newTargetKeys, direction, moveKeys) {\n        let tablePrefix = []\n        newTargetKeys.map(item => {\n          let prefix = item.split(\"_\")[0] + '_'\n          if (!tablePrefix.includes(prefix)) {\n            tablePrefix.push(prefix)\n          }\n        })\n        this.formItem.tablePrefix = tablePrefix\n        this.formItem.includeTables = newTargetKeys\n      }\n    },\n    mounted: function () {\n    },\n    watch: {\n      'current' (val) {\n        let that = this\n        if (val === 1) {\n          Generate.tables(this.formItem).then(res => {\n            if (res.code === 0) {\n              let items = []\n              res.data.map(item => {\n                items.push({\n                  key: item.name,\n                  label: `${item.name} - ${item.comment}`,\n                  disabled: false\n                })\n              })\n              that.selectTables = items\n            }\n          })\n        }\n      }\n    },\n  }\n</script>\n"]}]}