(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-33167c7e","chunk-79f6ebd8","chunk-2d23719e","chunk-2d0aa1f3","chunk-2d21aac0","chunk-2d0d6377","chunk-2d228e82","chunk-973c59c0"],{1053:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Card",[a("Form",{ref:"searchForm",attrs:{model:e.pageInfo,inline:"","label-width":80}},[a("FormItem",{attrs:{label:"公司名称",prop:"fullName"}},[a("Input",{attrs:{type:"text",placeholder:"请输入关键字"},model:{value:e.pageInfo.fullName,callback:function(t){e.$set(e.pageInfo,"fullName",t)},expression:"pageInfo.fullName"}})],1),a("FormItem",{attrs:{label:"创建人",prop:"createUse"}},[a("Input",{attrs:{type:"text",placeholder:"请输入关键字"},model:{value:e.pageInfo.createUse,callback:function(t){e.$set(e.pageInfo,"createUse",t)},expression:"pageInfo.createUse"}})],1),a("FormItem",[a("Button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSearch(1)}}},[e._v("查询")]),e._v(" \n        "),a("Button",{on:{click:function(t){return e.handleResetForm("searchForm")}}},[e._v("重置")])],1)],1),a("div",{staticClass:"search-con search-con-top"},[a("ButtonGroup",[a("Button",{attrs:{type:"primary"},on:{click:function(t){return e.handleModal()}}},[a("span",[e._v("添加")])])],1)],1),a("Table",{attrs:{border:"",columns:e.columns,data:e.data,loading:e.loading},scopedSlots:e._u([{key:"status",fn:function(e){var t=e.row;return[1===t.status?a("Badge",{attrs:{status:"success",text:"正常"}}):2===t.status?a("Badge",{attrs:{status:"warning",text:"锁定"}}):a("Badge",{attrs:{status:"error",text:"禁用"}})]}},{key:"action",fn:function(t){var r=t.row;return[a("a",{attrs:{disabled:!e.hasAuthority("systemUserEdit")},on:{click:function(t){return e.handleModal(r)}}},[e._v("编辑")]),e._v(" \n        "),a("Dropdown",{directives:[{name:"show",rawName:"v-show",value:e.hasAuthority("systemUserEdit"),expression:"hasAuthority('systemUserEdit')"}],ref:"dropdown",attrs:{transfer:""},on:{"on-click":function(t){return e.handleClick(t,r)}}},[a("a",{attrs:{href:"javascript:void(0)"}},[a("span",[e._v("更多")]),a("Icon",{attrs:{type:"ios-arrow-down"}})],1),a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[a("DropdownItem",{attrs:{name:"sendToEmail"}},[e._v("发送到密保邮箱")])],1)],1),e._v(" \n      ")]}}])}),a("Page",{attrs:{transfer:"",total:e.pageInfo.total,current:e.pageInfo.page,"page-size":e.pageInfo.limit,"show-elevator":"","show-sizer":"","show-total":""},on:{"on-change":e.handlePage,"on-page-size-change":e.handlePageSize}})],1),a("Modal",{attrs:{title:e.modalTitle,width:"40"},on:{"on-cancel":e.handleReset},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[a("div",[a("Form",{directives:[{name:"show",rawName:"v-show",value:"form1"==e.current,expression:"current == 'form1'"}],ref:"form1",attrs:{model:e.formItem,rules:e.formItemRules,"label-width":100}},[a("FormItem",{attrs:{label:"公司类型",prop:"userType"}},[a("RadioGroup",{model:{value:e.formItem.userType,callback:function(t){e.$set(e.formItem,"userType",t)},expression:"formItem.userType"}},[a("Radio",{attrs:{label:"super"}},[e._v("民企")]),a("Radio",{attrs:{label:"normal"}},[e._v("国企")])],1)],1),a("FormItem",{attrs:{label:"公司全称",prop:"nickName"}},[a("Input",{attrs:{placeholder:"请输入内容"},model:{value:e.formItem.nickName,callback:function(t){e.$set(e.formItem,"nickName",t)},expression:"formItem.nickName"}})],1),a("FormItem",{attrs:{label:"公司简称",prop:"userName"}},[a("Input",{attrs:{disabled:!!e.formItem.userId,placeholder:"请输入内容"},model:{value:e.formItem.userName,callback:function(t){e.$set(e.formItem,"userName",t)},expression:"formItem.userName"}})],1),a("FormItem",{attrs:{label:"公司人数",prop:"number"}},[a("Input",{attrs:{type:"number",placeholder:"请输入内容"},model:{value:e.formItem.number,callback:function(t){e.$set(e.formItem,"number",t)},expression:"formItem.number"}})],1),a("FormItem",{attrs:{label:"创建人",prop:"passwordConfirm"}},[a("Input",{attrs:{type:"text",placeholder:"请输入创建人"},model:{value:e.formItem.passwordConfirm,callback:function(t){e.$set(e.formItem,"passwordConfirm",t)},expression:"formItem.passwordConfirm"}})],1),a("FormItem",{attrs:{label:"邮箱",prop:"email"}},[a("Input",{attrs:{placeholder:"请输入内容"},model:{value:e.formItem.email,callback:function(t){e.$set(e.formItem,"email",t)},expression:"formItem.email"}})],1),a("FormItem",{attrs:{label:"状态"}},[a("RadioGroup",{attrs:{type:"button"},model:{value:e.formItem.status,callback:function(t){e.$set(e.formItem,"status",t)},expression:"formItem.status"}},[a("Radio",{attrs:{label:"0"}},[e._v("禁用")]),a("Radio",{attrs:{label:"1"}},[e._v("正常")]),a("Radio",{attrs:{label:"2"}},[e._v("锁定")])],1)],1),a("FormItem",{attrs:{label:"描述"}},[a("Input",{attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:e.formItem.userDesc,callback:function(t){e.$set(e.formItem,"userDesc",t)},expression:"formItem.userDesc"}})],1)],1),a("div",{staticClass:"drawer-footer"},[a("Button",{attrs:{type:"default"},on:{click:e.handleReset}},[e._v("取消")]),e._v(" \n        "),a("Button",{attrs:{type:"primary",loading:e.saving},on:{click:e.handleSubmit}},[e._v("保存")])],1)],1)])],1)},s=[],o=a("c276"),i=a("6b6c");const l=e=>i["a"].get("company",e);var n={name:"SystemUser",data(){const e=(e,t,a)=>{let r=/^[_a-zA-Z0-9]+$/,s=/^.{4,18}$/;""===t?a(new Error("登录名不能为空")):""===t||r.test(t)?""===t||s.test(t)?a():a(new Error("长度6到18个字符")):a(new Error("只允许字母、数字、下划线"))},t=(e,t,a)=>{let r=/^.{6,18}$/;""===t?a(new Error("请输入密码")):t!==this.formItem.password?a(new Error("两次输入密码不一致")):""===t||r.test(t)?a():a(new Error("长度6到18个字符"))},a=(e,t,a)=>{""===t?a(new Error("请再次输入密码")):t!==this.formItem.password?a(new Error("两次输入密码不一致")):a()},r=(e,t,a)=>{let r=/^1\d{10}$/;""===t||r.test(t)?a():a(new Error("手机号码格式不正确"))};return{loading:!1,saving:!1,modalVisible:!1,modalTitle:"",current:"form1",forms:["form1"],selectMenus:[],selectRoles:[],pageInfo:{page:1,pageSize:10,sort:"createTime",order:"desc"},formItemRules:{userType:[{required:!0,message:"用户类型不能为空",trigger:"blur"}],userName:[{required:!0,message:"用户名不能为空",trigger:"blur"},{required:!0,validator:e,trigger:"blur"}],password:[{required:!0,validator:t,trigger:"blur"}],passwordConfirm:[{required:!0,validator:a,trigger:"blur"}],nickName:[{required:!0,message:"昵称不能为空",trigger:"blur"}],email:[{required:!1,type:"email",message:"邮箱格式不正确",trigger:"blur"}],mobile:[{validator:r,trigger:"blur"}]},formItem:{userId:"",userName:"",nickName:"",password:"",passwordConfirm:"",status:1,companyId:"",email:"",mobile:"",userType:"normal",userDesc:"",avatar:"",grantRoles:[],grantActions:[],grantMenus:[],expireTime:"",isExpired:!1},columns:[{type:"selection",width:60},{title:"公司全称",key:"fullName"},{title:"公司简称",key:"simpleName"},{title:"邮箱",key:"email"},{title:"创建人",key:"createUser"},{title:"公司类型",key:"deptType"},{title:"更新时间",key:"updateTime"},{title:"操作人",key:"updateUser"},{title:"操作",slot:"action",fixed:"right",width:150}],columns2:[{title:"菜单",key:"menuName",minWidth:"250px"},{title:"操作",type:"template",template:"operation",minWidth:"200px"}],data:[]}},methods:{handleModal(e){e&&(this.formItem=Object.assign({},this.formItem,e)),this.current===this.forms[0]&&(this.modalTitle=e?"编辑公司 - "+e.userName:"添加公司",this.modalVisible=!0),this.formItem.status=this.formItem.status+""},handleResetForm(e){},handleReset(){const e={userId:"",userName:"",nickName:"",password:"",passwordConfirm:"",status:1,companyId:"",email:"",mobile:"",userType:"normal",userDesc:"",avatar:"",grantRoles:[],grantMenus:[],grantActions:[],expireTime:"",isExpired:!1};this.formItem=e,this.forms.map(e=>{this.handleResetForm(e)}),this.current=this.forms[0],this.formItem.grantMenus=[],this.formItem.grantActions=[],this.modalVisible=!1,this.saving=!1},handleSubmit(){this.current===this.forms[0]&&this.$refs[this.current].validate(e=>{e&&(this.saving=!0,this.formItem.userId?updateUser(this.formItem).then(e=>{0===e.code&&(this.$Message.success("保存成功"),this.handleReset()),this.handleSearch()}).finally(()=>{this.saving=!1}):addUser(this.formItem).then(e=>{0===e.code&&(this.$Message.success("保存成功"),this.handleReset()),this.handleSearch()}).finally(()=>{this.saving=!1}))})},handleSearch(e){e&&(this.pageInfo.page=e),this.loading=!0,getUsers(this.pageInfo).then(e=>{this.data=e.data.records,this.pageInfo.total=parseInt(e.data.total)}).finally(()=>{this.loading=!1})},getCheckedAuthorities(){const e=this.$refs["tree"].getCheckedProp("authorityId");return e.concat(this.formItem.grantActions)},handleLoadUserGranted(e){const t=this,a=getAuthorityUser(e),r=[];Promise.all([p1,a]).then((function(e){let a=e[0],s=e[1];if(0===a.code&&a.data){let e={primaryKey:"menuId",parentKey:"parentId",startPid:"0"};if(0===s.code&&s.data&&s.data.length>0){let e=[],a=[];s.data.map(t=>{"role"===t.owner&&r.push(t.authorityId),-1==t.authority.indexOf("MENU_")||e.includes(t.authorityId)||e.push(t.authorityId),-1==t.authority.indexOf("ACTION_")||a.includes(t.authorityId)||a.push(t.authorityId)}),t.formItem.grantMenus=e,t.formItem.grantActions=a,s.data.length>0&&(t.formItem.expireTime=s.data[0].expireTime,t.formItem.isExpired=s.data[0].isExpired)}a.data.map(e=>{t.formItem.grantMenus.includes(e.authorityId)&&(e._isChecked=!0,r.includes(e.authorityId)&&(e.disabled=!0,e.menuName+=" (禁止勾选)")),e.actionList.map(e=>{r.includes(e.authorityId)&&(e.disabled=!0)})}),t.selectMenus=Object(o["j"])(a.data,e)}t.modalVisible=!0}))},handleLoadRoles(e){if(!e)return;const t=this,a=getAllRoles(),r=getUserRoles(e);Promise.all([a,r]).then((function(e){let a=e[0],r=e[1];if(0===a.code&&(t.selectRoles=a.data),0===r.code){let e=[];r.data.map(t=>{e.push(t.roleId)}),t.formItem.grantRoles=e}t.modalVisible=!0}))},handlePage(e){this.pageInfo.page=e,this.handleSearch()},handlePageSize(e){this.pageInfo.limit=e,this.handleSearch()},handleClick(e,t){switch(e){case"sendToEmail":this.$Message.warning("发送至密保邮箱,开发中...");break}},handleTabClick(e){this.current=e,this.handleModal()},loadList(){l().then(e=>{console.log(e)})}},mounted:function(){}},m=n,d=a("4e82"),c=Object(d["a"])(m,r,s,!1,null,null,null);t["default"]=c.exports},"1f44":function(e,t,a){},"2c6c":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Card",{attrs:{shadow:""}},[a("Form",{ref:"searchForm",attrs:{model:e.pageInfo,inline:"","label-width":80}},[a("FormItem",{attrs:{label:"请求路径",prop:"path"}},[a("Input",{attrs:{type:"text",placeholder:"请输入关键字"},model:{value:e.pageInfo.path,callback:function(t){e.$set(e.pageInfo,"path",t)},expression:"pageInfo.path"}})],1),a("FormItem",{attrs:{label:"接口名称",prop:"apiName"}},[a("Input",{attrs:{type:"text",placeholder:"请输入关键字"},model:{value:e.pageInfo.apiName,callback:function(t){e.$set(e.pageInfo,"apiName",t)},expression:"pageInfo.apiName"}})],1),a("FormItem",{attrs:{label:"接口编码",prop:"apiCode"}},[a("Input",{attrs:{type:"text",placeholder:"请输入关键字"},model:{value:e.pageInfo.apiCode,callback:function(t){e.$set(e.pageInfo,"apiCode",t)},expression:"pageInfo.apiCode"}})],1),a("FormItem",{attrs:{label:"服务名",prop:"serviceId"}},[a("Input",{attrs:{type:"text",placeholder:"请输入关键字"},model:{value:e.pageInfo.serviceId,callback:function(t){e.$set(e.pageInfo,"serviceId",t)},expression:"pageInfo.serviceId"}})],1),a("FormItem",[a("Button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSearch(1)}}},[e._v("查询")]),e._v(" \n        "),a("Button",{on:{click:function(t){return e.handleResetForm("searchForm")}}},[e._v("重置")])],1)],1),a("div",{staticClass:"search-con search-con-top"},[a("ButtonGroup",[a("Button",{staticClass:"search-btn",attrs:{disabled:!e.hasAuthority("systemApiEdit"),type:"primary"},on:{click:function(t){return e.handleModal()}}},[a("span",[e._v("添加")])])],1),e.tableSelection.length>0&&e.hasAuthority("systemApiEdit")?a("Dropdown",{staticStyle:{"margin-left":"20px"},on:{"on-click":e.handleBatchClick}},[a("Button",[a("span",[e._v("批量操作")]),a("Icon",{attrs:{type:"ios-arrow-down"}})],1),a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[a("DropdownItem",{attrs:{name:"remove"}},[e._v("删除")]),a("Dropdown",{attrs:{placement:"right-start"}},[a("DropdownItem",[a("span",[e._v("状态")]),a("Icon",{attrs:{type:"ios-arrow-forward"}})],1),a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[a("DropdownItem",{attrs:{name:"status1"}},[e._v("启用")]),a("DropdownItem",{attrs:{name:"status2"}},[e._v("禁用")]),a("DropdownItem",{attrs:{name:"status3"}},[e._v("维护中")])],1)],1),a("Dropdown",{attrs:{placement:"right-start"}},[a("DropdownItem",[a("span",[e._v("公开访问")]),a("Icon",{attrs:{type:"ios-arrow-forward"}})],1),a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[a("DropdownItem",{attrs:{name:"open1"}},[e._v("允许公开访问")]),a("DropdownItem",{attrs:{name:"open2"}},[e._v("拒绝公开访问")])],1)],1),a("Dropdown",{attrs:{placement:"right-start"}},[a("DropdownItem",[a("span",[e._v("身份认证")]),a("Icon",{attrs:{type:"ios-arrow-forward"}})],1),a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[a("DropdownItem",{attrs:{name:"auth1"}},[e._v("开启身份认证")]),a("DropdownItem",{attrs:{name:"auth2"}},[e._v("关闭身份认证")])],1)],1)],1)],1):e._e()],1),a("Alert",{attrs:{"show-icon":""}},[a("span",[e._v("自动扫描"),a("code",[e._v("@EnableResourceServer")]),e._v("资源服务器接口信息,注:自动添加的接口,都是未公开的. "),a("code",[e._v('只有公开的接口,才可以通过网关访问。否则将提示:"请求地址,拒绝访问!"')])])]),a("Table",{attrs:{border:"",columns:e.columns,data:e.data,loading:e.loading},on:{"on-selection-change":e.handleTableSelectChange},scopedSlots:e._u([{key:"apiName",fn:function(t){var r=t.row;return[a("span",[e._v(e._s(r.apiName))])]}},{key:"isAuth",fn:function(t){var r=t.row;return[1===r.isOpen?a("Tag",{attrs:{color:"green"}},[e._v("允许公开访问")]):1!==r.isOpen?a("Tag",{attrs:{color:"red"}},[e._v("拒绝公开访问")]):e._e(),1===r.isAuth?a("Tag",{attrs:{color:"green"}},[e._v("开启身份认证")]):1!==r.isAuth?a("Tag",{attrs:{color:"red"}},[e._v("关闭身份认证")]):e._e(),1===r.status?a("Tag",{attrs:{color:"green"}},[e._v("启用")]):2===r.status?a("Tag",{attrs:{color:"orange"}},[e._v("维护中")]):a("Tag",{attrs:{color:"red"}},[e._v("禁用")])]}},{key:"action",fn:function(t){var r=t.row;return[a("a",{attrs:{disabled:!e.hasAuthority("systemApiEdit")},on:{click:function(t){return e.handleModal(r)}}},[e._v("\n          编辑")]),e._v(" \n        "),a("a",{attrs:{disabled:!e.hasAuthority("systemApiEdit")},on:{click:function(t){return e.handleRemove(r)}}},[e._v("\n          删除")])]}}])}),a("Page",{attrs:{transfer:"",total:e.pageInfo.total,current:e.pageInfo.page,"page-size":e.pageInfo.limit,"show-elevator":"","show-sizer":"","show-total":""},on:{"on-change":e.handlePage,"on-page-size-change":e.handlePageSize}})],1),a("Modal",{attrs:{title:e.modalTitle,width:"40"},on:{"on-cancel":e.handleReset},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[a("div",[!e.formItem.apiId?e._e():a("Alert",{attrs:{"show-icon":""}},[a("span",[e._v("自动扫描接口swagger注解。")]),a("Poptip",{attrs:{placement:"bottom",title:"示例代码"}},[a("a",[e._v("示例代码")]),a("div",{attrs:{slot:"content"},slot:"content"},[a("div",{directives:[{name:"highlight",rawName:"v-highlight"}]},[a("pre",[e._v('                    // 接口介绍\n                    @ApiOperation(value = "接口名称", notes = "接口备注")\n                    @PostMapping("/testApi")\n                    // 忽略接口,将不再添加或修改次接口\n                    @ApiIgnore\n                    public ResultBody testApi() {\n                        return ResultBody.success();\n                    }\n              ')])])])])],1),a("Form",{ref:"form1",attrs:{model:e.formItem,rules:e.formItemRules,"label-width":100}},[a("FormItem",{attrs:{label:"服务名称",prop:"serviceId"}},[a("Select",{attrs:{disabled:!(!e.formItem.apiId||1!==e.formItem.isPersist),filterable:"",clearable:""},model:{value:e.formItem.serviceId,callback:function(t){e.$set(e.formItem,"serviceId",t)},expression:"formItem.serviceId"}},e._l(e.selectServiceList,(function(t,r){return a("Option",{key:r,attrs:{value:t.serviceId}},[e._v(e._s(t.serviceName))])})),1)],1),a("FormItem",{attrs:{label:"接口分类",prop:"apiCategory"}},[a("Input",{attrs:{placeholder:"请输入内容"},model:{value:e.formItem.apiCategory,callback:function(t){e.$set(e.formItem,"apiCategory",t)},expression:"formItem.apiCategory"}})],1),a("FormItem",{attrs:{label:"接口编码",prop:"apiCode"}},[a("Input",{attrs:{disabled:!(!e.formItem.apiId||1!==e.formItem.isPersist),placeholder:"请输入内容"},model:{value:e.formItem.apiCode,callback:function(t){e.$set(e.formItem,"apiCode",t)},expression:"formItem.apiCode"}})],1),a("FormItem",{attrs:{label:"接口名称",prop:"apiName"}},[a("Input",{attrs:{disabled:!(!e.formItem.apiId||1!==e.formItem.isPersist),placeholder:"请输入内容"},model:{value:e.formItem.apiName,callback:function(t){e.$set(e.formItem,"apiName",t)},expression:"formItem.apiName"}})],1),a("FormItem",{attrs:{label:"请求地址",prop:"path"}},[a("Input",{attrs:{disabled:!(!e.formItem.apiId||1!==e.formItem.isPersist),placeholder:"请输入内容"},model:{value:e.formItem.path,callback:function(t){e.$set(e.formItem,"path",t)},expression:"formItem.path"}})],1),a("FormItem",{attrs:{label:"优先级"}},[a("InputNumber",{model:{value:e.formItem.priority,callback:function(t){e.$set(e.formItem,"priority",t)},expression:"formItem.priority"}})],1),a("FormItem",{attrs:{label:"身份认证"}},[a("RadioGroup",{attrs:{type:"button"},model:{value:e.formItem.isAuth,callback:function(t){e.$set(e.formItem,"isAuth",t)},expression:"formItem.isAuth"}},[a("Radio",{attrs:{disabled:!(!e.formItem.apiId||1!==e.formItem.isPersist),label:"0"}},[e._v("关闭")]),a("Radio",{attrs:{disabled:!(!e.formItem.apiId||1!==e.formItem.isPersist),label:"1"}},[e._v("开启")])],1),a("p",[a("code",[e._v('开启：未认证登录,提示"认证失败,请重新登录!";关闭: 不需要认证登录')])])],1),a("FormItem",{attrs:{label:"公开访问"}},[a("RadioGroup",{attrs:{type:"button"},model:{value:e.formItem.isOpen,callback:function(t){e.$set(e.formItem,"isOpen",t)},expression:"formItem.isOpen"}},[a("Radio",{attrs:{label:"0"}},[e._v("拒绝")]),a("Radio",{attrs:{label:"1"}},[e._v("允许")])],1),a("p",[a("code",[e._v('拒绝:提示"请求地址,拒绝访问!"')])])],1),a("FormItem",{attrs:{label:"状态"}},[a("RadioGroup",{attrs:{type:"button"},model:{value:e.formItem.status,callback:function(t){e.$set(e.formItem,"status",t)},expression:"formItem.status"}},[a("Radio",{attrs:{label:"0"}},[e._v("禁用")]),a("Radio",{attrs:{label:"1"}},[e._v("启用")]),a("Radio",{attrs:{label:"2"}},[e._v("维护中")])],1),a("p",[a("code",[e._v('禁用：提示"请求地址,禁止访问!";维护中：提示"正在升级维护中,请稍后再试!";')])])],1),a("FormItem",{attrs:{label:"描述"}},[a("Input",{attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:e.formItem.apiDesc,callback:function(t){e.$set(e.formItem,"apiDesc",t)},expression:"formItem.apiDesc"}})],1)],1),a("div",{staticClass:"drawer-footer"},[a("Button",{attrs:{type:"default"},on:{click:e.handleReset}},[e._v("取消")]),e._v(" \n        "),a("Button",{attrs:{type:"primary",loading:e.saving},on:{click:e.handleSubmit}},[e._v("保存")])],1)],1)])],1)},s=[],o=(a("c276"),{name:"SystemApi",data(){const e=(e,t,a)=>{let r=/^[_.a-zA-Z0-9]+$/;""===t?a(new Error("接口标识不能为空")):""===t||r.test(t)?a():a(new Error("只允许字母、数字、点、下划线"))};return{loading:!1,modalVisible:!1,modalTitle:"",saving:!1,tableSelection:[],pageInfo:{total:0,page:1,limit:10,path:"",apiName:"",apiCode:"",serviceId:""},selectServiceList:[],formItemRules:{serviceId:[{required:!0,message:"所属服务不能为空",trigger:"blur"}],apiCategory:[{required:!0,message:"接口分类不能为空",trigger:"blur"}],path:[{required:!0,message:"接口地址不能为空",trigger:"blur"}],apiCode:[{required:!0,validator:e,trigger:"blur"}],apiName:[{required:!0,message:"接口名称不能为空",trigger:"blur"}]},formItem:{apiId:"",apiCode:"",apiName:"",apiCategory:"default",path:"",status:1,isAuth:1,openSwatch:!1,authSwatch:!0,serviceId:"",priority:0,apiDesc:"",isOpen:1},columns:[{type:"selection",width:60,align:"center"},{title:"编码",key:"apiCode",width:300},{title:"名称",key:"apiName",slot:"apiName",width:300,filters:[{label:"禁用",value:0},{label:"启用",value:1}],filterMultiple:!1,filterMethod(e,t){return 0===e?0===t.status:1===e?1===t.status:void 0}},{title:"地址",key:"path",width:200},{title:"分类",key:"apiCategory",width:100},{title:"服务名称",key:"serviceId",width:200},{title:"接口安全",key:"isAuth",slot:"isAuth",width:300},{title:"描述",key:"apiDesc",width:200},{title:"最后更新时间",key:"updateTime",width:180},{title:"操作",key:"",slot:"action",fixed:"right",width:120}],data:[]}},methods:{handleModal(e){e?(this.modalTitle="编辑接口 - "+e.apiName,this.formItem=Object.assign({},this.formItem,e)):this.modalTitle="添加接口",this.formItem.status=this.formItem.status+"",this.formItem.isAuth=this.formItem.isAuth+"",this.formItem.isOpen=this.formItem.isOpen+"",this.modalVisible=!0},handleResetForm(e){this.$refs[e].resetFields()},handleReset(){const e={apiId:"",apiCode:"",apiName:"",apiCategory:"default",path:"",status:1,isAuth:1,serviceId:"",priority:0,apiDesc:"",isOpen:1};this.formItem=e,this.handleResetForm("form1"),this.modalVisible=!1,this.saving=!1},handleSubmit(){this.$refs["form1"].validate(e=>{e&&(this.saving=!0,this.formItem.apiId)})},handleRemove(e){this.$Modal.confirm({title:"确定删除吗？",onOk:()=>{}})},handleSearch(e){this.tableSelection=[],e&&(this.pageInfo.page=e),this.loading=!0},handlePage(e){this.pageInfo.page=e,this.handleSearch()},handlePageSize(e){this.pageInfo.limit=e,this.handleSearch()},handleLoadServiceList(){},handleTableSelectChange(e){this.tableSelection=e},handleBatchClick(e){e&&this.$Modal.confirm({title:`已勾选${this.tableSelection.length}项,是否继续执行操作？`,onOk:()=>{let t=[];switch(this.tableSelection.map(e=>{t.includes(e.apiId)||t.push(e.apiId)}),e){case"remove":break;case"open1":break;case"open2":break;case"status1":break;case"status2":break;case"status3":break;case"auth1":break;case"auth2":break}}})}},mounted:function(){}}),i=o,l=a("4e82"),n=Object(l["a"])(i,r,s,!1,null,null,null);t["default"]=n.exports},"4b4a":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("添加模板")]),a("Button",{on:{click:function(t){return e.handleSelectAll(!0)}}},[e._v("Set all selected")]),a("Button",{on:{click:function(t){return e.handleSelectAll(!1)}}},[e._v("Cancel all selected")]),a("Table",{ref:"selection",staticClass:"mt10",attrs:{border:"",columns:e.columns,data:e.data}}),a("div",{staticClass:"g-tr"},[a("Page",{attrs:{total:100,"show-elevator":""}})],1)],1)},s=[],o={data(){return{columns:[{type:"selection",width:60,align:"center"},{title:"产品名称",align:"center",key:"name"},{title:"产品封面",key:"cover"},{title:"模板url",key:"url"},{title:"操作",render:(e,t)=>{return e("div",[e("span",{props:{type:"text",size:"small"},class:"op",on:{click:()=>{console.log("edit",t)}}},"编辑"),e("span",{props:{type:"text",size:"small"},class:"op",on:{click:()=>{console.log("del",t)}}},"删除")])}}],data:[{name:"John Brown",cover:18,url:"New York No. 1 Lake Park"}]}},methods:{handleSelectAll(e){},add(){console.log(11111),this.$router.push({name:"add"})}}},i=o,l=(a("f26d"),a("4e82")),n=Object(l["a"])(i,r,s,!1,null,null,null);t["default"]=n.exports},"4e48":function(e,t,a){var r={"./account/setting.vue":"fa32","./activity/index.vue":"fa4a","./company/index.vue":"1053","./gateway/ip-limit/index.vue":"dc58","./gateway/logs/index.vue":"765b","./gateway/rate-limit/index.vue":"7dcc","./gateway/route/index.vue":"f5ae","./msg/webhook/index.vue":"ff86","./product/add/add.vue":"bd08","./product/index.vue":"4b4a","./system/api/index.vue":"2c6c","./system/app/index.vue":"efe7","./system/developer/index.vue":"7cf8","./system/generate/index.vue":"ec7e","./system/menus/index.vue":"59ea","./system/menus/menu-action.vue":"20c4","./system/role/index.vue":"7239","./system/user/index.vue":"dad3","./task/job/index.vue":"834f","./task/logs/index.vue":"9bbb"};function s(e){var t=o(e);return a(t)}function o(e){if(!a.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}s.keys=function(){return Object.keys(r)},s.resolve=o,e.exports=s,s.id="4e48"},"5dbf":function(e,t,a){},"67cf":function(e,t,a){"use strict";var r=a("1f44"),s=a.n(r);s.a},7239:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Card",{attrs:{shadow:""}},[a("Form",{ref:"searchForm",attrs:{model:e.pageInfo,inline:"","label-width":80}},[a("FormItem",{attrs:{label:"角色名称",prop:"roleName"}},[a("Input",{attrs:{type:"text",placeholder:"请输入关键字"},model:{value:e.pageInfo.roleName,callback:function(t){e.$set(e.pageInfo,"roleName",t)},expression:"pageInfo.roleName"}})],1),a("FormItem",{attrs:{label:"角色编码",prop:"roleCode"}},[a("Input",{attrs:{type:"text",placeholder:"请输入关键字"},model:{value:e.pageInfo.roleCode,callback:function(t){e.$set(e.pageInfo,"roleCode",t)},expression:"pageInfo.roleCode"}})],1),a("FormItem",[a("Button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSearch(1)}}},[e._v("查询")]),e._v(" \n        "),a("Button",{on:{click:function(t){return e.handleResetForm("searchForm")}}},[e._v("重置")])],1)],1),a("div",{staticClass:"search-con search-con-top"},[a("ButtonGroup",[a("Button",{staticClass:"search-btn",attrs:{type:"primary"},on:{click:function(t){return e.handleModal()}}},[a("span",[e._v("添加")])])],1)],1),a("Table",{attrs:{border:"",columns:e.columns,data:e.data,loading:e.loading},scopedSlots:e._u([{key:"status",fn:function(e){var t=e.row;return[1===t.status?a("Badge",{attrs:{status:"success",text:"启用"}}):a("Badge",{attrs:{status:"error",text:"禁用"}})]}},{key:"action",fn:function(t){var r=t.row;return[a("a",{attrs:{disabled:"all"==r.roleCode||!e.hasAuthority("systemRoleEdit")},on:{click:function(t){return e.handleModal(r)}}},[e._v("编辑")]),e._v(" \n        "),a("Dropdown",{directives:[{name:"show",rawName:"v-show",value:e.hasAuthority("systemRoleEdit"),expression:"hasAuthority('systemRoleEdit')"}],ref:"dropdown",attrs:{transfer:""},on:{"on-click":function(t){return e.handleClick(t,r)}}},[a("a",{attrs:{href:"javascript:void(0)",disabled:"all"===r.roleCode}},[a("span",[e._v("更多")]),a("Icon",{attrs:{type:"ios-arrow-down"}})],1),a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[a("DropdownItem",{attrs:{name:"remove"}},[e._v("删除角色")])],1)],1),e._v(" \n      ")]}}])}),a("Page",{attrs:{transfer:"",total:e.pageInfo.total,current:e.pageInfo.page,"page-size":e.pageInfo.limit,"show-elevator":"","show-sizer":"","show-total":""},on:{"on-change":e.handlePage,"on-page-size-change":e.handlePageSize}})],1),a("Modal",{attrs:{title:e.modalTitle,width:"50"},on:{"on-cancel":e.handleReset},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[a("div",[a("Tabs",{attrs:{value:e.current},on:{"on-click":e.handleTabClick}},[a("TabPane",{attrs:{label:"角色信息",name:"form1"}},[a("Form",{directives:[{name:"show",rawName:"v-show",value:"form1"==e.current,expression:"current == 'form1'"}],ref:"form1",attrs:{model:e.formItem,rules:e.formItemRules,"label-width":100}},[a("FormItem",{attrs:{label:"角色标识",prop:"roleCode"}},[a("Input",{attrs:{placeholder:"请输入内容"},model:{value:e.formItem.roleCode,callback:function(t){e.$set(e.formItem,"roleCode",t)},expression:"formItem.roleCode"}})],1),a("FormItem",{attrs:{label:"角色名称",prop:"roleName"}},[a("Input",{attrs:{placeholder:"请输入内容"},model:{value:e.formItem.roleName,callback:function(t){e.$set(e.formItem,"roleName",t)},expression:"formItem.roleName"}})],1),a("FormItem",{attrs:{label:"状态"}},[a("RadioGroup",{attrs:{type:"button"},model:{value:e.formItem.status,callback:function(t){e.$set(e.formItem,"status",t)},expression:"formItem.status"}},[a("Radio",{attrs:{label:"0"}},[e._v("禁用")]),a("Radio",{attrs:{label:"1"}},[e._v("启用")])],1)],1),a("FormItem",{attrs:{label:"描述"}},[a("Input",{attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:e.formItem.roleDesc,callback:function(t){e.$set(e.formItem,"roleDesc",t)},expression:"formItem.roleDesc"}})],1)],1)],1),a("TabPane",{attrs:{label:"分配权限",name:"form2"}},[a("Form",{directives:[{name:"show",rawName:"v-show",value:"form2"==e.current,expression:"current == 'form2'"}],ref:"form2",attrs:{model:e.formItem,rules:e.formItemRules,"label-width":100}},[a("FormItem",{attrs:{label:"过期时间",prop:"expireTime"}},[e.formItem.isExpired?a("Badge",{attrs:{text:"授权已过期"}},[a("DatePicker",{staticClass:"ivu-form-item-error",attrs:{type:"datetime",placeholder:"设置有效期"},model:{value:e.formItem.expireTime,callback:function(t){e.$set(e.formItem,"expireTime",t)},expression:"formItem.expireTime"}})],1):a("DatePicker",{attrs:{type:"datetime",placeholder:"设置有效期"},model:{value:e.formItem.expireTime,callback:function(t){e.$set(e.formItem,"expireTime",t)},expression:"formItem.expireTime"}})],1),a("FormItem",{attrs:{label:"功能菜单",prop:"grantMenus"}},[a("tree-table",{ref:"tree",staticStyle:{"max-height":"480px",overflow:"auto"},attrs:{"expand-key":"menuName","expand-type":!1,"is-fold":!1,"tree-type":!0,selectable:!0,columns:e.columns2,data:e.selectMenus}},[a("template",{slot:"operation"},[a("CheckboxGroup",{model:{value:e.formItem.grantActions,callback:function(t){e.$set(e.formItem,"grantActions",t)},expression:"formItem.grantActions"}},e._l(e.actionList,(function(t,r){return a("Checkbox",{key:r,attrs:{label:t.authorityId}},[a("span",{attrs:{title:t.actionDesc}},[e._v(e._s(t.actionName))])])})),1)],1)],2)],1)],1)],1),a("TabPane",{attrs:{label:"角色成员",name:"form3"}},[a("Form",{directives:[{name:"show",rawName:"v-show",value:"form3"==e.current,expression:"current == 'form3'"}],ref:"form3",attrs:{model:e.formItem,rules:e.formItemRules}},[a("FormItem",{attrs:{prop:"authorities"}},[a("Transfer",{attrs:{data:e.selectUsers,"list-style":{width:"45%",height:"480px"},titles:["选择用户","已选择用户"],"render-format":e.transferRender,"target-keys":e.formItem.userIds,filterable:""},on:{"on-change":e.handleTransferChange}})],1)],1)],1)],1),a("div",{staticClass:"drawer-footer"},[a("Button",{attrs:{type:"default"},on:{click:e.handleReset}},[e._v("取消")]),e._v(" \n        "),a("Button",{attrs:{type:"primary",loading:e.saving},on:{click:e.handleSubmit}},[e._v("保存")])],1)],1)])],1)},s=[],o=a("c276"),i={name:"SystemRole",data(){const e=(e,t,a)=>{let r=/^[_a-zA-Z0-9]+$/;""===t?a(new Error("角色标识不能为空")):""===t||r.test(t)?a():a(new Error("只允许字母、数字、下划线"))};return{titles:["选择接口","已选择接口"],listStyle:{width:"240px",height:"500px"},loading:!1,modalVisible:!1,modalTitle:"",saving:!1,current:"form1",forms:["form1","form2","form3"],selectApis:[],selectMenus:[{id:1,menuName:"KKKKey"},{id:2,menuName:"斤斤计较"}],selectUsers:[],pageInfo:{total:0,page:1,limit:10,roleCode:"",roleName:""},formItemRules:{roleCode:[{required:!0,validator:e,trigger:"blur"}],roleName:[{required:!0,message:"角色名称不能为空",trigger:"blur"}]},actionList:[{actionDesc:"aaa",authorityId:1,actionName:"哈哈哈哈"},{actionDesc:"aaa",authorityId:2,actionName:"呵呵呵呵呵"}],formItem:{roleId:"",roleCode:"",roleName:"",path:"",status:1,menuId:"",priority:0,roleDesc:"",grantMenus:[],grantActions:[],expireTime:"",isExpired:!1,userIds:[]},columns:[{type:"selection",width:60,align:"center"},{title:"角色名称",key:"roleName",width:300},{title:"角色标识",key:"roleCode",width:300},{title:"状态",slot:"status",key:"status",width:100,filters:[{label:"禁用",value:0},{label:"启用",value:1}],filterMultiple:!1,filterMethod(e,t){return 0===e?0===t.status:1===e?1===t.status:void 0}},{title:"最后修改时间",key:"updateTime",width:200},{title:"描述",key:"roleDesc"},{title:"操作",slot:"action",fixed:"right",width:150}],columns2:[{title:"菜单",key:"menuName",minWidth:"250px"},{title:"操作",type:"template",template:"operation",minWidth:"200px"}],data:[]}},methods:{handleModal(e){e&&(this.formItem=Object.assign({},this.formItem,e)),this.current===this.forms[0]&&(this.modalTitle=e?"编辑角色 - "+e.roleName:"添加角色",this.modalVisible=!0),this.current===this.forms[1]&&(this.modalTitle=e?"分配权限 - "+e.roleName:"分配权限",this.handleLoadRoleGranted(this.formItem.roleId)),this.current===this.forms[2]&&(this.modalTitle=e?"角色成员 - "+e.roleName:"角色成员",this.handleLoadRoleUsers(this.formItem.roleId)),this.formItem.status=this.formItem.status+""},handleResetForm(e){this.$refs[e].resetFields()},handleTabClick(e){this.current=e,this.handleModal()},handleReset(){const e={roleId:"",roleCode:"",roleName:"",path:"",status:1,menuId:"",priority:0,roleDesc:"",grantMenus:[],grantActions:[],expireTime:"",isExpired:!1,userIds:[]};this.formItem=e,this.forms.map(e=>{this.handleResetForm(e)}),this.current=this.forms[0],this.formItem.grantMenus=[],this.formItem.grantActions=[],this.modalVisible=!1,this.saving=!1},handleSubmit(){this.current===this.forms[0]&&this.$refs[this.current].validate(e=>{e&&(this.saving=!0,this.formItem.roleId?updateRole(this.formItem).then(e=>{0===e.code&&(this.$Message.success("保存成功"),this.handleReset()),this.handleSearch()}).finally(()=>{this.saving=!1}):addRole(this.formItem).then(e=>{0===e.code&&(this.$Message.success("保存成功"),this.handleReset()),this.handleSearch()}).finally(()=>{this.saving=!1}))}),this.current===this.forms[1]&&this.$refs[this.current].validate(e=>{if(e){const e=this.getCheckedAuthorities();this.saving=!0,grantAuthorityRole({roleId:this.formItem.roleId,expireTime:this.formItem.expireTime?this.formItem.expireTime.pattern("yyyy-MM-dd HH:mm:ss"):"",authorityIds:e}).then(e=>{0===e.code&&(this.$Message.success("授权成功"),this.handleReset()),this.handleSearch()}).finally(()=>{this.saving=!1})}}),this.current===this.forms[2]&&this.$refs[this.current].validate(e=>{e&&(this.saving=!0,addRoleUsers({roleId:this.formItem.roleId,userIds:this.formItem.userIds}).then(e=>{0===e.code&&(this.$Message.success("保存成功"),this.handleReset()),this.handleSearch()}).finally(()=>{this.saving=!1}))})},handleSearch(e){e&&(this.pageInfo.page=e),this.loading=!0,getRoles(this.pageInfo).then(e=>{this.data=e.data.records,this.pageInfo.total=parseInt(e.data.total)}).finally(()=>{this.loading=!1})},handlePage(e){this.pageInfo.page=e,this.handleSearch()},handlePageSize(e){this.pageInfo.limit=e,this.handleSearch()},handleRemove(e){this.$Modal.confirm({title:"确定删除吗？",onOk:()=>{removeRole(e.roleId).then(e=>{0===e.code&&(this.pageInfo.page=1,this.$Message.success("删除成功")),this.handleSearch()})}})},getCheckedAuthorities(){const e=this.$refs["tree"].getCheckedProp("authorityId");return e.concat(this.formItem.grantActions)},handleLoadRoleGranted(e){if(!e)return;const t=this,a=getAuthorityMenu(),r=getAuthorityRole(e);Promise.all([a,r]).then((function(e){let a=e[0],r=e[1];if(0===a.code&&a.data){let e={primaryKey:"menuId",parentKey:"parentId",startPid:"0"};if(0===r.code&&r.data&&r.data.length>0){let e=[],a=[];r.data.map(t=>{-1==t.authority.indexOf("MENU_")||e.includes(t.authorityId)||e.push(t.authorityId),-1==t.authority.indexOf("ACTION_")||a.includes(t.authorityId)||a.push(t.authorityId)}),t.formItem.grantMenus=e,t.formItem.grantActions=a,r.data.length>0&&(t.formItem.expireTime=r.data[0].expireTime,t.formItem.isExpired=r.data[0].isExpired)}a.data.map(e=>{t.formItem.grantMenus.includes(e.authorityId)&&(e._isChecked=!0)}),t.selectMenus=Object(o["j"])(a.data,e)}t.modalVisible=!0}))},handleLoadRoleUsers(e){if(!e)return;const t=this,a=getAllUsers(),r=getRoleUsers(e);Promise.all([a,r]).then((function(e){let a=e[0],r=e[1];if(0===a.code&&(a.data.map(e=>{e.key=e.userId,e.label=`${e.userName}(${e.nickName})`}),t.selectUsers=a.data),0===r.code){let e=[];r.data.map(t=>{e.includes(t.userId)||e.push(t.userId)}),t.formItem.userIds=e}t.modalVisible=!0}))},transferRender(e){return`<span  title="${e.label}">${e.label}</span>`},handleTransferChange(e,t,a){this.formItem.userIds=e},handleClick(e,t){switch(e){case"remove":this.handleRemove(t);break}}},mounted:function(){}},l=i,n=a("4e82"),m=Object(n["a"])(l,r,s,!1,null,null,null);t["default"]=m.exports},"765b":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Card",{attrs:{shadow:""}},[a("Form",{ref:"searchForm",attrs:{model:e.pageInfo,inline:"","label-width":80}},[a("FormItem",{attrs:{label:"请求路径",prop:"path"}},[a("Input",{attrs:{type:"text",placeholder:"请输入关键字"},model:{value:e.pageInfo.path,callback:function(t){e.$set(e.pageInfo,"path",t)},expression:"pageInfo.path"}})],1),a("FormItem",{attrs:{label:"IP",prop:"ip"}},[a("Input",{attrs:{type:"text",placeholder:"请输入关键字"},model:{value:e.pageInfo.ip,callback:function(t){e.$set(e.pageInfo,"ip",t)},expression:"pageInfo.ip"}})],1),a("FormItem",{attrs:{label:"服务名",prop:"serviceId"}},[a("Input",{attrs:{type:"text",placeholder:"请输入关键字"},model:{value:e.pageInfo.serviceId,callback:function(t){e.$set(e.pageInfo,"serviceId",t)},expression:"pageInfo.serviceId"}})],1),a("FormItem",[a("Button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSearch(1)}}},[e._v("查询")]),e._v(" \n        "),a("Button",{on:{click:function(t){return e.handleResetForm("searchForm")}}},[e._v("重置")])],1)],1),a("Table",{attrs:{border:"",columns:e.columns,data:e.data,loading:e.loading},scopedSlots:e._u([{key:"httpStatus",fn:function(t){var r=t.row;return["200"===r.httpStatus?a("Badge",{attrs:{status:"success"}}):a("Badge",{attrs:{status:"error"}}),a("span",[e._v(e._s(r.httpStatus))])]}},{key:"detail",fn:function(t){var r=t.row;return[a("a",{on:{click:function(t){return e.openDrawer(r)}}},[e._v("详情")])]}}])}),a("Page",{attrs:{transfer:"",total:e.pageInfo.total,current:e.pageInfo.page,"page-size":e.pageInfo.limit,"show-elevator":"","show-sizer":"","show-total":""},on:{"on-change":e.handlePage,"on-page-size-change":e.handlePageSize}})],1),a("Drawer",{attrs:{width:"30"},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[a("div",{attrs:{slot:"header"},slot:"header"},["200"===e.currentRow.httpStatus?a("Badge",{attrs:{status:"success"}}):a("Badge",{attrs:{status:"error"}}),e._v("\n      "+e._s(e.currentRow.httpStatus)+"\n      "+e._s(e.currentRow.path)+" - "+e._s(e.currentRow.serviceId)+"\n\n    ")],1),a("div",[a("h3",[e._v("请求头")]),a("pre",[e._v("           "+e._s(e.currentRow.headers?JSON.stringify(JSON.parse(e.currentRow.headers),null,4):"")+"\n      ")]),a("h3",[e._v("请求参数")]),a("pre",[e._v("            "+e._s(e.currentRow.params?JSON.stringify(JSON.parse(e.currentRow.params),null,4):"")+"\n      ")]),a("h3",[e._v("错误信息")]),a("pre",[e._v("        "+e._s(e.currentRow.error)+"\n      ")]),a("h3",[e._v("认证信息")]),a("pre",[e._v("            "+e._s(e.currentRow.authentication?JSON.stringify(JSON.parse(e.currentRow.authentication),null,4):"")+"\n      ")])])])],1)},s=[],o=a("c276"),i={name:"GatewayAccessLog",data(){return{drawer:!1,currentRow:{},loading:!1,pageInfo:{total:0,page:1,limit:10,path:"",ip:"",serviceId:""},columns:[{type:"selection",width:60,align:"center"},{title:"请求地址",key:"path",width:220},{title:"请求方式",key:"method",width:100,filters:[{label:"POST",value:0},{label:"GET",value:1},{label:"DELETE",value:2},{label:"OPTIONS",value:3},{label:"PATCH",value:4}],filterMultiple:!1,filterMethod(e,t){return 0===e?"POST"===t.method:1===e?"GET"===t.method:2===e?"DELETE"===t.method:3===e?"OPTIONS"===t.method:4===e?"PATCH"===t.method:void 0}},{title:"IP",key:"ip",width:150},{title:"区域",key:"region",width:200},{title:"终端",width:100,render:(e,t)=>{return e("div",Object(o["m"])(t.row.userAgent).terminal)}},{title:"浏览器",width:100,render:(e,t)=>{return e("div",Object(o["m"])(t.row.userAgent).browser)}},{title:"服务名",key:"serviceId",width:200},{title:"响应状态",key:"httpStatus",slot:"httpStatus",width:100},{title:"耗时",key:"useTime",render:(e,t)=>{return e("div",(t.row.useTime?t.row.useTime:0)+" ms")},width:100},{title:"请求时间",key:"requestTime",width:200},{title:"详情",slot:"detail",fixed:"right",width:120}],data:[]}},methods:{openDrawer(e){this.currentRow=e,this.drawer=!0},handleSearch(e){e&&(this.pageInfo.page=e),this.loading=!0,getAccessLogs(this.pageInfo).then(e=>{this.data=e.data.records,this.pageInfo.total=parseInt(e.data.total)}).finally(()=>{this.loading=!1})},handleResetForm(e){this.$refs[e].resetFields()},handlePage(e){this.pageInfo.page=e,this.handleSearch()},handlePageSize(e){this.pageInfo.limit=e,this.handleSearch()}},mounted:function(){this.handleSearch()}},l=i,n=a("4e82"),m=Object(n["a"])(l,r,s,!1,null,null,null);t["default"]=m.exports},"7cf8":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Card",[a("Form",{ref:"searchForm",attrs:{model:e.pageInfo,inline:"","label-width":80}},[a("FormItem",{attrs:{label:"登录名",prop:"userName"}},[a("Input",{attrs:{type:"text",placeholder:"请输入关键字"},model:{value:e.pageInfo.userName,callback:function(t){e.$set(e.pageInfo,"userName",t)},expression:"pageInfo.userName"}})],1),a("FormItem",{attrs:{label:"手机号",prop:"mobile"}},[a("Input",{attrs:{type:"text",placeholder:"请输入关键字"},model:{value:e.pageInfo.mobile,callback:function(t){e.$set(e.pageInfo,"mobile",t)},expression:"pageInfo.mobile"}})],1),a("FormItem",{attrs:{label:"邮箱",prop:"email"}},[a("Input",{attrs:{type:"text",placeholder:"请输入关键字"},model:{value:e.pageInfo.email,callback:function(t){e.$set(e.pageInfo,"email",t)},expression:"pageInfo.email"}})],1),a("FormItem",[a("Button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSearch(1)}}},[e._v("查询")]),e._v(" \n        "),a("Button",{on:{click:function(t){return e.handleResetForm("searchForm")}}},[e._v("重置")])],1)],1),a("div",{staticClass:"search-con search-con-top"},[a("ButtonGroup",[a("Button",{attrs:{disabled:!e.hasAuthority("developerEdit"),type:"primary"},on:{click:function(t){return e.handleModal()}}},[a("span",[e._v("添加")])])],1)],1),a("Table",{attrs:{border:"",columns:e.columns,data:e.data,loading:e.loading},scopedSlots:e._u([{key:"status",fn:function(e){var t=e.row;return[1===t.status?a("Badge",{attrs:{status:"success",text:"正常"}}):2===t.status?a("Badge",{attrs:{status:"warning",text:"锁定"}}):a("Badge",{attrs:{status:"error",text:"禁用"}})]}},{key:"action",fn:function(t){var r=t.row;return[a("a",{attrs:{disabled:!e.hasAuthority("developerEdit")},on:{click:function(t){return e.handleModal(r)}}},[e._v("编辑")]),e._v(" \n        "),a("Dropdown",{directives:[{name:"show",rawName:"v-show",value:e.hasAuthority("developerEdit"),expression:"hasAuthority('developerEdit')"}],ref:"dropdown",attrs:{transfer:""},on:{"on-click":function(t){return e.handleClick(t,r)}}},[a("a",{attrs:{href:"javascript:void(0)"}},[a("span",[e._v("更多")]),a("Icon",{attrs:{type:"ios-arrow-down"}})],1),a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[a("DropdownItem",{attrs:{name:"sendToEmail"}},[e._v("发送到密保邮箱")])],1)],1),e._v(" \n      ")]}}])}),a("Page",{attrs:{transfer:"",total:e.pageInfo.total,current:e.pageInfo.page,"page-size":e.pageInfo.limit,"show-elevator":"","show-sizer":"","show-total":""},on:{"on-change":e.handlePage,"on-page-size-change":e.handlePageSize}})],1),a("Modal",{attrs:{title:e.modalTitle,width:"40"},on:{"on-cancel":e.handleReset},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[a("div",[a("Tabs",{attrs:{value:e.current},on:{"on-click":e.handleTabClick}},[a("TabPane",{attrs:{label:"开发者信息",name:"form1"}},[a("Form",{directives:[{name:"show",rawName:"v-show",value:"form1"==e.current,expression:"current == 'form1'"}],ref:"form1",attrs:{model:e.formItem,rules:e.formItemRules,"label-width":100}},[a("FormItem",{attrs:{label:"开发者类型",prop:"userType"}},[a("RadioGroup",{model:{value:e.formItem.userType,callback:function(t){e.$set(e.formItem,"userType",t)},expression:"formItem.userType"}},[a("Radio",{attrs:{label:"isp"}},[e._v("服务提供商")]),a("Radio",{attrs:{label:"normal"}},[e._v("自研开发者")])],1)],1),a("FormItem",{attrs:{label:"昵称",prop:"nickName"}},[a("Input",{attrs:{placeholder:"请输入内容"},model:{value:e.formItem.nickName,callback:function(t){e.$set(e.formItem,"nickName",t)},expression:"formItem.nickName"}})],1),a("FormItem",{attrs:{label:"登录名",prop:"userName"}},[a("Input",{attrs:{disabled:!!e.formItem.userId,placeholder:"请输入内容"},model:{value:e.formItem.userName,callback:function(t){e.$set(e.formItem,"userName",t)},expression:"formItem.userName"}})],1),e.formItem.userId?e._e():a("FormItem",{attrs:{label:"登录密码",prop:"password"}},[a("Input",{attrs:{type:"password",placeholder:"请输入内容"},model:{value:e.formItem.password,callback:function(t){e.$set(e.formItem,"password",t)},expression:"formItem.password"}})],1),e.formItem.userId?e._e():a("FormItem",{attrs:{label:"再次确认密码",prop:"passwordConfirm"}},[a("Input",{attrs:{type:"password",placeholder:"请输入内容"},model:{value:e.formItem.passwordConfirm,callback:function(t){e.$set(e.formItem,"passwordConfirm",t)},expression:"formItem.passwordConfirm"}})],1),a("FormItem",{attrs:{label:"邮箱",prop:"email"}},[a("Input",{attrs:{placeholder:"请输入内容"},model:{value:e.formItem.email,callback:function(t){e.$set(e.formItem,"email",t)},expression:"formItem.email"}})],1),a("FormItem",{attrs:{label:"手机号",prop:"mobile"}},[a("Input",{attrs:{placeholder:"请输入内容"},model:{value:e.formItem.mobile,callback:function(t){e.$set(e.formItem,"mobile",t)},expression:"formItem.mobile"}})],1),a("FormItem",{attrs:{label:"状态"}},[a("RadioGroup",{attrs:{type:"button"},model:{value:e.formItem.status,callback:function(t){e.$set(e.formItem,"status",t)},expression:"formItem.status"}},[a("Radio",{attrs:{label:"0"}},[e._v("禁用")]),a("Radio",{attrs:{label:"1"}},[e._v("正常")]),a("Radio",{attrs:{label:"2"}},[e._v("锁定")])],1)],1),a("FormItem",{attrs:{label:"描述"}},[a("Input",{attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:e.formItem.userDesc,callback:function(t){e.$set(e.formItem,"userDesc",t)},expression:"formItem.userDesc"}})],1)],1)],1),a("TabPane",{attrs:{disabled:!e.formItem.userId,label:"修改密码",name:"form2"}},[a("Form",{directives:[{name:"show",rawName:"v-show",value:"form2"==e.current,expression:"current == 'form2'"}],ref:"form2",attrs:{model:e.formItem,rules:e.formItemRules,"label-width":100}},[a("FormItem",{attrs:{label:"登录名",prop:"userName"}},[a("Input",{attrs:{disabled:!!e.formItem.userId,placeholder:"请输入内容"},model:{value:e.formItem.userName,callback:function(t){e.$set(e.formItem,"userName",t)},expression:"formItem.userName"}})],1),a("FormItem",{attrs:{label:"登录密码",prop:"password"}},[a("Input",{attrs:{type:"password",placeholder:"请输入内容"},model:{value:e.formItem.password,callback:function(t){e.$set(e.formItem,"password",t)},expression:"formItem.password"}})],1),a("FormItem",{attrs:{label:"再次确认密码",prop:"passwordConfirm"}},[a("Input",{attrs:{type:"password",placeholder:"请输入内容"},model:{value:e.formItem.passwordConfirm,callback:function(t){e.$set(e.formItem,"passwordConfirm",t)},expression:"formItem.passwordConfirm"}})],1)],1)],1)],1),a("div",{staticClass:"drawer-footer"},[a("Button",{attrs:{type:"default"},on:{click:e.handleReset}},[e._v("取消")]),e._v(" \n        "),a("Button",{attrs:{type:"primary",loading:e.saving},on:{click:e.handleSubmit}},[e._v("保存")])],1)],1)])],1)},s=[],o={name:"SystemDeveloper",data(){const e=(e,t,a)=>{let r=/^[_a-zA-Z0-9]+$/,s=/^.{4,18}$/;""===t?a(new Error("登录名不能为空")):""===t||r.test(t)?""===t||s.test(t)?a():a(new Error("长度6到18个字符")):a(new Error("只允许字母、数字、下划线"))},t=(e,t,a)=>{let r=/^.{6,18}$/;""===t?a(new Error("请输入密码")):t!==this.formItem.password?a(new Error("两次输入密码不一致")):""===t||r.test(t)?a():a(new Error("长度6到18个字符"))},a=(e,t,a)=>{""===t?a(new Error("请再次输入密码")):t!==this.formItem.password?a(new Error("两次输入密码不一致")):a()},r=(e,t,a)=>{let r=/^1\d{10}$/;""===t||r.test(t)?a():a(new Error("手机号码格式不正确"))};return{loading:!1,saving:!1,modalVisible:!1,modalTitle:"",current:"form1",forms:["form1","form2"],selectMenus:[],selectRoles:[],pageInfo:{page:1,pageSize:10,sort:"createTime",order:"desc"},formItemRules:{userType:[{required:!0,message:"开发者类型不能为空",trigger:"blur"}],userName:[{required:!0,message:"开发者名不能为空",trigger:"blur"},{required:!0,validator:e,trigger:"blur"}],password:[{required:!0,validator:t,trigger:"blur"}],passwordConfirm:[{required:!0,validator:a,trigger:"blur"}],nickName:[{required:!0,message:"昵称不能为空",trigger:"blur"}],email:[{required:!1,type:"email",message:"邮箱格式不正确",trigger:"blur"}],mobile:[{validator:r,trigger:"blur"}]},formItem:{userId:"",userName:"",nickName:"",password:"",passwordConfirm:"",status:1,companyId:"",email:"",mobile:"",userType:"isp",userDesc:"",avatar:"",grantRoles:[],grantActions:[],grantMenus:[],expireTime:"",isExpired:!1},columns:[{type:"selection",width:60},{title:"登录名",key:"userName",width:200},{title:"昵称",key:"nickName",width:150},{title:"邮箱",key:"email",width:200},{title:"手机号",key:"mobile",width:200},{title:"状态",slot:"status",key:"status",width:100},{title:"开发者类型",key:"userType",width:150},{title:"注册时间",key:"createTime",width:180},{title:"描述",key:"userDesc"},{title:"操作",slot:"action",fixed:"right",width:150}],data:[]}},methods:{handleModal(e){e&&(this.formItem=Object.assign({},this.formItem,e)),this.current===this.forms[0]&&(this.modalTitle=e?"编辑开发者 - "+e.userName:"添加开发者",this.modalVisible=!0),this.current===this.forms[1]&&(this.modalTitle=e?"修改密码 - "+e.userName:"修改密码",this.modalVisible=!0),this.formItem.status=this.formItem.status+""},handleResetForm(e){this.$refs[e].resetFields()},handleReset(){const e={userId:"",userName:"",nickName:"",password:"",passwordConfirm:"",status:1,companyId:"",email:"",mobile:"",userType:"isp",userDesc:"",avatar:"",grantRoles:[],grantMenus:[],grantActions:[],expireTime:"",isExpired:!1};this.formItem=e,this.forms.map(e=>{this.handleResetForm(e)}),this.current=this.forms[0],this.formItem.grantMenus=[],this.formItem.grantActions=[],this.modalVisible=!1,this.saving=!1},handleSubmit(){this.current===this.forms[0]&&this.$refs[this.current].validate(e=>{e&&(this.saving=!0,this.formItem.userId?updateDeveloper(this.formItem).then(e=>{0===e.code&&(this.$Message.success("保存成功"),this.handleReset()),this.handleSearch()}).finally(()=>{this.saving=!1}):addDeveloper(this.formItem).then(e=>{0===e.code&&(this.$Message.success("保存成功"),this.handleReset()),this.handleSearch()}).finally(()=>{this.saving=!1}))}),this.current===this.forms[1]&&this.formItem.userId&&this.$refs[this.current].validate(e=>{e&&(this.saving=!0,updatePassword({userId:this.formItem.userId,password:this.formItem.password}).then(e=>{0===e.code&&(this.$Message.success("修改成功"),this.handleReset()),this.handleSearch()}).finally(()=>{this.saving=!1}))})},handleSearch(e){e&&(this.pageInfo.page=e),this.loading=!0,getDevelopers(this.pageInfo).then(e=>{this.data=e.data.records,this.pageInfo.total=parseInt(e.data.total)}).finally(()=>{this.loading=!1})},handlePage(e){this.pageInfo.page=e,this.handleSearch()},handlePageSize(e){this.pageInfo.limit=e,this.handleSearch()},handleClick(e,t){switch(e){case"sendToEmail":this.$Message.warning("发送至密保邮箱,开发中...");break}},handleTabClick(e){this.current=e,this.handleModal()}},mounted:function(){this.handleSearch()}},i=o,l=a("4e82"),n=Object(l["a"])(i,r,s,!1,null,null,null);t["default"]=n.exports},"7dcc":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Card",{attrs:{shadow:""}},[a("div",{staticClass:"search-con search-con-top"},[a("ButtonGroup",[a("Button",{staticClass:"search-btn",attrs:{type:"primary"},on:{click:function(t){return e.handleModal()}}},[a("span",[e._v("添加")])])],1)],1),a("Table",{attrs:{border:"",columns:e.columns,data:e.data,loading:e.loading},scopedSlots:e._u([{key:"policyType",fn:function(t){var r=t.row;return[1===r.policyType?a("Tag",{attrs:{color:"green"}},[e._v("允许-白名单")]):a("Tag",{attrs:{color:"red"}},[e._v("拒绝-黑名单")])]}},{key:"action",fn:function(t){var r=t.row;return[a("a",{on:{click:function(t){return e.handleModal(r)}}},[e._v("\n          编辑")]),e._v(" \n        "),a("a",{on:{click:function(t){return e.handleRemove(r)}}},[e._v("\n          删除\n        ")])]}}])}),a("Page",{attrs:{total:e.pageInfo.total,current:e.pageInfo.page,"page-size":e.pageInfo.limit,"show-elevator":"","show-sizer":"","show-total":""},on:{"on-change":e.handlePage,"on-page-size-change":e.handlePageSize}})],1),a("Modal",{attrs:{title:e.modalTitle,width:"40"},on:{"on-cancel":e.handleReset},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[a("div",[a("Tabs",{attrs:{value:e.current},on:{"on-click":e.handleTabClick}},[a("TabPane",{attrs:{label:"策略信息",name:"form1"}},[a("Form",{directives:[{name:"show",rawName:"v-show",value:"form1"==e.current,expression:"current=='form1'"}],ref:"form1",attrs:{model:e.formItem,rules:e.formItemRules,"label-width":100}},[a("FormItem",{attrs:{label:"策略名称",prop:"policyName"}},[a("Input",{attrs:{placeholder:"请输入内容"},model:{value:e.formItem.policyName,callback:function(t){e.$set(e.formItem,"policyName",t)},expression:"formItem.policyName"}})],1),a("FormItem",{attrs:{label:"策略类型",prop:"policyType"}},[a("Select",{model:{value:e.formItem.policyType,callback:function(t){e.$set(e.formItem,"policyType",t)},expression:"formItem.policyType"}},[a("Option",{attrs:{value:"url",label:"接口(url)"}}),a("Option",{attrs:{disabled:"",value:"origin",label:"来源(origin)"}}),a("Option",{attrs:{disabled:"",value:"user",label:"用户(user)"}})],1)],1),a("FormItem",{attrs:{label:"单位时间",prop:"intervalUnit"}},[a("Select",{model:{value:e.formItem.intervalUnit,callback:function(t){e.$set(e.formItem,"intervalUnit",t)},expression:"formItem.intervalUnit"}},[a("Option",{attrs:{value:"seconds",label:"秒(seconds)"}}),a("Option",{attrs:{value:"minutes",label:"分钟(minutes)"}}),a("Option",{attrs:{value:"hours",label:"小时(hours)"}}),a("Option",{attrs:{value:"days",label:"天(days)"}})],1)],1),a("FormItem",{attrs:{label:"限流数",prop:"limitQuota"}},[a("InputNumber",{attrs:{min:10},model:{value:e.formItem.limitQuota,callback:function(t){e.$set(e.formItem,"limitQuota",t)},expression:"formItem.limitQuota"}})],1)],1)],1),a("TabPane",{attrs:{disabled:!e.formItem.policyId,label:"绑定接口",name:"form2"}},[a("Alert",{attrs:{type:"warning","show-icon":""}},[e._v("请注意：如果API上原来已经绑定了一个策略，则会被本策略覆盖，请慎重选择！")]),a("Form",{directives:[{name:"show",rawName:"v-show",value:"form2"==e.current,expression:"current=='form2'"}],ref:"form2",attrs:{model:e.formItem,rules:e.formItemRules}},[a("FormItem",{attrs:{prop:"authorities"}},[a("Transfer",{attrs:{data:e.selectApis,"list-style":{width:"45%",height:"480px"},titles:["选择接口","已选择接口"],"render-format":e.transferRender,"target-keys":e.formItem.apiIds,filterable:""},on:{"on-change":e.handleTransferChange}})],1)],1)],1)],1),a("div",{staticClass:"drawer-footer"},[a("Button",{attrs:{type:"default"},on:{click:e.handleReset}},[e._v("取消")]),e._v(" \n        "),a("Button",{attrs:{type:"primary",loading:e.saving},on:{click:e.handleSubmit}},[e._v("保存")])],1)],1)])],1)},s=[],o={name:"GatewayRateLimit",data(){return{loading:!1,saving:!1,modalVisible:!1,modalTitle:"",pageInfo:{total:0,page:1,limit:10},current:"form1",forms:["form1","form2"],selectApis:[],formItemRules:{policyName:[{required:!0,message:"策略名称不能为空",trigger:"blur"}],policyType:[{required:!0,message:"策略类型不能为空",trigger:"blur"}]},formItem:{policyId:"",policyName:"",policyType:"url",intervalUnit:"second",limitQuota:10,apiIds:[]},columns:[{title:"策略名称",key:"policyName",width:350},{title:"策略类型",key:"policyType",width:300},{title:"单位时间",key:"intervalUnit"},{title:"限流数",key:"limitQuota"},{title:"操作",slot:"action",fixed:"right",width:150}],data:[]}},methods:{handleModal(e){e&&(this.formItem=Object.assign({},this.formItem,e)),this.current===this.forms[0]&&(this.modalTitle=e?"编辑限流策略 - "+this.formItem.policyName:"添加限流策略",this.modalVisible=!0),this.current===this.forms[1]&&(this.modalTitle=e?"绑定接口 - "+this.formItem.policyName:"绑定接口",this.handleRateLimitApi(this.formItem.policyId)),this.formItem.policyType=this.formItem.policyType+""},handleTabClick(e){this.current=e,this.handleModal()},handleReset(){const e={policyId:"",policyName:"",policyType:"url",intervalUnit:"second",limitQuota:10,apiIds:[]};this.formItem=e,this.forms.map(e=>{this.$refs[e].resetFields()}),this.current=this.forms[0],this.modalVisible=!1,this.saving=!1},handleSubmit(){this.current===this.forms[0]&&this.$refs[this.current].validate(e=>{e&&(this.saving=!0,this.formItem.policyId?updateRateLimit(this.formItem).then(e=>{this.handleReset(),this.handleSearch(),0===e.code&&this.$Message.success("保存成功")}).finally(()=>{this.saving=!1}):addRateLimit(this.formItem).then(e=>{this.handleReset(),this.handleSearch(),0===e.code&&this.$Message.success("保存成功")}).finally(()=>{this.saving=!1}))}),this.current===this.forms[1]&&this.$refs[this.current].validate(e=>{e&&(this.saving=!0,addRateLimitApis({policyId:this.formItem.policyId,apiIds:this.formItem.apiIds}).then(e=>{this.handleReset(),this.handleSearch(),0===e.code&&this.$Message.success("绑定成功")}).finally(()=>{this.saving=!1}))})},handleSearch(e){e&&(this.pageInfo.page=e),this.loading=!0,getRateLimits({page:this.pageInfo.page,limit:this.pageInfo.limit}).then(e=>{this.data=e.data.records,this.pageInfo.total=parseInt(e.data.total)}).finally(()=>{this.loading=!1})},handlePage(e){this.pageInfo.page=e,this.handleSearch()},handlePageSize(e){this.pageInfo.limit=e,this.handleSearch()},handleRemove(e){this.$Modal.confirm({title:"确定删除吗？",onOk:()=>{removeRateLimit(e.policyId).then(e=>{0===e.code&&(this.pageInfo.page=1,this.$Message.success("删除成功")),this.handleSearch()})}})},handleRateLimitApi(e){if(!e)return;const t=this,a=getAuthorityApi(""),r=getRateLimitApis(e);Promise.all([a,r]).then((function(e){let a=e[0],r=e[1];if(0===a.code&&(a.data.map(e=>{e.key=e.apiId,e.label=`${e.prefix.replace("/**","")}${e.path} - ${e.apiName}`}),t.selectApis=a.data),0===r.code){let e=[];r.data.map(t=>{e.includes(t.apiId)||e.push(t.apiId)}),t.formItem.apiIds=e}t.modalVisible=!0}))},transferRender(e){return`<span  title="${e.label}">${e.label}</span>`},handleTransferChange(e,t,a){-1!=e.indexOf("1")?this.formItem.apiIds=["1"]:this.formItem.apiIds=e},handleClick(e,t){switch(e){case"remove":this.handleRemove(t);break}}},mounted:function(){this.handleSearch()}},i=o,l=a("4e82"),n=Object(l["a"])(i,r,s,!1,null,null,null);t["default"]=n.exports},"82b9":function(e,t,a){"use strict";var r=a("e63e"),s=a.n(r);s.a},"834f":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Card",{attrs:{shadow:""}},[a("div",{staticClass:"search-con search-con-top"},[a("ButtonGroup",[a("Button",{staticClass:"search-btn",attrs:{disabled:!e.hasAuthority("jobEdit"),type:"primary"},on:{click:function(t){return e.handleModal()}}},[a("span",[e._v("添加")])])],1)],1),a("Table",{attrs:{border:"",columns:e.columns,data:e.data,loading:e.loading},scopedSlots:e._u([{key:"status",fn:function(e){var t=e.row;return["NORMAL"===t.jobStatus?a("Badge",{attrs:{status:"success",text:"正常"}}):a("Badge",{attrs:{status:"error",text:"暂停"}})]}},{key:"type",fn:function(t){var r=t.row;return[r.cronExpression?a("p",[e._v("cron表达式:"+e._s(r.cronExpression))]):a("p",[e._v("调度时间:"+e._s(r.startDate)+" ~ "+e._s(r.endDate))])]}},{key:"action",fn:function(t){var r=t.row;return[a("a",{attrs:{disabled:!e.hasAuthority("jobEdit")},on:{click:function(t){return e.handleModal(r)}}},[e._v("编辑")]),e._v(" \n        "),a("Dropdown",{directives:[{name:"show",rawName:"v-show",value:e.hasAuthority("jobEdit"),expression:"hasAuthority('jobEdit')"}],ref:"dropdown",attrs:{transfer:""},on:{"on-click":function(t){return e.handleClick(t,r)}}},[a("a",{attrs:{href:"javascript:void(0)"}},[a("span",[e._v("更多")]),a("Icon",{attrs:{type:"ios-arrow-down"}})],1),a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},["NORMAL"===r.jobStatus?a("DropdownItem",{attrs:{name:"pause"}},[e._v("暂停任务")]):e._e(),"PAUSED"===r.jobStatus?a("DropdownItem",{attrs:{name:"resume"}},[e._v("恢复任务")]):e._e(),a("DropdownItem",{attrs:{name:"remove"}},[e._v("删除任务")])],1)],1)]}}])}),a("Page",{attrs:{transfer:"",total:e.pageInfo.total,current:e.pageInfo.page,"page-size":e.pageInfo.limit,"show-elevator":"","show-sizer":"","show-total":""},on:{"on-change":e.handlePage,"on-page-size-change":e.handlePageSize}})],1),a("Modal",{attrs:{title:e.modalTitle,width:"40"},on:{"on-cancel":e.handleReset},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[a("div",[a("Form",{ref:"form1",attrs:{model:e.formItem,rules:e.formItemRules,"label-width":100}},[a("FormItem",{attrs:{label:"任务名称",prop:"jobName"}},[a("Input",{attrs:{disabled:!e.formItem.newData,placeholder:"请输入内容"},model:{value:e.formItem.jobName,callback:function(t){e.$set(e.formItem,"jobName",t)},expression:"formItem.jobName"}})],1),a("FormItem",{attrs:{label:"任务类型",prop:"jobType"}},[a("Select",{model:{value:e.formItem.jobType,callback:function(t){e.$set(e.formItem,"jobType",t)},expression:"formItem.jobType"}},[a("Option",{attrs:{value:"cron"}},[e._v("cron任务(CronTrigger)")]),a("Option",{attrs:{value:"simple"}},[e._v("简单任务(SimpleTrigger)")])],1)],1),"simple"===e.formItem.jobType?a("FormItem",{attrs:{label:"开始时间",prop:"startTime"}},[a("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"开始时间"},model:{value:e.formItem.startTime,callback:function(t){e.$set(e.formItem,"startTime",t)},expression:"formItem.startTime"}})],1):e._e(),"simple"===e.formItem.jobType?a("FormItem",{attrs:{label:"结束时间",prop:"endTime"}},[a("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"结束时间"},model:{value:e.formItem.endTime,callback:function(t){e.$set(e.formItem,"endTime",t)},expression:"formItem.endTime"}})],1):e._e(),"simple"===e.formItem.jobType?a("FormItem",{attrs:{label:"重复执行",prop:"repeatCount"}},[a("InputNumber",{attrs:{min:-1},model:{value:e.formItem.repeatCount,callback:function(t){e.$set(e.formItem,"repeatCount",t)},expression:"formItem.repeatCount"}}),e._v("   次\n            \n\n          "),a("RadioGroup",{attrs:{type:"button"},on:{"on-change":e.repeatCountTypeChange},model:{value:e.formItem.repeatCountType,callback:function(t){e.$set(e.formItem,"repeatCountType",t)},expression:"formItem.repeatCountType"}},[a("Radio",{attrs:{label:"0"}},[e._v("不重复执行")]),a("Radio",{attrs:{label:"-1"}},[e._v("不限制次数,一直重复执行(直到过期)")])],1)],1):e._e(),"simple"===e.formItem.jobType?a("FormItem",{attrs:{label:"重复执行间隔",prop:"repeatInterval"}},[a("InputNumber",{attrs:{min:1e3},model:{value:e.formItem.repeatInterval,callback:function(t){e.$set(e.formItem,"repeatInterval",t)},expression:"formItem.repeatInterval"}}),a("span",[e._v("  毫秒")])],1):e._e(),"cron"===e.formItem.jobType?a("FormItem",{attrs:{label:"cron表达式",prop:"cron"}},[a("Input",{attrs:{placeholder:"* * * * * ?"},model:{value:e.formItem.cron,callback:function(t){e.$set(e.formItem,"cron",t)},expression:"formItem.cron"}})],1):e._e(),a("FormItem",{attrs:{label:"远程调度接口",prop:"path"}},[a("Select",{attrs:{filterable:""},on:{"on-change":e.handleOnSelectChange},model:{value:e.formItem.path,callback:function(t){e.$set(e.formItem,"path",t)},expression:"formItem.path"}},e._l(e.selectApis,(function(t,r){return a("Option",{key:r,attrs:{value:t.path}},[e._v("\n              "+e._s(t.path)+" - "+e._s(t.apiName)+" - "+e._s(t.serviceId)+"\n            ")])})),1)],1),a("FormItem",{attrs:{label:"任务描述"}},[a("Input",{attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:e.formItem.jobDescription,callback:function(t){e.$set(e.formItem,"jobDescription",t)},expression:"formItem.jobDescription"}})],1),a("FormItem",{attrs:{label:"异常告警邮箱",prop:"alarmMail"}},[a("Input",{attrs:{placeholder:"请输入内容"},model:{value:e.formItem.alarmMail,callback:function(t){e.$set(e.formItem,"alarmMail",t)},expression:"formItem.alarmMail"}})],1)],1),a("div",{staticClass:"drawer-footer"},[a("Button",{attrs:{type:"default"},on:{click:e.handleReset}},[e._v("取消")]),e._v(" \n        "),a("Button",{attrs:{type:"primary",loading:e.saving},on:{click:e.handleSubmit}},[e._v("保存")])],1)],1)])],1)},s=[],o=(a("c276"),{name:"TaskJob",data(){return{loading:!1,modalVisible:!1,modalTitle:"",saving:!1,pageInfo:{total:0,page:1,limit:10},selectApis:[],formItemRules:{jobName:[{required:!0,message:"任务名称不能为空",trigger:"blur"}],jobType:[{required:!0,message:"任务类型不能为空",trigger:"blur"}],cron:[{required:!0,message:"cron表达式不能为空",trigger:"blur"}],path:[{required:!0,message:"调度接口不能为空",trigger:"blur"}],alarmMail:[{required:!1,type:"email",message:"邮箱格式不正确",trigger:"blur"}],startTime:[{required:!0,message:"开始时间不能为空"}],repeatInterval:[{required:!0,message:"间隔时间不能为空"}],repeatCount:[{required:!0,message:"重试次数不能为空"}]},formItem:{newData:!0,jobName:"",jobDescription:"",jobType:"cron",cron:"",startTime:"",endTime:"",repeatInterval:1e4,repeatCountType:"0",repeatCount:0,serviceId:"",path:"",method:"",contentType:"",alarmMail:""},columns:[{type:"selection",width:60,align:"center"},{title:"任务名称",key:"jobName",width:200},{title:"调度信息",width:350,slot:"type"},{title:"状态",key:"jobStatus",slot:"status"},{title:"任务描述",key:"jobDescription"},{title:"操作",key:"",slot:"action",fixed:"right",width:150}],data:[]}},methods:{handleModal(e){e?(this.modalTitle="编辑任务 - "+e.jobName,this.formItem=Object.assign({},this.formItem,e),this.formItem.jobType="org.quartz.impl.triggers.SimpleTriggerImpl"===this.formItem.jobTrigger?"simple":"cron",this.formItem.cron=e.cronExpression,this.formItem.startTime=e.startDate,this.formItem.endTime=e.endDate,this.formItem.repeatInterval=e.repeatInterval?parseInt(e.repeatInterval):0,this.formItem.repeatCountType=e.repeatCount+"",this.formItem.path=e.data.path,this.formItem.serviceId=e.data.serviceId,this.formItem.method=e.data.method,this.formItem.contentType=e.data.contentType,this.formItem.alarmMail=e.data.alarmMail,this.formItem.newData=!1):this.modalTitle="添加任务",this.modalVisible=!0},handleTabClick(e){this.current=e,this.handleModal()},handleReset(){const e={newData:!0,jobName:"",jobDescription:"",jobType:"cron",cron:"",startTime:"",endTime:"",repeatInterval:1e4,repeatCountType:"0",repeatCount:0,serviceId:"",path:"",method:"",contentType:"",alarmMail:""};this.formItem=e,this.$refs["form1"].resetFields(),this.modalVisible=!1,this.saving=!1},handleSubmit(){this.$refs["form1"].validate(e=>{e&&("simple"===this.formItem.jobType&&(this.formItem.startTime=this.formItem.startTime?this.formItem.startTime.pattern("yyyy-MM-dd HH:mm:ss"):"",this.formItem.endTime=this.formItem.endTime?this.formItem.endTime.pattern("yyyy-MM-dd HH:mm:ss"):""),this.saving=!0,this.formItem.newData?addHttpJob(this.formItem).then(e=>{0===e.code&&this.$Message.success("保存成功"),this.handleReset(),this.handleSearch()}).finally(()=>{this.saving=!1}):updateHttpJob(this.formItem).then(e=>{0===e.code&&this.$Message.success("保存成功"),this.handleReset(),this.handleSearch()}).finally(()=>{this.saving=!1}))})},handleRemove(e){this.$Modal.confirm({title:"确定删除吗？",onOk:()=>{removeJob(e.jobName).then(e=>{this.handleSearch(),0===e.code&&(this.pageInfo.page=1,this.$Message.success("删除成功"))})}})},handlePause(e){this.$Modal.confirm({title:"确定暂停任务吗？",onOk:()=>{pauseJob(e.jobName).then(e=>{this.handleSearch(),0===e.code&&(this.pageInfo.page=1,this.$Message.success("暂停成功"))})}})},handleResume(e){this.$Modal.confirm({title:"确定恢复任务吗？",onOk:()=>{resumeJob(e.jobName).then(e=>{this.handleSearch(),0===e.code&&(this.pageInfo.page=1,this.$Message.success("恢复成功"))})}})},handleSearch(e){e&&(this.pageInfo.page=e),this.loading=!0,getJobs(this.pageInfo).then(e=>{this.data=e.data.records,this.pageInfo.total=parseInt(e.data.total)}).finally(()=>{this.loading=!1})},handleLoadApiList(){this.loading=!0},handlePage(e){this.pageInfo.page=e,this.handleSearch()},handlePageSize(e){this.pageInfo.limit=e,this.handleSearch()},handleOnSelectChange(e){let t={};this.selectApis.some(a=>{if(a.path===e)return t=a,!0}),this.formItem.serviceId=t.serviceId,this.formItem.path=t.path,this.formItem.contentType=t.contentType,this.formItem.method=t.requestMethod},handleClick(e,t){switch(e){case"pause":this.handlePause(t);break;case"resume":this.handleResume(t);break;case"remove":this.handleRemove(t);break}},repeatCountTypeChange(e){this.formItem.repeatCount=parseInt(e)}},mounted:function(){this.handleSearch(),this.handleLoadApiList()}}),i=o,l=a("4e82"),n=Object(l["a"])(i,r,s,!1,null,null,null);t["default"]=n.exports},"9bbb":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Card",{attrs:{shadow:""}},[a("Form",{ref:"searchForm",attrs:{model:e.pageInfo,inline:"","label-width":80}},[a("FormItem",{attrs:{label:"任务名称",prop:"jobName"}},[a("Input",{attrs:{type:"text",placeholder:"请输入关键字"},model:{value:e.pageInfo.jobName,callback:function(t){e.$set(e.pageInfo,"jobName",t)},expression:"pageInfo.jobName"}})],1),a("FormItem",[a("Button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSearch(1)}}},[e._v("查询")]),e._v(" \n        "),a("Button",{on:{click:function(t){return e.handleResetForm("searchForm")}}},[e._v("重置")])],1)],1),a("Table",{attrs:{border:"",columns:e.columns,data:e.data,loading:e.loading},scopedSlots:e._u([{key:"status",fn:function(e){var t=e.row;return[1===t.status?a("Badge",{attrs:{status:"success",text:"成功"}}):a("Badge",{attrs:{status:"error",text:"失败"}})]}},{key:"type",fn:function(t){var r=t.row;return[r.cronExpression?a("p",[e._v("cron表达式:"+e._s(r.cronExpression))]):a("p",[e._v("调度时间:"+e._s(r.startDate)+" ~ "+e._s(r.endDate))])]}},{key:"detail",fn:function(t){var r=t.row;return[a("a",{on:{click:function(t){return e.openDrawer(r)}}},[e._v("详情")])]}}])}),a("Page",{attrs:{transfer:"",total:e.pageInfo.total,current:e.pageInfo.page,"page-size":e.pageInfo.limit,"show-elevator":"","show-sizer":"","show-total":""},on:{"on-change":e.handlePage,"on-page-size-change":e.handlePageSize}})],1),a("Drawer",{attrs:{width:"50",closable:!1},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[a("div",{attrs:{slot:"header"},slot:"header"},[1===e.currentRow.status?a("Badge",{attrs:{status:"success"}}):a("Badge",{attrs:{status:"error"}}),e._v("\n      "+e._s(e.currentRow.jobName)+"\n\n    ")],1),a("div",[a("p",[a("strong",[e._v("执行类：")]),e._v(e._s(e.currentRow.jobClass))]),a("p",[a("strong",[e._v("触发器：")]),e._v(e._s(e.currentRow.triggerClass))]),a("p",[a("strong",[e._v("运行时长：")]),e._v(e._s(e.currentRow.runTime)+" ms  ")]),e.currentRow.cronExpression?a("p",[a("strong",[e._v("cron表达式：")]),e._v(e._s(e.currentRow.cronExpression))]):a("p",[a("strong",[e._v("调度时间：")]),e._v(": "+e._s(e.currentRow.startDate)+" ~ "+e._s(e.currentRow.endDate))]),a("strong",[e._v("执行参数")]),a("pre",[e._v("            "+e._s(e.currentRow.jobData?JSON.stringify(JSON.parse(e.currentRow.jobData),null,4):"")+"\n      ")]),a("strong",[e._v("错误信息")]),a("pre",[e._v("        "+e._s(e.currentRow.exception)+"\n      ")])])])],1)},s=[],o={name:"TaskJobLogs",data(){return{drawer:!1,currentRow:{},loading:!1,pageInfo:{total:0,page:1,limit:10,jobName:""},columns:[{title:"任务名称",key:"jobName",width:150},{title:"调度信息",width:350,slot:"type"},{title:"执行结果",key:"status",slot:"status"},{title:"耗时",key:"runTime",render:(e,t)=>{return e("div",(t.row.runTime?t.row.runTime:0)+" ms")}},{title:"创建时间",key:"createTime"},{title:"详情",slot:"detail",fixed:"right",width:150}],data:[]}},methods:{openDrawer(e){this.currentRow=e,this.drawer=!0},handleSearch(e){e&&(this.pageInfo.page=e),this.loading=!0,getJobLogs(this.pageInfo).then(e=>{this.data=e.data.records,this.pageInfo.total=parseInt(e.data.total)}).finally(()=>{this.loading=!1})},handleResetForm(e){this.$refs[e].resetFields()},handlePage(e){this.pageInfo.page=e,this.handleSearch()},handlePageSize(e){this.pageInfo.limit=e,this.handleSearch()}},mounted:function(){this.handleSearch()}},i=o,l=a("4e82"),n=Object(l["a"])(i,r,s,!1,null,null,null);t["default"]=n.exports},bd08:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{background:"#fff",padding:"10px",width:"1000px"}},[a("Form",{ref:"formValidate",attrs:{model:e.formValidate,rules:e.ruleValidate,"label-width":80}},[a("FormItem",{attrs:{label:"标题",prop:"title"}},[a("Input",{attrs:{placeholder:"请输入模板标题"},model:{value:e.formValidate.title,callback:function(t){e.$set(e.formValidate,"title",t)},expression:"formValidate.title"}})],1),a("FormItem",{attrs:{label:"创建者",prop:"username"}},[a("Input",{attrs:{placeholder:"请输入创建人姓名"},model:{value:e.formValidate.mail,callback:function(t){e.$set(e.formValidate,"mail",t)},expression:"formValidate.mail"}})],1),a("FormItem",{attrs:{label:"模板类别",prop:"type"}},[a("Select",{attrs:{placeholder:"请选择模板类别"},model:{value:e.formValidate.type,callback:function(t){e.$set(e.formValidate,"type",t)},expression:"formValidate.type"}},[a("Option",{attrs:{value:"beijing"}},[e._v("电商")]),a("Option",{attrs:{value:"shanghai"}},[e._v("广告")]),a("Option",{attrs:{value:"shenzhen"}},[e._v("小说")]),a("Option",{attrs:{value:"shenzhen"}},[e._v("知识付费")]),a("Option",{attrs:{value:"shenzhen"}},[e._v("其他")])],1)],1),a("FormItem",{attrs:{label:"创建日期",prop:"date"}},[a("DatePicker",{attrs:{type:"date",placeholder:"请选择日期"}})],1),a("FormItem",{attrs:{label:"模板封面",prop:"cover"}},[a("Upload",{ref:"upload",staticStyle:{display:"inline-block",width:"150px"},attrs:{"show-upload-list":!1,format:["jpg","jpeg","png"],"max-size":2048,"before-upload":e.handleBeforeUpload,multiple:"",type:"drag",action:"//jsonplaceholder.typicode.com/posts/"}},[a("div",{staticStyle:{width:"150px",height:"150px","line-height":"150px"}},[a("Icon",{attrs:{type:"ios-camera",size:"20"}})],1)])],1),a("FormItem",{attrs:{label:"模板介绍",prop:"desc"}},[a("div",{staticStyle:{height:"450px",border:"1px solid #000"}},[a("quill-editor",{ref:"myQuillEditor",staticStyle:{height:"400px"},attrs:{options:e.editorOption,"on-success":e.handleSuccessQuill},on:{blur:function(t){return e.onEditorBlur(t)},focus:function(t){return e.onEditorFocus(t)},change:function(t){return e.onEditorChange(t)}},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})],1)]),a("FormItem",[a("Button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSubmit("formValidate")}}},[e._v("提交")]),a("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(t){return e.handleReset("formValidate")}}},[e._v("重置")])],1)],1)],1)},s=[];const o=[["bold","italic","underline"],[{size:["small",!1,"large","huge"]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["image"]];var i={data(){return{formValidate:{title:"",username:"",type:"",date:"",cover:[],desc:""},ruleValidate:{title:[{required:!0,message:"请输入标题",trigger:"change"}],username:[{required:!0,message:"请输入创建者姓名",trigger:"blur"}],type:[{required:!0,message:"请选择类别",trigger:"change"}],date:[{required:!0,type:"date",message:"请选择日期",trigger:"change"}],cover:[{required:!0,type:"string",message:"请上传模板封面",trigger:"change"}],desc:[{required:!0,message:"请输入模板介绍",trigger:"blur"}]},content:"",editorOption:{modules:{toolbar:{container:o,handlers:{image:function(e){e?document.querySelector("#iviewUp input").click():this.quill.format("image",!1)}}}},imageResize:{},placeholder:"请输入文章内容"}}},methods:{handleSubmit(e){this.$refs[e].validate(e=>{e?this.$Message.success("Success!"):this.$Message.error("Fail!")})},handleReset(e){this.$refs[e].resetFields()},handleBeforeUpload(){},onEditorBlur(){},onEditorFocus(){},onEditorChange(){},onEditorChange(e){let t=this;t.content=e.html,t.contentTxt=e.text.substr(0,100)},handleSuccessQuill(e){console.log(e);let t=this.$refs.myQuillEditor.quill;if(e){let a=t.getSelection().index;t.insertEmbed(a,"image",e.data.path),t.setSelection(a+1)}else Message.error("图片插入失败")}}},l=i,n=a("4e82"),m=Object(n["a"])(l,r,s,!1,null,null,null);t["default"]=m.exports},dad3:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Card",[a("Form",{ref:"searchForm",attrs:{model:e.pageInfo,inline:"","label-width":80}},[a("FormItem",{attrs:{label:"登录名",prop:"userName"}},[a("Input",{attrs:{type:"text",placeholder:"请输入关键字"},model:{value:e.pageInfo.userName,callback:function(t){e.$set(e.pageInfo,"userName",t)},expression:"pageInfo.userName"}})],1),a("FormItem",{attrs:{label:"手机号",prop:"mobile"}},[a("Input",{attrs:{type:"text",placeholder:"请输入关键字"},model:{value:e.pageInfo.mobile,callback:function(t){e.$set(e.pageInfo,"mobile",t)},expression:"pageInfo.mobile"}})],1),a("FormItem",{attrs:{label:"邮箱",prop:"email"}},[a("Input",{attrs:{type:"text",placeholder:"请输入关键字"},model:{value:e.pageInfo.email,callback:function(t){e.$set(e.pageInfo,"email",t)},expression:"pageInfo.email"}})],1),a("FormItem",[a("Button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSearch(1)}}},[e._v("查询")]),e._v(" \n        "),a("Button",{on:{click:function(t){return e.handleResetForm("searchForm")}}},[e._v("重置")])],1)],1),a("div",{staticClass:"search-con search-con-top"},[a("ButtonGroup",[a("Button",{attrs:{type:"primary"},on:{click:function(t){return e.handleModal()}}},[a("span",[e._v("添加")])])],1)],1),a("Table",{attrs:{border:"",columns:e.columns,data:e.data,loading:e.loading},scopedSlots:e._u([{key:"status",fn:function(e){var t=e.row;return[1===t.status?a("Badge",{attrs:{status:"success",text:"正常"}}):2===t.status?a("Badge",{attrs:{status:"warning",text:"锁定"}}):a("Badge",{attrs:{status:"error",text:"禁用"}})]}},{key:"action",fn:function(t){var r=t.row;return[a("a",{attrs:{disabled:!e.hasAuthority("systemUserEdit")},on:{click:function(t){return e.handleModal(r)}}},[e._v("编辑")]),e._v(" \n        "),a("Dropdown",{directives:[{name:"show",rawName:"v-show",value:e.hasAuthority("systemUserEdit"),expression:"hasAuthority('systemUserEdit')"}],ref:"dropdown",attrs:{transfer:""},on:{"on-click":function(t){return e.handleClick(t,r)}}},[a("a",{attrs:{href:"javascript:void(0)"}},[a("span",[e._v("更多")]),a("Icon",{attrs:{type:"ios-arrow-down"}})],1),a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[a("DropdownItem",{attrs:{name:"sendToEmail"}},[e._v("发送到密保邮箱")])],1)],1),e._v(" \n      ")]}}])}),a("Page",{attrs:{transfer:"",total:e.pageInfo.total,current:e.pageInfo.page,"page-size":e.pageInfo.limit,"show-elevator":"","show-sizer":"","show-total":""},on:{"on-change":e.handlePage,"on-page-size-change":e.handlePageSize}})],1),a("Modal",{attrs:{title:e.modalTitle,width:"40"},on:{"on-cancel":e.handleReset},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[a("div",[a("Tabs",{attrs:{value:e.current},on:{"on-click":e.handleTabClick}},[a("TabPane",{attrs:{label:"用户信息",name:"form1"}},[a("Form",{directives:[{name:"show",rawName:"v-show",value:"form1"==e.current,expression:"current == 'form1'"}],ref:"form1",attrs:{model:e.formItem,rules:e.formItemRules,"label-width":100}},[a("FormItem",{attrs:{label:"用户类型",prop:"userType"}},[a("RadioGroup",{model:{value:e.formItem.userType,callback:function(t){e.$set(e.formItem,"userType",t)},expression:"formItem.userType"}},[a("Radio",{attrs:{label:"super"}},[e._v("超级管理员")]),a("Radio",{attrs:{label:"normal"}},[e._v("普通管理员")])],1)],1),a("FormItem",{attrs:{label:"昵称",prop:"nickName"}},[a("Input",{attrs:{placeholder:"请输入内容"},model:{value:e.formItem.nickName,callback:function(t){e.$set(e.formItem,"nickName",t)},expression:"formItem.nickName"}})],1),a("FormItem",{attrs:{label:"登录名",prop:"userName"}},[a("Input",{attrs:{disabled:!!e.formItem.userId,placeholder:"请输入内容"},model:{value:e.formItem.userName,callback:function(t){e.$set(e.formItem,"userName",t)},expression:"formItem.userName"}})],1),e.formItem.userId?e._e():a("FormItem",{attrs:{label:"登录密码",prop:"password"}},[a("Input",{attrs:{type:"password",placeholder:"请输入内容"},model:{value:e.formItem.password,callback:function(t){e.$set(e.formItem,"password",t)},expression:"formItem.password"}})],1),e.formItem.userId?e._e():a("FormItem",{attrs:{label:"再次确认密码",prop:"passwordConfirm"}},[a("Input",{attrs:{type:"password",placeholder:"请输入内容"},model:{value:e.formItem.passwordConfirm,callback:function(t){e.$set(e.formItem,"passwordConfirm",t)},expression:"formItem.passwordConfirm"}})],1),a("FormItem",{attrs:{label:"邮箱",prop:"email"}},[a("Input",{attrs:{placeholder:"请输入内容"},model:{value:e.formItem.email,callback:function(t){e.$set(e.formItem,"email",t)},expression:"formItem.email"}})],1),a("FormItem",{attrs:{label:"手机号",prop:"mobile"}},[a("Input",{attrs:{placeholder:"请输入内容"},model:{value:e.formItem.mobile,callback:function(t){e.$set(e.formItem,"mobile",t)},expression:"formItem.mobile"}})],1),a("FormItem",{attrs:{label:"状态"}},[a("RadioGroup",{attrs:{type:"button"},model:{value:e.formItem.status,callback:function(t){e.$set(e.formItem,"status",t)},expression:"formItem.status"}},[a("Radio",{attrs:{label:"0"}},[e._v("禁用")]),a("Radio",{attrs:{label:"1"}},[e._v("正常")]),a("Radio",{attrs:{label:"2"}},[e._v("锁定")])],1)],1),a("FormItem",{attrs:{label:"描述"}},[a("Input",{attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:e.formItem.userDesc,callback:function(t){e.$set(e.formItem,"userDesc",t)},expression:"formItem.userDesc"}})],1)],1)],1),a("TabPane",{attrs:{label:"分配角色",name:"form2"}},[a("Form",{directives:[{name:"show",rawName:"v-show",value:"form2"==e.current,expression:"current == 'form2'"}],ref:"form2",attrs:{model:e.formItem,"label-width":100,rules:e.formItemRules}},[a("FormItem",{attrs:{label:"分配角色",prop:"grantRoles"}},[a("CheckboxGroup",{model:{value:e.formItem.grantRoles,callback:function(t){e.$set(e.formItem,"grantRoles",t)},expression:"formItem.grantRoles"}},e._l(e.selectRoles,(function(t,r){return a("Checkbox",{key:r,attrs:{label:t.roleId}},[a("span",[e._v(e._s(t.roleName))])])})),1)],1)],1)],1),a("TabPane",{attrs:{label:"分配权限",name:"form3"}},[a("Alert",{attrs:{type:"info","show-icon":""}},[e._v("\n            支持用户单独分配功能权限"),a("code",[e._v("(除角色已经分配菜单功能,禁止勾选!)")])]),a("Form",{directives:[{name:"show",rawName:"v-show",value:"form3"==e.current,expression:"current == 'form3'"}],ref:"form3",attrs:{model:e.formItem,rules:e.formItemRules,"label-width":100}},[a("FormItem",{attrs:{label:"过期时间",prop:"expireTime"}},[e.formItem.isExpired?a("Badge",{attrs:{text:"授权已过期"}},[a("DatePicker",{staticClass:"ivu-form-item-error",attrs:{type:"datetime",placeholder:"设置有效期"},model:{value:e.formItem.expireTime,callback:function(t){e.$set(e.formItem,"expireTime",t)},expression:"formItem.expireTime"}})],1):a("DatePicker",{attrs:{type:"datetime",placeholder:"设置有效期"},model:{value:e.formItem.expireTime,callback:function(t){e.$set(e.formItem,"expireTime",t)},expression:"formItem.expireTime"}})],1),a("FormItem",{attrs:{label:"功能菜单",prop:"grantMenus"}},[a("tree-table",{ref:"tree",staticStyle:{"max-height":"450px",overflow:"auto"},attrs:{"expand-key":"menuName","expand-type":!1,"is-fold":!1,"tree-type":!0,selectable:!0,columns:e.columns2,data:e.selectMenus},scopedSlots:e._u([{key:"operation",fn:function(t){return[a("CheckboxGroup",{model:{value:e.formItem.grantActions,callback:function(t){e.$set(e.formItem,"grantActions",t)},expression:"formItem.grantActions"}},e._l(t.row.actionList,(function(t,r){return a("Checkbox",{key:r,attrs:{disabled:t.disabled,label:t.authorityId}},[a("span",{attrs:{title:t.actionDesc}},[e._v(e._s(t.actionName))])])})),1)]}}])})],1)],1)],1),a("TabPane",{attrs:{label:"修改密码",name:"form4"}},[a("Form",{directives:[{name:"show",rawName:"v-show",value:"form4"==e.current,expression:"current == 'form4'"}],ref:"form4",attrs:{model:e.formItem,rules:e.formItemRules,"label-width":100}},[a("FormItem",{attrs:{label:"登录名",prop:"userName"}},[a("Input",{attrs:{disabled:!!e.formItem.userId,placeholder:"请输入内容"},model:{value:e.formItem.userName,callback:function(t){e.$set(e.formItem,"userName",t)},expression:"formItem.userName"}})],1),a("FormItem",{attrs:{label:"登录密码",prop:"password"}},[a("Input",{attrs:{type:"password",placeholder:"请输入内容"},model:{value:e.formItem.password,callback:function(t){e.$set(e.formItem,"password",t)},expression:"formItem.password"}})],1),a("FormItem",{attrs:{label:"再次确认密码",prop:"passwordConfirm"}},[a("Input",{attrs:{type:"password",placeholder:"请输入内容"},model:{value:e.formItem.passwordConfirm,callback:function(t){e.$set(e.formItem,"passwordConfirm",t)},expression:"formItem.passwordConfirm"}})],1)],1)],1)],1),a("div",{staticClass:"drawer-footer"},[a("Button",{attrs:{type:"default"},on:{click:e.handleReset}},[e._v("取消")]),e._v(" \n        "),a("Button",{attrs:{type:"primary",loading:e.saving},on:{click:e.handleSubmit}},[e._v("保存")])],1)],1)])],1)},s=[],o=a("c276"),i=a("6b6c");const l=e=>i["a"].get("user",e);var n={name:"SystemUser",data(){const e=(e,t,a)=>{let r=/^[_a-zA-Z0-9]+$/,s=/^.{4,18}$/;""===t?a(new Error("登录名不能为空")):""===t||r.test(t)?""===t||s.test(t)?a():a(new Error("长度6到18个字符")):a(new Error("只允许字母、数字、下划线"))},t=(e,t,a)=>{let r=/^.{6,18}$/;""===t?a(new Error("请输入密码")):t!==this.formItem.password?a(new Error("两次输入密码不一致")):""===t||r.test(t)?a():a(new Error("长度6到18个字符"))},a=(e,t,a)=>{""===t?a(new Error("请再次输入密码")):t!==this.formItem.password?a(new Error("两次输入密码不一致")):a()},r=(e,t,a)=>{let r=/^1\d{10}$/;""===t||r.test(t)?a():a(new Error("手机号码格式不正确"))};return{loading:!1,saving:!1,modalVisible:!1,modalTitle:"",current:"form1",forms:["form1","form2","form3","form4"],selectMenus:[],selectRoles:[],pageInfo:{page:1,pageSize:10,sort:"createTime",order:"desc"},formItemRules:{userType:[{required:!0,message:"用户类型不能为空",trigger:"blur"}],userName:[{required:!0,message:"用户名不能为空",trigger:"blur"},{required:!0,validator:e,trigger:"blur"}],password:[{required:!0,validator:t,trigger:"blur"}],passwordConfirm:[{required:!0,validator:a,trigger:"blur"}],nickName:[{required:!0,message:"昵称不能为空",trigger:"blur"}],email:[{required:!1,type:"email",message:"邮箱格式不正确",trigger:"blur"}],mobile:[{validator:r,trigger:"blur"}]},formItem:{userId:"",userName:"",nickName:"",password:"",passwordConfirm:"",status:1,companyId:"",email:"",mobile:"",userType:"normal",userDesc:"",avatar:"",grantRoles:[],grantActions:[],grantMenus:[],expireTime:"",isExpired:!1},columns:[{type:"selection",width:60},{title:"登录名",key:"userName",width:200},{title:"昵称",key:"nickName",width:150},{title:"邮箱",key:"email",width:200},{title:"手机号",key:"mobile",width:200},{title:"状态",slot:"status",key:"status",width:100},{title:"用户类型",key:"userType",width:150},{title:"注册时间",key:"createTime",width:180},{title:"描述",key:"userDesc"},{title:"操作",slot:"action",fixed:"right",width:150}],columns2:[{title:"菜单",key:"menuName",minWidth:"250px"},{title:"操作",type:"template",template:"operation",minWidth:"200px"}],data:[]}},methods:{handleModal(e){e&&(this.formItem=Object.assign({},this.formItem,e)),this.current===this.forms[0]&&(this.modalTitle=e?"编辑用户 - "+e.userName:"添加用户",this.modalVisible=!0),this.current===this.forms[1]&&(this.modalTitle=e?"分配角色 - "+e.userName:"分配角色",this.handleLoadRoles(this.formItem.userId)),this.current===this.forms[2]&&(this.modalTitle=e?"分配权限 - "+e.userName:"分配权限",this.handleLoadUserGranted(this.formItem.userId)),this.current===this.forms[3]&&(this.modalTitle=e?"修改密码 - "+e.userName:"修改密码",this.modalVisible=!0),this.formItem.status=this.formItem.status+""},handleResetForm(e){this.$refs[e].resetFields()},handleReset(){const e={userId:"",userName:"",nickName:"",password:"",passwordConfirm:"",status:1,companyId:"",email:"",mobile:"",userType:"normal",userDesc:"",avatar:"",grantRoles:[],grantMenus:[],grantActions:[],expireTime:"",isExpired:!1};this.formItem=e,this.forms.map(e=>{this.handleResetForm(e)}),this.current=this.forms[0],this.formItem.grantMenus=[],this.formItem.grantActions=[],this.modalVisible=!1,this.saving=!1},handleSubmit(){this.current===this.forms[0]&&this.$refs[this.current].validate(e=>{e&&(this.saving=!0,this.formItem.userId?updateUser(this.formItem).then(e=>{0===e.code&&(this.$Message.success("保存成功"),this.handleReset()),this.handleSearch()}).finally(()=>{this.saving=!1}):addUser(this.formItem).then(e=>{0===e.code&&(this.$Message.success("保存成功"),this.handleReset()),this.handleSearch()}).finally(()=>{this.saving=!1}))}),this.current===this.forms[1]&&this.formItem.userId&&this.$refs[this.current].validate(e=>{e&&(this.saving=!0,addUserRoles(this.formItem).then(e=>{0===e.code&&(this.$Message.success("分配角色成功"),this.handleReset()),this.handleSearch()}).finally(()=>{this.saving=!1}))}),this.current===this.forms[2]&&this.formItem.userId&&this.$refs[this.current].validate(e=>{if(e){const e=this.getCheckedAuthorities();this.saving=!0,grantAuthorityUser({userId:this.formItem.userId,expireTime:this.formItem.expireTime?this.formItem.expireTime.pattern("yyyy-MM-dd HH:mm:ss"):"",authorityIds:e}).then(e=>{0===e.code&&(this.$Message.success("授权成功"),this.handleReset()),this.handleSearch()}).finally(()=>{this.saving=!1})}}),this.current===this.forms[3]&&this.formItem.userId&&this.$refs[this.current].validate(e=>{e&&(this.saving=!0,updatePassword({userId:this.formItem.userId,password:this.formItem.password}).then(e=>{0===e.code&&(this.$Message.success("修改成功"),this.handleReset()),this.handleSearch()}).finally(()=>{this.saving=!1}))})},handleSearch(e){e&&(this.pageInfo.page=e),this.loading=!0,l(this.pageInfo).then(e=>{console.log(e)}).finally(()=>{this.loading=!1})},getCheckedAuthorities(){const e=this.$refs["tree"].getCheckedProp("authorityId");return e.concat(this.formItem.grantActions)},handleLoadUserGranted(e){const t=this,a=getAuthorityUser(e),r=[];Promise.all([p1,a]).then((function(e){let a=e[0],s=e[1];if(0===a.code&&a.data){let e={primaryKey:"menuId",parentKey:"parentId",startPid:"0"};if(0===s.code&&s.data&&s.data.length>0){let e=[],a=[];s.data.map(t=>{"role"===t.owner&&r.push(t.authorityId),-1==t.authority.indexOf("MENU_")||e.includes(t.authorityId)||e.push(t.authorityId),-1==t.authority.indexOf("ACTION_")||a.includes(t.authorityId)||a.push(t.authorityId)}),t.formItem.grantMenus=e,t.formItem.grantActions=a,s.data.length>0&&(t.formItem.expireTime=s.data[0].expireTime,t.formItem.isExpired=s.data[0].isExpired)}a.data.map(e=>{t.formItem.grantMenus.includes(e.authorityId)&&(e._isChecked=!0,r.includes(e.authorityId)&&(e.disabled=!0,e.menuName+=" (禁止勾选)")),e.actionList.map(e=>{r.includes(e.authorityId)&&(e.disabled=!0)})}),t.selectMenus=Object(o["j"])(a.data,e)}t.modalVisible=!0}))},handleLoadRoles(e){if(!e)return;const t=this,a=getAllRoles(),r=getUserRoles(e);Promise.all([a,r]).then((function(e){let a=e[0],r=e[1];if(0===a.code&&(t.selectRoles=a.data),0===r.code){let e=[];r.data.map(t=>{e.push(t.roleId)}),t.formItem.grantRoles=e}t.modalVisible=!0}))},handlePage(e){this.pageInfo.page=e,this.handleSearch()},handlePageSize(e){this.pageInfo.limit=e,this.handleSearch()},handleClick(e,t){switch(e){case"sendToEmail":this.$Message.warning("发送至密保邮箱,开发中...");break}},handleTabClick(e){this.current=e,this.handleModal()}},mounted:function(){}},m=n,d=a("4e82"),c=Object(d["a"])(m,r,s,!1,null,null,null);t["default"]=c.exports},dc58:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Card",{attrs:{shadow:""}},[a("Form",{ref:"searchForm",attrs:{model:e.pageInfo,inline:"","label-width":80}},[a("FormItem",{attrs:{label:"策略名称",prop:"policyName"}},[a("Input",{attrs:{type:"text",placeholder:"请输入关键字"},model:{value:e.pageInfo.policyName,callback:function(t){e.$set(e.pageInfo,"policyName",t)},expression:"pageInfo.policyName"}})],1),a("FormItem",[a("Button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSearch(1)}}},[e._v("查询")]),e._v(" \n        "),a("Button",{on:{click:function(t){return e.handleResetForm("searchForm")}}},[e._v("重置")])],1)],1),a("div",{staticClass:"search-con search-con-top"},[a("ButtonGroup",[a("Button",{staticClass:"search-btn",attrs:{disabled:!e.hasAuthority("gatewayIpLimitEdit"),type:"primary"},on:{click:function(t){return e.handleModal()}}},[a("span",[e._v("添加")])])],1)],1),a("Table",{attrs:{border:"",columns:e.columns,data:e.data,loading:e.loading},scopedSlots:e._u([{key:"policyType",fn:function(t){var r=t.row;return[1===r.policyType?a("Tag",{attrs:{color:"green"}},[e._v("允许-白名单")]):a("Tag",{attrs:{color:"red"}},[e._v("拒绝-黑名单")])]}},{key:"action",fn:function(t){var r=t.row;return[a("a",{attrs:{disabled:!e.hasAuthority("gatewayIpLimitEdit")},on:{click:function(t){return e.handleModal(r)}}},[e._v("\n          编辑")]),e._v(" \n        "),a("a",{attrs:{disabled:!e.hasAuthority("gatewayIpLimitEdit")},on:{click:function(t){return e.handleRemove(r)}}},[e._v("\n          删除\n        ")])]}}])}),a("Page",{attrs:{total:e.pageInfo.total,current:e.pageInfo.page,"page-size":e.pageInfo.limit,"show-elevator":"","show-sizer":"","show-total":""},on:{"on-change":e.handlePage,"on-page-size-change":e.handlePageSize}})],1),a("Modal",{attrs:{title:e.modalTitle,width:"40"},on:{"on-cancel":e.handleReset},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[a("div",[a("Tabs",{attrs:{value:e.current},on:{"on-click":e.handleTabClick}},[a("TabPane",{attrs:{label:"策略信息",name:"form1"}},[a("Form",{directives:[{name:"show",rawName:"v-show",value:"form1"==e.current,expression:"current=='form1'"}],ref:"form1",attrs:{model:e.formItem,rules:e.formItemRules,"label-width":100}},[a("FormItem",{attrs:{label:"策略名称",prop:"policyName"}},[a("Input",{attrs:{placeholder:"请输入内容"},model:{value:e.formItem.policyName,callback:function(t){e.$set(e.formItem,"policyName",t)},expression:"formItem.policyName"}})],1),a("FormItem",{attrs:{label:"策略类型",prop:"policyType"}},[a("Select",{model:{value:e.formItem.policyType,callback:function(t){e.$set(e.formItem,"policyType",t)},expression:"formItem.policyType"}},[a("Option",{attrs:{value:"0",label:"拒绝-黑名单"}}),a("Option",{attrs:{value:"1",label:"允许-白名单"}})],1)],1),a("FormItem",{attrs:{label:"IP地址/域名",prop:"ipAddress"}},[a("Input",{attrs:{type:"textarea",placeholder:"192.168.0.1;192.168.0.2;baidu.com;weixin.com"},model:{value:e.formItem.ipAddress,callback:function(t){e.$set(e.formItem,"ipAddress",t)},expression:"formItem.ipAddress"}}),e._v('\n                同时支持Ip和域名,多个用分号";"隔开。示例：192.168.0.1;baidu.com;weixin.com\n            ')],1)],1)],1),a("TabPane",{attrs:{disabled:!e.formItem.policyId,label:"绑定接口",name:"form2"}},[a("Form",{directives:[{name:"show",rawName:"v-show",value:"form2"==e.current,expression:"current=='form2'"}],ref:"form2",attrs:{model:e.formItem,rules:e.formItemRules}},[a("Alert",{attrs:{type:"warning","show-icon":""}},[e._v("请注意：如果API上原来已经绑定了一个策略，则会被本策略覆盖，请慎重选择！")]),a("FormItem",{attrs:{prop:"authorities"}},[a("Transfer",{attrs:{data:e.selectApis,"list-style":{width:"45%",height:"480px"},titles:["选择接口","已选择接口"],"render-format":e.transferRender,"target-keys":e.formItem.apiIds,filterable:""},on:{"on-change":e.handleTransferChange}})],1)],1)],1)],1),a("div",{staticClass:"drawer-footer"},[a("Button",{attrs:{type:"default"},on:{click:e.handleReset}},[e._v("取消")]),e._v(" \n        "),a("Button",{attrs:{type:"primary",loading:e.saving},on:{click:e.handleSubmit}},[e._v("保存")])],1)],1)])],1)},s=[],o={name:"GatewayIpLimit",data(){return{loading:!1,saving:!1,modalVisible:!1,modalTitle:"",pageInfo:{total:0,page:1,limit:10,policyName:""},current:"form1",forms:["form1","form2"],selectApis:[],formItemRules:{policyName:[{required:!0,message:"策略名称不能为空",trigger:"blur"}],policyType:[{required:!0,message:"策略类型不能为空",trigger:"blur"}],ipAddress:[{required:!0,message:"Ip地址不能为空",trigger:"blur"}]},formItem:{policyId:"",policyName:"",policyType:"0",ipAddress:"",apiIds:[]},columns:[{title:"策略名称",key:"policyName",width:200},{title:"策略类型",width:300,slot:"policyType",filters:[{label:"拒绝-黑名单",value:0},{label:"允许-白名单",value:1}],filterMultiple:!1,filterMethod(e,t){return 0===e?0===t.policyType:1===e?1===t.policyType:void 0}},{title:"最后修改时间",key:"updateTime",width:180},{title:"IP地址/域名",key:"ipAddress"},{title:"操作",slot:"action",fixed:"right",width:150}],data:[]}},methods:{handleModal(e){e&&(this.formItem=Object.assign({},this.formItem,e)),this.current===this.forms[0]&&(this.modalTitle=e?"编辑来源限制策略 - "+this.formItem.policyName:"添加来源限制",this.modalVisible=!0),this.current===this.forms[1]&&(this.modalTitle=e?"绑定接口 - "+this.formItem.policyName:"绑定接口",this.handleIpLimitApi(this.formItem.policyId)),this.formItem.policyType=this.formItem.policyType+""},handleResetForm(e){this.$refs[e].resetFields()},handleTabClick(e){this.current=e,this.handleModal()},handleReset(){const e={policyId:"",policyName:"",policyType:"0",ipAddress:"",apiIds:[]};this.formItem=e,this.forms.map(e=>{this.handleResetForm(e)}),this.current=this.forms[0],this.modalVisible=!1,this.saving=!1},handleSubmit(){this.current===this.forms[0]&&this.$refs[this.current].validate(e=>{e&&(this.saving=!0,this.formItem.policyId?updateIpLimit(this.formItem).then(e=>{this.handleReset(),this.handleSearch(),0===e.code&&this.$Message.success("保存成功")}).finally(()=>{this.saving=!1}):addIpLimit(this.formItem).then(e=>{this.handleReset(),this.handleSearch(),0===e.code&&this.$Message.success("保存成功")}).finally(()=>{this.saving=!1}))}),this.current===this.forms[1]&&this.$refs[this.current].validate(e=>{e&&(this.saving=!0,addIpLimitApis({policyId:this.formItem.policyId,apiIds:this.formItem.apiIds}).then(e=>{this.handleReset(),this.handleSearch(),0===e.code&&this.$Message.success("绑定成功")}).finally(()=>{this.saving=!1}))})},handleSearch(e){e&&(this.pageInfo.page=e),this.loading=!0,getIpLimits(this.pageInfo).then(e=>{this.data=e.data.records,this.pageInfo.total=parseInt(e.data.total)}).finally(()=>{this.loading=!1})},handlePage(e){this.pageInfo.page=e,this.handleSearch()},handlePageSize(e){this.pageInfo.limit=e,this.handleSearch()},handleRemove(e){this.$Modal.confirm({title:"确定删除吗？",onOk:()=>{removeIpLimit(e.policyId).then(e=>{0===e.code&&(this.pageInfo.page=1,this.$Message.success("删除成功")),this.handleSearch()})}})},handleIpLimitApi(e){if(!e)return;const t=this,a=getAuthorityApi(""),r=getIpLimitApis(e);Promise.all([a,r]).then((function(e){let a=e[0],r=e[1];if(0===a.code&&(a.data.map(e=>{e.key=e.apiId,e.label=`${e.prefix.replace("/**","")}${e.path} - ${e.apiName}`}),t.selectApis=a.data),0===r.code){let e=[];r.data.map(t=>{e.includes(t.apiId)||e.push(t.apiId)}),t.formItem.apiIds=e}t.modalVisible=!0}))},transferRender(e){return`<span  title="${e.label}">${e.label}</span>`},handleTransferChange(e,t,a){-1!=e.indexOf("1")?this.formItem.apiIds=["1"]:this.formItem.apiIds=e}},mounted:function(){this.handleSearch()}},i=o,l=a("4e82"),n=Object(l["a"])(i,r,s,!1,null,null,null);t["default"]=n.exports},e63e:function(e,t,a){},ec7e:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Card",{attrs:{shadow:""}},[a("Steps",{attrs:{current:e.current}},[a("Step",{attrs:{title:"数据库连接"}}),a("Step",{attrs:{title:"生产代码"}})],1),a("Form",{ref:"form",staticStyle:{"margin-top":"20px"},attrs:{model:e.formItem,rules:e.formItemRules,"label-width":140}},[a("FormItem",{directives:[{name:"show",rawName:"v-show",value:0===e.current,expression:"current===0"}],attrs:{label:"数据库类型",prop:"type"}},[a("Select",{model:{value:e.formItem.type,callback:function(t){e.$set(e.formItem,"type",t)},expression:"formItem.type"}},[a("Option",{attrs:{value:"mysql"}},[e._v("mysql")]),a("Option",{attrs:{disabled:"",value:"oracle"}},[e._v("oracle")])],1)],1),a("FormItem",{directives:[{name:"show",rawName:"v-show",value:0===e.current,expression:"current===0"}],attrs:{label:"驱动名称",prop:"driverName"}},[a("Input",{attrs:{placeholder:"请输入内容"},model:{value:e.formItem.driverName,callback:function(t){e.$set(e.formItem,"driverName",t)},expression:"formItem.driverName"}})],1),a("FormItem",{directives:[{name:"show",rawName:"v-show",value:0===e.current,expression:"current===0"}],attrs:{label:"连接地址",prop:"url"}},[a("Input",{attrs:{placeholder:"请输入内容"},model:{value:e.formItem.url,callback:function(t){e.$set(e.formItem,"url",t)},expression:"formItem.url"}})],1),a("FormItem",{directives:[{name:"show",rawName:"v-show",value:0===e.current,expression:"current===0"}],attrs:{label:"用户名",prop:"username"}},[a("Input",{attrs:{placeholder:"请输入内容"},model:{value:e.formItem.username,callback:function(t){e.$set(e.formItem,"username",t)},expression:"formItem.username"}})],1),a("FormItem",{directives:[{name:"show",rawName:"v-show",value:0===e.current,expression:"current===0"}],attrs:{label:"密码",prop:"password"}},[a("Input",{attrs:{type:"password",placeholder:"请输入内容"},model:{value:e.formItem.password,callback:function(t){e.$set(e.formItem,"password",t)},expression:"formItem.password"}})],1),a("Row",[a("Col",{attrs:{span:"10"}},[a("FormItem",{directives:[{name:"show",rawName:"v-show",value:1===e.current,expression:"current===1"}],attrs:{label:"模块名称",prop:"moduleName"}},[a("Input",{attrs:{placeholder:"请输入内容"},model:{value:e.formItem.moduleName,callback:function(t){e.$set(e.formItem,"moduleName",t)},expression:"formItem.moduleName"}})],1),a("FormItem",{directives:[{name:"show",rawName:"v-show",value:1===e.current,expression:"current===1"}],attrs:{label:"顶级包名",prop:"parentPackage"}},[a("Input",{attrs:{placeholder:"请输入内容"},model:{value:e.formItem.parentPackage,callback:function(t){e.$set(e.formItem,"parentPackage",t)},expression:"formItem.parentPackage"}})],1),a("FormItem",{directives:[{name:"show",rawName:"v-show",value:1===e.current,expression:"current===1"}],attrs:{label:"作者",prop:"author"}},[a("Input",{attrs:{placeholder:"请输入内容"},model:{value:e.formItem.author,callback:function(t){e.$set(e.formItem,"author",t)},expression:"formItem.author"}})],1)],1),a("Col",{attrs:{span:"14"}},[a("FormItem",{directives:[{name:"show",rawName:"v-show",value:1===e.current,expression:"current===1"}],attrs:{label:"需要生成的表",prop:"includeTables"}},[a("Transfer",{attrs:{data:e.selectTables,"list-style":{width:"45%",height:"500px"},titles:["选择表","已选择表"],"target-keys":e.formItem.includeTables,filterable:""},on:{"on-change":e.handleTransferChange}})],1),a("FormItem",{directives:[{name:"show",rawName:"v-show",value:1===e.current,expression:"current===1"}],attrs:{label:"忽略表前缀",prop:"tablePrefix"}},[a("Select",{staticStyle:{width:"260px"},attrs:{multiple:""},model:{value:e.formItem.tablePrefix,callback:function(t){e.$set(e.formItem,"tablePrefix",t)},expression:"formItem.tablePrefix"}},e._l(e.formItem.tablePrefix,(function(t){return a("Option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),1)],1)],1)],1)],1),a("div",{staticStyle:{"margin-top":"20px","text-align":"center"}},[e.current>0?a("Button",{on:{click:e.up}},[e._v("上一步")]):e._e(),e._v(" \n      "),e.current<1?a("Button",{attrs:{type:"primary"},on:{click:e.next}},[e._v("下一步")]):e._e(),e._v(" \n      "),1===e.current?a("Button",{attrs:{type:"success",loading:e.saving},on:{click:e.handleSubmit}},[e._v("确定生成")]):e._e()],1)],1)],1)},s=[],o={name:"Generate",data(){return{saving:!1,current:0,selectTables:[],formItemRules:{type:[{required:!0,message:"数据库类型不能为空",trigger:"blur"}],driverName:[{required:!0,message:"驱动名称不能为空",trigger:"blur"}],url:[{required:!0,message:"数据库连接不能为空",trigger:"blur"}],username:[{required:!0,message:"用户名不能为空",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"}],author:[{required:!0,message:"作者不能为空",trigger:"blur"}],parentPackage:[{required:!0,message:"顶级包名不能为空",trigger:"blur"}],moduleName:[{required:!0,message:"模块名不能为空",trigger:"blur"}],includeTables:[{required:!0,message:"生成表名不能为空",trigger:"blur",type:"array",min:1}],tablePrefix:[{required:!0,message:"忽略表名前缀不能为空",trigger:"blur",type:"array",min:1}]},formItem:{type:"mysql",driverName:"com.mysql.cj.jdbc.Driver",url:"jdbc:mysql://localhost:3306/open-platform?useSSL=false&useUnicode=true&characterEncoding=utf-8&serverTimezone=UTC",username:"root",password:"root",author:"admin",parentPackage:"com.opencloud",moduleName:"base",includeTables:[],tablePrefix:[]}}},methods:{up(){0==this.current?this.current=0:this.current-=1},next(){1==this.current?this.current=0:this.current+=1},handleSubmit(){this.$refs["form"].validate(e=>{if(e){this.saving=!0;const e=Object.assign({},this.formItem);Generate.execute(e).then(e=>{if(0===e.code){let t=e.data,a=Generate.downloadPath+"?filePath="+t.filePath;this.$Modal.confirm({title:"是否下载",content:`代码生成成功! ${t.fileName}`,onOk:()=>{window.open(a,"_blank")}})}}).finally(()=>{this.saving=!1})}})},handleTransferChange(e,t,a){let r=[];e.map(e=>{let t=e.split("_")[0]+"_";r.includes(t)||r.push(t)}),this.formItem.tablePrefix=r,this.formItem.includeTables=e}},mounted:function(){},watch:{current(e){let t=this;1===e&&Generate.tables(this.formItem).then(e=>{if(0===e.code){let a=[];e.data.map(e=>{a.push({key:e.name,label:`${e.name} - ${e.comment}`,disabled:!1})}),t.selectTables=a}})}}},i=o,l=a("4e82"),n=Object(l["a"])(i,r,s,!1,null,null,null);t["default"]=n.exports},efe7:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Card",{attrs:{shadow:""}},[a("Form",{ref:"searchForm",attrs:{model:e.pageInfo,inline:"","label-width":80}},[a("FormItem",{attrs:{label:"AppId",prop:"appId"}},[a("Input",{attrs:{type:"text",placeholder:"请输入关键字"},model:{value:e.pageInfo.appId,callback:function(t){e.$set(e.pageInfo,"appId",t)},expression:"pageInfo.appId"}})],1),a("FormItem",{attrs:{label:"中文名称",prop:"appName"}},[a("Input",{attrs:{type:"text",placeholder:"请输入关键字"},model:{value:e.pageInfo.appName,callback:function(t){e.$set(e.pageInfo,"appName",t)},expression:"pageInfo.appName"}})],1),a("FormItem",{attrs:{label:"英文名称",prop:"appName"}},[a("Input",{attrs:{type:"text",placeholder:"请输入关键字"},model:{value:e.pageInfo.appNameEn,callback:function(t){e.$set(e.pageInfo,"appNameEn",t)},expression:"pageInfo.appNameEn"}})],1),a("FormItem",[a("Button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSearch(1)}}},[e._v("查询")]),e._v(" \n        "),a("Button",{on:{click:function(t){return e.handleResetForm("searchForm")}}},[e._v("重置")])],1)],1),a("div",{staticClass:"search-con search-con-top"},[a("ButtonGroup",[a("Button",{staticClass:"search-btn",attrs:{disabled:!e.hasAuthority("systemAppEdit"),type:"primary"},on:{click:function(t){return e.handleModal()}}},[a("span",[e._v("添加")])])],1)],1),a("Alert",{attrs:{type:"info","show-icon":""}},[e._v("客户端模式,请授权相关接口资源。否则请求网关服务器将提示"),a("code",[e._v('"权限不足,拒绝访问!"')])]),a("Table",{attrs:{border:"",columns:e.columns,data:e.data,loading:e.loading},scopedSlots:e._u([{key:"status",fn:function(e){var t=e.row;return[1===t.status?a("Badge",{attrs:{status:"success",text:"上线"}}):a("Badge",{attrs:{status:"error",text:"下线"}})]}},{key:"appType",fn:function(t){var r=t.row;return["server"===r.appType?a("Tag",{attrs:{color:"blue"}},[e._v("服务器应用")]):"app"===r.appType?a("Tag",{attrs:{color:"blue"}},[e._v("手机应用")]):"pc"===r.appType?a("Tag",{attrs:{color:"blue"}},[e._v("PC网页应用")]):a("Tag",{attrs:{color:"blue"}},[e._v("手机网页应用")])]}},{key:"action",fn:function(t){var r=t.row;return[a("a",{attrs:{disabled:"gateway"==r.appId||!e.hasAuthority("systemAppEdit")},on:{click:function(t){return e.handleModal(r)}}},[e._v("\n          编辑")]),e._v(" \n        "),a("Dropdown",{directives:[{name:"show",rawName:"v-show",value:e.hasAuthority("systemAppEdit"),expression:"hasAuthority('systemAppEdit')"}],ref:"dropdown",attrs:{transfer:""},on:{"on-click":function(t){return e.handleClick(t,r)}}},[a("a",{attrs:{href:"javascript:void(0)",disabled:"gateway"===r.appId}},[a("span",[e._v("更多")]),a("Icon",{attrs:{type:"ios-arrow-down"}})],1),a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[a("DropdownItem",{attrs:{name:"resetSecret"}},[e._v("重置密钥")]),a("DropdownItem",{attrs:{name:"remove"}},[e._v("删除应用")])],1)],1)]}}])}),a("Page",{attrs:{transfer:"",total:e.pageInfo.total,current:e.pageInfo.page,"page-size":e.pageInfo.limit,"show-elevator":"","show-sizer":"","show-total":""},on:{"on-change":e.handlePage,"on-page-size-change":e.handlePageSize}})],1),a("Modal",{attrs:{title:e.modalTitle,width:"40"},on:{"on-cancel":e.handleReset},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[a("div",[a("Tabs",{attrs:{value:e.current},on:{"on-click":e.handleTabClick}},[a("TabPane",{attrs:{label:"应用信息",name:"form1"}},[a("Form",{directives:[{name:"show",rawName:"v-show",value:"form1"==e.current,expression:"current=='form1'"}],ref:"form1",attrs:{model:e.formItem,rules:e.formItemRules,"label-width":135}},[a("FormItem",{attrs:{label:"应用图标"}},[e._l(e.uploadList,(function(t,r){return a("div",{key:r,staticClass:"upload-list"},["finished"===t.status?[a("img",{attrs:{src:t.url}}),a("div",{staticClass:"upload-list-cover"},[a("Icon",{attrs:{type:"ios-eye-outline"},nativeOn:{click:function(a){return e.handleView(t.name)}}}),a("Icon",{attrs:{type:"ios-trash-outline"},nativeOn:{click:function(a){return e.handleRemoveImg(t)}}})],1)]:[t.showProgress?a("Progress",{attrs:{percent:t.percentage,"hide-info":""}}):e._e()]],2)})),a("Upload",{ref:"upload",staticStyle:{display:"inline-block",width:"58px"},attrs:{"show-upload-list":!1,"default-file-list":e.defaultList,format:["jpg","jpeg","png"],"max-size":2048,"on-success":e.handleSuccess,"on-format-error":e.handleFormatError,"on-exceeded-size":e.handleMaxSize,"before-upload":e.handleBeforeUpload,type:"drag",action:"//jsonplaceholder.typicode.com/posts/"}},[a("div",{staticStyle:{width:"58px",height:"58px","line-height":"58px"}},[a("Icon",{attrs:{type:"ios-camera",size:"20"}})],1)])],2),a("FormItem",{attrs:{label:"AppId"}},[a("Input",{attrs:{disabled:"",placeholder:"请输入内容"},model:{value:e.formItem.appId,callback:function(t){e.$set(e.formItem,"appId",t)},expression:"formItem.appId"}})],1),a("FormItem",{attrs:{label:"开发者"}},[a("Select",{attrs:{filterable:"",clearable:""},model:{value:e.formItem.developerId,callback:function(t){e.$set(e.formItem,"developerId",t)},expression:"formItem.developerId"}},e._l(e.selectUsers,(function(t,r){return a("Option",{key:r,attrs:{title:t.userName,value:t.userId,label:t.userName},nativeOn:{click:function(a){return e.handleOnSelectUser(t)}}},[a("span",[e._v(e._s(t.userName))])])})),1)],1),a("FormItem",{attrs:{label:"应用名称",prop:"appName"}},[a("Input",{attrs:{placeholder:"请输入内容"},model:{value:e.formItem.appName,callback:function(t){e.$set(e.formItem,"appName",t)},expression:"formItem.appName"}})],1),a("FormItem",{attrs:{label:"英文名称",prop:"appNameEn"}},[a("Input",{attrs:{placeholder:"请输入内容"},model:{value:e.formItem.appNameEn,callback:function(t){e.$set(e.formItem,"appNameEn",t)},expression:"formItem.appNameEn"}})],1),a("FormItem",{attrs:{label:"应用类型",prop:"appType"}},[a("Select",{on:{"on-change":e.handleOnAppTypeChange},model:{value:e.formItem.appType,callback:function(t){e.$set(e.formItem,"appType",t)},expression:"formItem.appType"}},[a("Option",{attrs:{value:"server"}},[e._v("服务器应用")]),a("Option",{attrs:{value:"app"}},[e._v("手机应用")]),a("Option",{attrs:{value:"pc"}},[e._v("PC网页应用")]),a("Option",{attrs:{value:"wap"}},[e._v("手机网页应用")])],1)],1),"app"===e.formItem.appType?a("FormItem",{attrs:{prop:"appOs",label:"操作系统"}},[a("RadioGroup",{model:{value:e.formItem.appOs,callback:function(t){e.$set(e.formItem,"appOs",t)},expression:"formItem.appOs"}},[a("Radio",{attrs:{label:"ios"}},[a("Icon",{attrs:{type:"logo-apple"}}),a("span",[e._v("苹果IOS")])],1),a("Radio",{attrs:{label:"android"}},[a("Icon",{attrs:{type:"logo-android"}}),a("span",[e._v("安卓Android")])],1)],1)],1):e._e(),a("FormItem",{attrs:{label:"应用官网",prop:"website"}},[a("Input",{attrs:{placeholder:"请输入内容"},model:{value:e.formItem.website,callback:function(t){e.$set(e.formItem,"website",t)},expression:"formItem.website"}})],1),a("FormItem",{attrs:{label:"状态"}},[a("RadioGroup",{attrs:{type:"button"},model:{value:e.formItem.status,callback:function(t){e.$set(e.formItem,"status",t)},expression:"formItem.status"}},[a("Radio",{attrs:{label:"0"}},[e._v("下线")]),a("Radio",{attrs:{label:"1"}},[e._v("上线")])],1)],1),a("FormItem",{attrs:{label:"描述"}},[a("Input",{attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:e.formItem.appDesc,callback:function(t){e.$set(e.formItem,"appDesc",t)},expression:"formItem.appDesc"}})],1)],1)],1),a("TabPane",{attrs:{disabled:!e.formItem.appId,label:"开发信息",name:"form2"}},[a("Form",{directives:[{name:"show",rawName:"v-show",value:"form2"==e.current,expression:"current=='form2'"}],ref:"form2",attrs:{model:e.formItem,rules:e.formItemRules,"label-width":135}},[a("FormItem",{attrs:{label:"ApiKey"}},[a("Input",{attrs:{disabled:"",placeholder:"请输入内容"},model:{value:e.formItem.apiKey,callback:function(t){e.$set(e.formItem,"apiKey",t)},expression:"formItem.apiKey"}})],1),a("FormItem",{attrs:{label:"SecretKey"}},[a("Input",{attrs:{disabled:"",placeholder:"请输入内容"},model:{value:e.formItem.secretKey,callback:function(t){e.$set(e.formItem,"secretKey",t)},expression:"formItem.secretKey"}})],1),a("FormItem",{attrs:{label:"授权类型",prop:"grantTypes"}},[a("CheckboxGroup",{model:{value:e.formItem.grantTypes,callback:function(t){e.$set(e.formItem,"grantTypes",t)},expression:"formItem.grantTypes"}},e._l(e.selectGrantTypes,(function(t,r){return a("Tooltip",{key:r,attrs:{content:t.desc}},[a("Checkbox",{attrs:{label:t.label}},[a("span",[e._v(e._s(t.title))])])],1)})),1)],1),a("FormItem",{attrs:{label:"用户授权范围",prop:"scopes"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("用户授权范围\n          "),a("Tooltip",{attrs:{content:"提醒用户确认授权可访问的资源"}},[a("Icon",{attrs:{type:"ios-alert",size:"16"}})],1)],1),a("CheckboxGroup",{model:{value:e.formItem.scopes,callback:function(t){e.$set(e.formItem,"scopes",t)},expression:"formItem.scopes"}},e._l(e.selectScopes,(function(t,r){return a("Checkbox",{key:r,attrs:{label:t.label}},[a("span",[e._v(e._s(t.title))])])})),1)],1),a("FormItem",{attrs:{label:"自动授权范围"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("自动授权范围\n            "),a("Tooltip",{attrs:{content:"不再提醒用户确认授权可访问的资源"}},[a("Icon",{attrs:{type:"ios-alert",size:"16"}})],1)],1),a("CheckboxGroup",{model:{value:e.formItem.autoApproveScopes,callback:function(t){e.$set(e.formItem,"autoApproveScopes",t)},expression:"formItem.autoApproveScopes"}},e._l(e.selectScopes,(function(t,r){return a("Checkbox",{key:r,attrs:{label:t.label}},[a("span",[e._v(e._s(t.title))])])})),1)],1),a("FormItem",{attrs:{label:"令牌有效期",prop:"accessTokenValidity"}},[a("RadioGroup",{attrs:{type:"button"},model:{value:e.formItem.tokenValidity,callback:function(t){e.$set(e.formItem,"tokenValidity",t)},expression:"formItem.tokenValidity"}},[a("Radio",{attrs:{label:"1"}},[e._v("设置有效期")]),a("Radio",{attrs:{label:"0"}},[e._v("不限制")])],1)],1),a("FormItem",{directives:[{name:"show",rawName:"v-show",value:"1"===e.formItem.tokenValidity,expression:"formItem.tokenValidity === '1'"}],attrs:{label:"访问令牌有效期",prop:"accessTokenValidity"}},[a("InputNumber",{attrs:{min:900},model:{value:e.formItem.accessTokenValidity,callback:function(t){e.$set(e.formItem,"accessTokenValidity",t)},expression:"formItem.accessTokenValidity"}}),a("span",[e._v("  秒")])],1),a("FormItem",{directives:[{name:"show",rawName:"v-show",value:"1"===e.formItem.tokenValidity,expression:"formItem.tokenValidity === '1'"}],attrs:{label:"刷新令牌有效期",prop:"refreshTokenValidity"}},[a("InputNumber",{attrs:{min:900},model:{value:e.formItem.refreshTokenValidity,callback:function(t){e.$set(e.formItem,"refreshTokenValidity",t)},expression:"formItem.refreshTokenValidity"}}),a("span",[e._v("  秒")])],1),a("FormItem",{attrs:{label:"第三方登陆回调地址",prop:"redirectUrls"}},[a("Input",{attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:e.formItem.redirectUrls,callback:function(t){e.$set(e.formItem,"redirectUrls",t)},expression:"formItem.redirectUrls"}}),a("span",[e._v("多个地址使用,逗号隔开")])],1)],1)],1),a("TabPane",{attrs:{disabled:!e.formItem.appId,label:"分配权限",name:"form3"}},[a("Form",{directives:[{name:"show",rawName:"v-show",value:"form3"==e.current,expression:"current=='form3'"}],ref:"form3",attrs:{model:e.formItem,"label-width":100,rules:e.formItemRules}},[a("FormItem",{attrs:{prop:"expireTime",label:"过期时间"}},[e.formItem.isExpired?a("Badge",{attrs:{text:"授权已过期"}},[a("DatePicker",{staticClass:"ivu-form-item-error",attrs:{type:"datetime",placeholder:"授权有效期"},model:{value:e.formItem.expireTime,callback:function(t){e.$set(e.formItem,"expireTime",t)},expression:"formItem.expireTime"}})],1):a("DatePicker",{attrs:{type:"datetime",placeholder:"设置有效期"},model:{value:e.formItem.expireTime,callback:function(t){e.$set(e.formItem,"expireTime",t)},expression:"formItem.expireTime"}})],1),a("FormItem",{attrs:{prop:"authorities",label:"功能接口"}},[a("Transfer",{attrs:{data:e.selectApis,"list-style":{width:"45%",height:"480px"},titles:["选择接口","已选择接口"],"render-format":e.transferRender,"target-keys":e.formItem.authorities,filterable:""},on:{"on-change":e.handleTransferChange}})],1)],1)],1)],1),a("div",{staticClass:"drawer-footer"},[a("Button",{attrs:{type:"default"},on:{click:e.handleReset}},[e._v("取消")]),e._v(" \n        "),a("Button",{attrs:{type:"primary",loading:e.saving},on:{click:e.handleSubmit}},[e._v("保存")])],1)],1)])],1)},s=[],o=(a("c276"),{name:"SystemApp",data(){const e=(e,t,a)=>{let r=/^[-_a-zA-Z0-9]+$/;""===t?a(new Error("英文不能为空")):""===t||r.test(t)?a():a(new Error("只允许字母、数字、下划线、横线"))};return{loading:!1,saving:!1,current:"form1",forms:["form1","form2","form3"],selectApis:[],selectUsers:[],selectGrantTypes:[{label:"authorization_code",title:"授权码模式",desc:"Web服务端应用与第三方移动App应用"},{label:"client_credentials",title:"客户端模式",desc:"没有用户参与的,内部服务端与第三方服务端"},{label:"password",title:"密码模式",desc:"内部Web网页应用与内部移动App应用"},{label:"implicit",title:"简化模式",desc:"Web网页应用或第三方移动App应用"},{label:"refresh_token",title:"刷新令牌",desc:"刷新并延迟访问令牌时长"}],selectScopes:[{label:"userProfile",title:"允许访问基本信息"},{label:"api1",title:"允许访问....自定义信息"}],pageInfo:{total:0,page:1,limit:10,appId:"",appName:"",appNameEn:""},defaultList:[{name:"",url:""}],modalVisible:!1,modalTitle:"",imgName:"",visible:!1,uploadList:[],formItemRules:{website:[{type:"url",message:"请输入有效网址",trigger:"blur"}],appType:[{required:!0,message:"应用类型不能为空",trigger:"blur"}],appOs:[{required:!0,message:"操作系统不能为空",trigger:"blur"}],redirectUrls:[{required:!0,message:"授权重定向地址不能为空",trigger:"blur"}],appName:[{required:!0,message:"应用名称不能为空",trigger:"blur"}],appNameEn:[{required:!0,validator:e,trigger:"blur"}],grantTypes:[{required:!0,type:"array",min:1,message:"授权类型不能为空",trigger:"blur"}],scopes:[{required:!0,type:"array",min:1,message:"用户授权范围不能为空",trigger:"blur"}],accessTokenValidity:[{required:!0,type:"integer",min:900,message:"访问令牌有效期不能少于900",trigger:"blur"}],refreshTokenValidity:[{required:!0,type:"integer",min:900,message:"刷新令牌有效期不能少于900",trigger:"blur"}]},formItem:{appId:"",apiKey:"",secretKey:"",appName:"",appNameEn:"",appType:"server",appIcon:"",appOs:"",path:"",website:"",appDesc:"",status:1,redirectUrls:"",developerId:"",scopes:["userProfile"],autoApproveScopes:[],authorities:[],grantTypes:[],accessTokenValidity:43200,refreshTokenValidity:2592e3,expireTime:"",isExpired:!1,tokenValidity:"1"},columns:[{type:"selection",width:60,align:"center"},{title:"应用名称",key:"appName",width:200},{title:"AppId",key:"appId",width:200},{title:"ApiKey",key:"apiKey",width:250},{title:"SecretKey",key:"secretKey",width:300},{title:"开发者",key:"userName",width:200},{title:"应用类型",slot:"appType",width:180,filters:[{label:"服务器应用",value:0},{label:"手机应用",value:1},{label:"PC网页应用",value:2},{label:"手机网页应用",value:3}],filterMultiple:!1,filterMethod(e,t){return 0===e?"server"===t.appType:1===e?"app"===t.appType:2===e?"pc"===t.appType:3===e?"wap"===t.appType:void 0}},{title:"状态",slot:"status",key:"status"},{title:"操作",slot:"action",fixed:"right",width:120}],data:[]}},methods:{handleModal(e){e&&(this.formItem=Object.assign({},this.formItem,e),this.formItem.appId=e.appId),this.current===this.forms[0]&&(this.modalTitle=e?"编辑应用 - "+e.appName:"添加应用",this.handleLoadUsers()),this.current===this.forms[1]&&(this.modalTitle=e?"开发信息 - "+e.appName:"开发信息",this.handleLoadAppClientInfo(this.formItem.apiKey)),this.current===this.forms[2]&&(this.modalTitle=e?"分配权限 - "+e.appName:"分配权限",this.handleLoadAppGranted(this.formItem.appId)),this.formItem.status=this.formItem.status+""},handleResetForm(e){this.$refs[e].resetFields()},handleReset(){const e={appId:"",apiKey:"",secretKey:"",appName:"",appNameEn:"",appType:"server",appIcon:"",appOs:"",path:"",website:"",appDesc:"",status:1,redirectUrls:"",developerId:"",scopes:["userProfile"],autoApproveScopes:[],authorities:[],grantTypes:[],accessTokenValidity:43200,refreshTokenValidity:2592e3,expireTime:"",isExpired:!1,tokenValidity:"1"};this.formItem=e,this.forms.map(e=>{this.handleResetForm(e)}),this.current=this.forms[0],this.saving=!1,this.modalVisible=!1},handleSubmit(){this.current===this.forms[0]&&this.$refs[this.current].validate(e=>{if(e){this.saving=!0;const e=Object.assign({},this.formItem);e.appId}}),this.current===this.forms[1]&&this.$refs[this.current].validate(e=>{e&&(this.saving=!0,"0"===this.formItem.tokenValidity&&(this.formItem.accessTokenValidity=-1,this.formItem.refreshTokenValidity=-1))}),this.current===this.forms[2]&&this.$refs[this.current].validate(e=>{e&&(this.saving=!0)})},handleSearch(e){e&&(this.pageInfo.page=e),this.loading=!0},handleRemove(e){this.$Modal.confirm({title:"删除后将无法恢复,确定删除吗？",onOk:()=>{}})},handleResetSecret(e){this.$Modal.confirm({title:"重置后将影响应用正常使用,确定重置吗？",onOk:()=>{}})},handleTabClick(e){this.current=e,this.handleModal()},handleClick(e,t){switch(e){case"remove":this.handleRemove(t);break;case"resetSecret":this.handleResetSecret(t);break}},handleOnAppTypeChange(e){"app"!==e?this.formItem.appOs="":this.formItem.appOs||(this.formItem.appOs="ios")},handleOnSelectUser(e){this.formItem.developerId=e.userId},handlePage(e){this.pageInfo.page=e,this.handleSearch()},handlePageSize(e){this.pageInfo.limit=e,this.handleSearch()},handleLoadAppGranted(e){if(!e)return;getAuthorityApi(""),getAuthorityApp(e)},handleLoadAppClientInfo(e){},transferRender(e){return`<span  title="${e.label}">${e.label}</span>`},handleTransferChange(e,t,a){-1!=e.indexOf("1")?this.formItem.authorities=["1"]:this.formItem.authorities=e},handleLoadUsers(){},handleView(e){this.imgName=e,this.visible=!0},handleRemoveImg(e){const t=this.$refs.upload.fileList;this.$refs.upload.fileList.splice(t.indexOf(e),1)},handleSuccess(e,t){t.url="",t.name=""},handleFormatError(e){this.$Message.warning("图片支持png、jpg、jpeg")},handleMaxSize(e){this.$Message.warning("图片大小不能超过2M.")},handleBeforeUpload(){const e=this.uploadList.length<1;return e||this.$Message.warning("只能上传一张."),e}},mounted:function(){this.handleSearch()}}),i=o,l=(a("82b9"),a("4e82")),n=Object(l["a"])(i,r,s,!1,null,"6e574a8c",null);t["default"]=n.exports},f26d:function(e,t,a){"use strict";var r=a("5dbf"),s=a.n(r);s.a},f5ae:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Card",{attrs:{shadow:""}},[a("div",{staticClass:"search-con search-con-top"},[a("ButtonGroup",[a("Button",{staticClass:"search-btn",attrs:{disabled:!e.hasAuthority("gatewayRouteEdit"),type:"primary"},on:{click:function(t){return e.handleModal()}}},[a("span",[e._v("添加")])])],1)],1),a("Alert",{attrs:{"show-icon":""}},[e._v("谨慎添加或修改路由,如果修改不当,将影响正常访问！ "),a("a",{on:{click:e.handleRefreshGateway}},[e._v("手动刷新网关")])]),a("Table",{attrs:{border:"",columns:e.columns,data:e.data,loading:e.loading},scopedSlots:e._u([{key:"status",fn:function(e){var t=e.row;return[1===t.status?a("Badge",{attrs:{status:"success",text:"启用"}}):a("Badge",{attrs:{status:"error",text:"禁用"}})]}},{key:"routeType",fn:function(t){var r=t.row;return[!r.serviceId?!r.url?e._e():a("span",[a("Tag",{attrs:{color:"blue"}},[e._v("反向代理")]),e._v(e._s(r.url))],1):a("span",[a("Tag",{attrs:{color:"green"}},[e._v("负载均衡")]),e._v(e._s(r.serviceId))],1)]}},{key:"action",fn:function(t){var r=t.row;return[a("a",{attrs:{disabled:!e.hasAuthority("gatewayRouteEdit")},on:{click:function(t){return e.handleModal(r)}}},[e._v("\n          编辑")]),e._v(" \n        "),a("Dropdown",{directives:[{name:"show",rawName:"v-show",value:e.hasAuthority("gatewayRouteEdit"),expression:"hasAuthority('gatewayRouteEdit')"}],ref:"dropdown",attrs:{transfer:""},on:{"on-click":function(t){return e.handleClick(t,r)}}},[a("a",{attrs:{href:"javascript:void(0)"}},[a("span",[e._v("更多")]),a("Icon",{attrs:{type:"ios-arrow-down"}})],1),a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[a("DropdownItem",{attrs:{name:"remove"}},[e._v("删除")])],1)],1),e._v(" \n      ")]}}])}),a("Page",{attrs:{total:e.pageInfo.total,current:e.pageInfo.page,"page-size":e.pageInfo.limit,"show-elevator":"","show-sizer":"","show-total":""},on:{"on-change":e.handlePage,"on-page-size-change":e.handlePageSize}})],1),a("Modal",{attrs:{title:e.modalTitle,width:"40"},on:{"on-cancel":e.handleReset},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[a("div",[a("Form",{ref:"routeForm",attrs:{model:e.formItem,rules:e.formItemRules,"label-width":100}},[a("FormItem",{attrs:{label:"路由名称",prop:"routeDesc"}},[a("Input",{attrs:{placeholder:"请输入内容"},model:{value:e.formItem.routeDesc,callback:function(t){e.$set(e.formItem,"routeDesc",t)},expression:"formItem.routeDesc"}})],1),a("FormItem",{attrs:{label:"路由标识",prop:"routeName"}},[a("Input",{attrs:{placeholder:"默认使用服务名称{application.name}"},model:{value:e.formItem.routeName,callback:function(t){e.$set(e.formItem,"routeName",t)},expression:"formItem.routeName"}})],1),a("FormItem",{attrs:{label:"路由前缀",prop:"path"}},[a("Input",{attrs:{placeholder:"/{path}/**"},model:{value:e.formItem.path,callback:function(t){e.$set(e.formItem,"path",t)},expression:"formItem.path"}})],1),a("FormItem",{attrs:{label:"路由方式"}},[a("Select",{model:{value:e.selectType,callback:function(t){e.selectType=t},expression:"selectType"}},[a("Option",{attrs:{value:"service",label:"负载均衡(serviceId)"}}),a("Option",{attrs:{value:"url",label:"反向代理(url)"}})],1)],1),"service"===e.selectType?a("FormItem",{attrs:{label:"负载均衡",prop:"serviceId",rules:{required:!0,message:"服务名称不能为空",trigger:"blur"}}},[a("Input",{attrs:{placeholder:"服务名称application.name"},model:{value:e.formItem.serviceId,callback:function(t){e.$set(e.formItem,"serviceId",t)},expression:"formItem.serviceId"}})],1):e._e(),"url"===e.selectType?a("FormItem",{attrs:{label:"反向代理",prop:"url",rules:[{required:!0,message:"服务地址不能为空",trigger:"blur"},{type:"url",message:"请输入有效网址",trigger:"blur"}]}},[a("Input",{attrs:{placeholder:"http://localhost:8080"},model:{value:e.formItem.url,callback:function(t){e.$set(e.formItem,"url",t)},expression:"formItem.url"}})],1):e._e(),a("FormItem",{attrs:{label:"忽略前缀"}},[a("RadioGroup",{attrs:{type:"button"},model:{value:e.formItem.stripPrefix,callback:function(t){e.$set(e.formItem,"stripPrefix",t)},expression:"formItem.stripPrefix"}},[a("Radio",{attrs:{label:"0"}},[e._v("否")]),a("Radio",{attrs:{label:"1"}},[e._v("是")])],1)],1),a("FormItem",{attrs:{label:"失败重试"}},[a("RadioGroup",{attrs:{type:"button"},model:{value:e.formItem.retryable,callback:function(t){e.$set(e.formItem,"retryable",t)},expression:"formItem.retryable"}},[a("Radio",{attrs:{label:"0"}},[e._v("否")]),a("Radio",{attrs:{label:"1"}},[e._v("是")])],1)],1),a("FormItem",{attrs:{label:"状态"}},[a("RadioGroup",{attrs:{type:"button"},model:{value:e.formItem.status,callback:function(t){e.$set(e.formItem,"status",t)},expression:"formItem.status"}},[a("Radio",{attrs:{label:"0"}},[e._v("禁用")]),a("Radio",{attrs:{label:"1"}},[e._v("启用")])],1)],1)],1),a("div",{staticClass:"drawer-footer"},[a("Button",{attrs:{type:"default"},on:{click:e.handleReset}},[e._v("取消")]),e._v(" \n        "),a("Button",{attrs:{type:"primary",loading:e.saving},on:{click:e.handleSubmit}},[e._v("保存")])],1)],1)])],1)},s=[],o={name:"GatewayRoute",data(){return{loading:!1,saving:!1,modalVisible:!1,modalTitle:"",pageInfo:{total:0,page:1,limit:10},selectType:"service",selectServiceList:[],formItemRules:{routeDesc:[{required:!0,message:"路由名称不能为空",trigger:"blur"}],routeName:[{required:!0,message:"路由标识不能为空",trigger:"blur"}],path:[{required:!0,message:"路由前缀不能为空",trigger:"blur"}]},formItem:{routeId:"",path:"",serviceId:"",url:"",stripPrefix:0,retryable:0,status:1,routeName:"",routeDesc:""},columns:[{title:"路由名称",key:"routeDesc",width:300},{title:"路由标识",key:"routeName",width:300},{title:"路由前缀",key:"path",width:200},{title:"路由方式",slot:"routeType",width:300},{title:"忽略前缀",key:"stripPrefix"},{title:"失败重试",key:"retryable"},{title:"状态",key:"status",slot:"status"},{title:"操作",slot:"action",fixed:"right",width:120}],data:[]}},methods:{handleModal(e){e?(this.modalTitle="编辑路由",this.formItem=Object.assign({},this.formItem,e)):this.modalTitle="添加路由",this.formItem.status=this.formItem.status+"",this.formItem.stripPrefix=this.formItem.stripPrefix+"",this.formItem.retryable=this.formItem.retryable+"",this.formItem.url=this.formItem.service?"":this.formItem.url,this.formItem.service=this.formItem.url?"":this.formItem.service,this.selectType=this.formItem.url?"url":"service",this.modalVisible=!0},handleReset(){const e={routeId:"",path:"",serviceId:"",url:"",stripPrefix:0,retryable:0,status:1,routeName:"",routeDesc:""};this.formItem=e,this.$refs["routeForm"].resetFields(),this.modalVisible=!1,this.saving=!1},handleSubmit(){this.$refs["routeForm"].validate(e=>{e&&(this.saving=!0,this.formItem.routeId?updateRoute(this.formItem).then(e=>{0===e.code&&(this.$Message.success("保存成功"),this.handleReset()),this.handleSearch()}).finally(()=>{this.saving=!1}):addRoute(this.formItem).then(e=>{this.handleReset(),this.handleSearch(),0===e.code&&this.$Message.success("保存成功")}).finally(()=>{this.saving=!1}))})},handleSearch(e){e&&(this.pageInfo.page=e),this.loading=!0,getRoutes({page:this.pageInfo.page,limit:this.pageInfo.limit}).then(e=>{this.data=e.data.records,this.pageInfo.total=parseInt(e.data.total)}).finally(()=>{this.loading=!1})},handlePage(e){this.pageInfo.page=e,this.handleSearch()},handlePageSize(e){this.pageInfo.limit=e,this.handleSearch()},handleRemove(e){this.$Modal.confirm({title:"确定删除吗？",onOk:()=>{removeRoute(e.routeId).then(e=>{0===e.code&&(this.pageInfo.page=1,this.$Message.success("删除成功")),this.handleSearch()})}})},handleClick(e,t){switch(e){case"remove":this.handleRemove(t);break}},handleRefreshGateway(){this.$Modal.confirm({title:"提示",content:"将重新加载所有网关实例包括（访问权限、流量限制、IP访问限制、路由缓存），是否继续？",onOk:()=>{refreshGateway().then(e=>{0===e.code&&this.$Message.success("刷新成功")})}})}},mounted:function(){this.handleSearch()}},i=o,l=a("4e82"),n=Object(l["a"])(i,r,s,!1,null,null,null);t["default"]=n.exports},fa32:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Card",{attrs:{shadow:""}},[a("div",[a("div",{staticClass:"account-setting-con left-con"},[a("Menu",{attrs:{"active-name":"profile"},on:{"on-select":e.handleSelect}},[a("MenuItem",{attrs:{name:"profile"}},[a("span",[e._v("基本信息")])]),a("MenuItem",{attrs:{name:"security"}},[a("span",[e._v("安全设置")])])],1)],1),a("div",{staticClass:"account-setting-con view-con"},["profile"===e.currentSelect?a("Form",{ref:"userForm",attrs:{rules:e.formItemRules,model:e.profile}},[a("h3",[a("span",[e._v("基本信息")])]),a("Row",[a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"昵称",prop:"nickName"}},[a("Input",{attrs:{placeholder:"请输入内容"},model:{value:e.profile.nickName,callback:function(t){e.$set(e.profile,"nickName",t)},expression:"profile.nickName"}})],1),a("FormItem",{attrs:{label:"描述"}},[a("Input",{attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:e.profile.userDesc,callback:function(t){e.$set(e.profile,"userDesc",t)},expression:"profile.userDesc"}})],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"头像",prop:"avatar"}},[a("Avatar",{staticStyle:{height:"128px",width:"128px","border-radius":"50%"}})],1)],1)],1),a("FormItem",[a("Button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSubmit("userForm")}}},[e._v("保存")])],1)],1):e._e(),"security"===e.currentSelect?a("div",[a("h3",[a("span",[e._v("安全设置")])]),a("Divider"),a("p",[e._v("登陆名")]),a("p",{staticStyle:{color:"#9ea7b4"}},[e._v("当前登录名:"+e._s(e.profile.userName))]),a("Divider"),a("p",[e._v("绑定手机")]),a("p",{staticStyle:{color:"#9ea7b4"}},[e.profile.mobile?a("span",[e._v("已绑定手机："+e._s(e.profile.mobile)+"  "),a("a",[e._v("修改")])]):a("span",[e._v("\n             尚未绑定手机 "),a("a",[e._v("绑定")])])]),a("Divider"),a("p",[e._v("绑定邮箱")]),a("p",{staticStyle:{color:"#9ea7b4"}},[e.profile.email?a("span",[e._v("已绑定邮箱："+e._s(e.profile.email)+"  "),a("a",[e._v("修改")])]):a("span",[e._v("\n             尚未绑定手机 "),a("a",[e._v("绑定")])])]),a("Divider",{staticStyle:{color:"#9ea7b4"}})],1):e._e()],1)])])},s=[],o={name:"message_page",data(){return{currentSelect:"profile",formItemRules:{nickName:[{required:!0,message:"昵称不能为空",trigger:"blur"}]},profile:this.$store.state.user}},methods:{handleSubmit(e){"userForm"===e&&this.$refs["userForm"].validate(e=>{e&&updateCurrentUserInfo(this.profile).then(e=>{0===e.code&&(this.$Message.success("修改成功"),this.$store.commit("setAvatar",this.profile.avatar),this.$store.commit("setNickName",this.profile.nickName))}).finally(()=>{this.saving=!1})})},handleSelect(e){this.currentSelect=e}},mounted(){}},i=o,l=(a("67cf"),a("4e82")),n=Object(l["a"])(i,r,s,!1,null,null,null);t["default"]=n.exports},fa4a:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("i-table",{attrs:{border:"",content:e.self,columns:e.columns7,data:e.activityData}})],1)},s=[],o={data(){return{self:this,columns7:[{title:"活动编号",key:"campaignId"},{title:"公司全称",key:"fullName"},{title:"公司简称",key:"simpleName"},{title:"更新时间",key:"updateTime"},{title:"操作人",key:"updateUser"}],activityData:[],search:{dateStart:null,dateEnd:null,campaignName:null,campaignId:null,extrend_json:null}}},created(){this.loadList()},methods:{loadList(){}}},i=o,l=a("4e82"),n=Object(l["a"])(i,r,s,!1,null,null,null);t["default"]=n.exports},ff86:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Card",{attrs:{shadow:""}},[a("Form",{ref:"searchForm",attrs:{model:e.pageInfo,inline:"","label-width":80}},[a("FormItem",{attrs:{label:"通知地址",prop:"url"}},[a("Input",{attrs:{type:"text",placeholder:"请输入关键字"},model:{value:e.pageInfo.url,callback:function(t){e.$set(e.pageInfo,"url",t)},expression:"pageInfo.url"}})],1),a("FormItem",{attrs:{label:"业务类型",prop:"type"}},[a("Input",{attrs:{type:"text",placeholder:"请输入关键字"},model:{value:e.pageInfo.type,callback:function(t){e.$set(e.pageInfo,"type",t)},expression:"pageInfo.type"}})],1),a("FormItem",{attrs:{label:"通知结果",prop:"result"}},[a("Select",{model:{value:e.pageInfo.result,callback:function(t){e.$set(e.pageInfo,"result",t)},expression:"pageInfo.result"}},[a("Option",{attrs:{value:""}},[e._v("全部")]),a("Option",{attrs:{value:"1"}},[e._v("成功")]),a("Option",{attrs:{value:"0"}},[e._v("失败")])],1)],1),a("FormItem",[a("Button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSearch(1)}}},[e._v("查询")]),e._v(" \n        "),a("Button",{on:{click:function(t){return e.handleResetForm("searchForm")}}},[e._v("重置")])],1)],1),a("Table",{attrs:{border:"",columns:e.columns,data:e.data,loading:e.loading},scopedSlots:e._u([{key:"status",fn:function(e){var t=e.row;return[1===t.result?a("Badge",{attrs:{status:"success",text:"成功"}}):a("Badge",{attrs:{status:"error",text:"失败"}})]}},{key:"detail",fn:function(t){var r=t.row;return[a("a",{on:{click:function(t){return e.openDrawer(r)}}},[e._v("详情")])]}}])}),a("Page",{attrs:{transfer:"",total:e.pageInfo.total,current:e.pageInfo.page,"page-size":e.pageInfo.limit,"show-elevator":"","show-sizer":"","show-total":""},on:{"on-change":e.handlePage,"on-page-size-change":e.handlePageSize}})],1),a("Drawer",{attrs:{width:"50",closable:!1},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[a("div",{attrs:{slot:"header"},slot:"header"},[1===e.currentRow.result?a("Badge",{attrs:{status:"success"}}):a("Badge",{attrs:{status:"error"}}),e._v("\n      "+e._s(e.currentRow.url)+"\n\n    ")],1),a("div",[a("h3",[e._v("执行参数")]),a("pre",[e._v("            "+e._s(e.currentRow.data?JSON.stringify(JSON.parse(e.currentRow.data),null,2):"")+"\n      ")])])])],1)},s=[],o={name:"MsgHttpLogs",data(){return{drawer:!1,currentRow:{},loading:!1,pageInfo:{total:0,page:1,limit:10,url:"",type:"",result:""},columns:[{type:"selection",width:60,align:"center"},{title:"通知标识",key:"msgId",width:200},{title:"通知地址",key:"url",width:350},{title:"业务类型",key:"type",width:150},{title:"通知结果",key:"result",slot:"status",width:100},{title:"重试次数",key:"retryNums",width:100},{title:"通知次数",key:"totalNums",width:100},{title:"当前重试时间",key:"delay",render:(e,t)=>{return e("div",(t.row.delay?t.row.delay/1e3:0)+" s")},width:200},{title:"最后修改时间",key:"updateTime"},{title:"详情",slot:"detail",fixed:"right",width:150}],data:[]}},methods:{openDrawer(e){this.currentRow=e,this.drawer=!0},handleSearch(e){e&&(this.pageInfo.page=e),this.loading=!0,getNotifyHttpLogs(this.pageInfo).then(e=>{this.data=e.data.records,this.pageInfo.total=parseInt(e.data.total)}).finally(()=>{this.loading=!1})},handleResetForm(e){this.$refs[e].resetFields()},handlePage(e){this.pageInfo.page=e,this.handleSearch()},handlePageSize(e){this.pageInfo.limit=e,this.handleSearch()}},mounted:function(){this.handleSearch()}},i=o,l=a("4e82"),n=Object(l["a"])(i,r,s,!1,null,null,null);t["default"]=n.exports}}]);